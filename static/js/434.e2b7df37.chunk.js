"use strict";(self.webpackChunkvendor_management_system=self.webpackChunkvendor_management_system||[]).push([[434],{1432:(e,t,n)=>{n.d(t,{DP:()=>c,D_:()=>y,OC:()=>x,_d:()=>h,bB:()=>f,hI:()=>u,oX:()=>o,p$:()=>d,zC:()=>g,zy:()=>N});var r=n(5472),a=n(791);const s="vendors",i="vendorActivity";function o(e){var t,n,r,a,s,i;const o=e=>""===e||null===e||void 0===e?null:Number(e);return{name:String(e.name||"").trim(),email:String(e.email||"").trim().toLowerCase(),phone:String(e.phone||"").trim(),address:String(e.address||"").trim(),city:String(e.city||"").trim(),state:String(e.state||"").trim(),zipCode:String(e.zipCode||"").trim(),country:String(e.country||"India").trim(),website:String(e.website||"").trim(),contactPerson:String(e.contactPerson||"").trim(),contactPhone:String(e.contactPhone||"").trim(),contactEmail:String(e.contactEmail||"").trim().toLowerCase(),category:String(e.category||"").trim(),rating:null!==(t=o(e.rating))&&void 0!==t?t:0,gstNumber:String(e.gstNumber||"").trim(),panNumber:String(e.panNumber||"").trim(),bankDetails:{accountNumber:String((null===(n=e.bankDetails)||void 0===n?void 0:n.accountNumber)||"").trim(),ifscCode:String((null===(r=e.bankDetails)||void 0===r?void 0:r.ifscCode)||"").trim(),bankName:String((null===(a=e.bankDetails)||void 0===a?void 0:a.bankName)||"").trim(),accountHolderName:String((null===(s=e.bankDetails)||void 0===s?void 0:s.accountHolderName)||"").trim()},services:Array.isArray(e.services)?e.services.filter(Boolean):[],status:e.status||"active",notes:String(e.notes||"").trim(),establishedYear:o(e.establishedYear),employeeCount:o(e.employeeCount),annualRevenue:o(e.annualRevenue),creditLimit:o(e.creditLimit),preferredPaymentTerms:null!==(i=o(e.preferredPaymentTerms))&&void 0!==i?i:30,taxId:String(e.taxId||"").trim()}}function l(e){var t,n,r,a,s,i,o,l,d;const c=e.data()||{};return{id:e.id,name:c.name||"",email:c.email||"",phone:c.phone||"",address:c.address||"",city:c.city||"",state:c.state||"",zipCode:c.zipCode||"",country:c.country||"India",website:c.website||"",contactPerson:c.contactPerson||"",contactPhone:c.contactPhone||"",contactEmail:c.contactEmail||"",category:c.category||"",rating:"number"===typeof c.rating?c.rating:Number(c.rating||0),gstNumber:c.gstNumber||"",panNumber:c.panNumber||"",bankDetails:{accountNumber:(null===(t=c.bankDetails)||void 0===t?void 0:t.accountNumber)||"",ifscCode:(null===(n=c.bankDetails)||void 0===n?void 0:n.ifscCode)||"",bankName:(null===(r=c.bankDetails)||void 0===r?void 0:r.bankName)||"",accountHolderName:(null===(a=c.bankDetails)||void 0===a?void 0:a.accountHolderName)||""},services:Array.isArray(c.services)?c.services:[],status:c.status||"active",notes:c.notes||"",establishedYear:null!==(s=c.establishedYear)&&void 0!==s?s:"",employeeCount:null!==(i=c.employeeCount)&&void 0!==i?i:"",annualRevenue:null!==(o=c.annualRevenue)&&void 0!==o?o:"",creditLimit:null!==(l=c.creditLimit)&&void 0!==l?l:"",preferredPaymentTerms:null!==(d=c.preferredPaymentTerms)&&void 0!==d?d:30,taxId:c.taxId||"",createdAt:c.createdAt,updatedAt:c.updatedAt}}async function d(){const e=(0,r.P)((0,r.rJ)(a.db,s),(0,r.My)("createdAt","desc"));return(await(0,r.GG)(e)).docs.map(l)}async function c(){return(await(0,r.GG)((0,r.rJ)(a.db,s))).docs.map(l)}async function u(e){const t=await(0,r.x7)((0,r.H9)(a.db,s,e));return t.exists()?l(t):null}async function p(e,t,n){const i=[];if(e){const t=(0,r.P)((0,r.rJ)(a.db,s),(0,r._M)("email","==",e));(await(0,r.GG)(t)).forEach(e=>i.push(e))}if(t){const e=(0,r.P)((0,r.rJ)(a.db,s),(0,r._M)("phone","==",t));(await(0,r.GG)(e)).forEach(e=>i.push(e))}for(const r of i)if(!n||r.id!==n){const a=r.data();if(e&&a.email===e&&(!n||r.id!==n))return{type:"email",id:r.id};if(t&&a.phone===t&&(!n||r.id!==n))return{type:"phone",id:r.id}}return null}async function m(e,t,n){try{await(0,r.gS)((0,r.rJ)(a.db,i),{vendorId:e,action:t,details:n||{},timestamp:(0,r.O5)()})}catch(s){}}async function g(e){const t=o(e),n=await p(t.email,t.phone);if(n){throw new Error("email"===n.type?"DUPLICATE_VENDOR_EMAIL":"DUPLICATE_VENDOR_PHONE")}const i=(0,r.O5)(),l=await(0,r.gS)((0,r.rJ)(a.db,s),{...t,createdAt:i,updatedAt:i});await m(l.id,"create",{name:t.name,email:t.email})}async function h(e,t){const n=o(t),i=await p(n.email,n.phone,e);if(i){throw new Error("email"===i.type?"DUPLICATE_VENDOR_EMAIL":"DUPLICATE_VENDOR_PHONE")}await(0,r.mZ)((0,r.H9)(a.db,s,e),{...n,updatedAt:(0,r.O5)()}),await m(e,"update",{name:n.name,email:n.email})}async function x(e){await(0,r.kd)((0,r.H9)(a.db,s,e)),await m(e,"delete")}async function y(e,t){const n=(0,r.wP)(a.db);e.forEach(e=>{n.update((0,r.H9)(a.db,s,e),{...t,updatedAt:(0,r.O5)()})}),await n.commit();for(const r of e)m(r,"bulk_update",{fields:t})}async function f(e){const t=(0,r.wP)(a.db);e.forEach(e=>t.delete((0,r.H9)(a.db,s,e))),await t.commit();for(const n of e)m(n,"bulk_delete")}async function b(e){const t=(0,r.P)((0,r.rJ)(a.db,"purchaseOrders"),(0,r._M)("vendorId","==",e));return(await(0,r.GG)(t)).docs.map(e=>e.data())}async function v(e){const t=(0,r.P)((0,r.rJ)(a.db,"jobAssignments"),(0,r._M)("vendorId","==",e));return(await(0,r.GG)(t)).docs.map(e=>e.data())}async function N(e){const t={};for(const r of e)try{const[e,n]=await Promise.all([b(r.id),v(r.id)]);t[r.id]={totalPOs:e.length,totalJobs:n.length,totalSpend:e.reduce((e,t)=>e+(parseFloat(t.totalAmount)||0),0),completedJobs:n.filter(e=>"completed"===e.status).length,pendingPOs:e.filter(e=>"pending"===e.status).length,avgRating:r.rating||0,lastActivity:Math.max(...e.map(e=>{var t,n,r;return(null===(t=e.createdAt)||void 0===t||null===(n=t.toDate)||void 0===n||null===(r=n.call(t))||void 0===r?void 0:r.getTime())||0}),...n.map(e=>{var t,n,r;return(null===(t=e.createdAt)||void 0===t||null===(n=t.toDate)||void 0===n||null===(r=n.call(t))||void 0===r?void 0:r.getTime())||0}))}}catch(n){t[r.id]={totalPOs:0,totalJobs:0,totalSpend:0,completedJobs:0,pendingPOs:0,avgRating:0,lastActivity:0}}return t}},8434:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var r=n(5043),a=n(3216),s=n(5472),i=n(791),o=n(9369),l=n(9295),d=(n(1432),n(3505)),c=n(5772),u=n(1389),p=n(5239),m=n.n(p);const g=new class{async generatePOPDF(e,t){try{const n=this.createPOElement(e,t);document.body.appendChild(n);const r=await m()(n,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff"});document.body.removeChild(n);const a=r.toDataURL("image/png"),s=new u.Ay("p","mm","a4"),i=210,o=295,l=r.height*i/r.width;let d=l,c=0;for(s.addImage(a,"PNG",0,c,i,l),d-=o;d>=0;)c=d-l,s.addPage(),s.addImage(a,"PNG",0,c,i,l),d-=o;return s}catch(n){throw console.error("Error generating PDF:",n),n}}createPOElement(e,t){const n=document.createElement("div");return n.style.position="absolute",n.style.left="-9999px",n.style.top="0",n.style.width="210mm",n.style.backgroundColor="white",n.style.padding="20px",n.style.fontFamily="Arial, sans-serif",n.style.fontSize="12px",n.style.lineHeight="1.4",n.innerHTML=`\n      <div style="text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px;">\n        <h1 style="font-size: 24px; margin: 0; color: #333;">PURCHASE ORDER</h1>\n        <p style="font-size: 16px; margin: 5px 0; color: #666;">PO Number: ${e.poNumber||"PO"+Date.now()}</p>\n        <p style="font-size: 14px; margin: 0; color: #666;">Date: ${(new Date).toLocaleDateString()}</p>\n      </div>\n\n      <div style="display: flex; justify-content: space-between; margin-bottom: 30px;">\n        <div style="width: 48%;">\n          <h3 style="font-size: 14px; margin: 0 0 10px 0; color: #333;">From:</h3>\n          <div style="font-size: 12px; line-height: 1.5;">\n            <p style="margin: 2px 0; font-weight: bold;">Your Company Name</p>\n            <p style="margin: 2px 0;">123 Business Street</p>\n            <p style="margin: 2px 0;">City, State 12345</p>\n            <p style="margin: 2px 0;">Phone: (555) 123-4567</p>\n            <p style="margin: 2px 0;">Email: info@company.com</p>\n          </div>\n        </div>\n        <div style="width: 48%;">\n          <h3 style="font-size: 14px; margin: 0 0 10px 0; color: #333;">To:</h3>\n          <div style="font-size: 12px; line-height: 1.5;">\n            <p style="margin: 2px 0; font-weight: bold;">${t.name}</p>\n            <p style="margin: 2px 0;">${t.address||"N/A"}</p>\n            <p style="margin: 2px 0;">Phone: ${t.phone}</p>\n            <p style="margin: 2px 0;">Email: ${t.email||"N/A"}</p>\n          </div>\n        </div>\n      </div>\n\n      <div style="margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 5px;">\n        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; font-size: 12px;">\n          <div>\n            <strong>Operation:</strong><br>\n            ${e.operation||"N/A"}\n          </div>\n          <div>\n            <strong>Delivery Date:</strong><br>\n            ${e.deliveryDate?new Date(e.deliveryDate).toLocaleDateString():"TBD"}\n          </div>\n          <div>\n            <strong>Payment Terms:</strong><br>\n            ${e.paymentTerms||30} Days\n          </div>\n          <div>\n            <strong>Priority:</strong><br>\n            ${e.priority||"Medium"}\n          </div>\n        </div>\n      </div>\n\n      <h3 style="font-size: 16px; margin: 20px 0 10px 0; color: #333;">Items / Services</h3>\n      <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 11px;">\n        <thead>\n          <tr style="background-color: #f8f9fa;">\n            <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Description</th>\n            <th style="border: 1px solid #ddd; padding: 8px; text-align: center;">Qty</th>\n            <th style="border: 1px solid #ddd; padding: 8px; text-align: center;">Unit</th>\n            <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">Unit Price</th>\n            <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">Amount</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${(e.items||[]).map(e=>`\n            <tr>\n              <td style="border: 1px solid #ddd; padding: 8px;">\n                <div style="font-weight: bold;">${e.description||"N/A"}</div>\n                ${e.specifications?`<div style="font-size: 10px; color: #666; margin-top: 2px;">${e.specifications}</div>`:""}\n              </td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: center;">${e.quantity||0}</td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: center;">${e.unit||"pcs"}</td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">\u20b9${parseFloat(e.unitPrice||0).toLocaleString()}</td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">\u20b9${parseFloat(e.amount||0).toLocaleString()}</td>\n            </tr>\n          `).join("")}\n        </tbody>\n        <tfoot>\n          <tr style="background-color: #f8f9fa; font-weight: bold;">\n            <td colspan="4" style="border: 1px solid #ddd; padding: 8px; text-align: right;">Subtotal:</td>\n            <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">\u20b9${parseFloat(e.totalAmount||0).toLocaleString()}</td>\n          </tr>\n          ${parseFloat(e.discountAmount||0)>0?`\n            <tr style="background-color: #f8f9fa; font-weight: bold;">\n              <td colspan="4" style="border: 1px solid #ddd; padding: 8px; text-align: right;">Discount:</td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: right; color: red;">-\u20b9${parseFloat(e.discountAmount||0).toLocaleString()}</td>\n            </tr>\n          `:""}\n          ${parseFloat(e.taxAmount||0)>0?`\n            <tr style="background-color: #f8f9fa; font-weight: bold;">\n              <td colspan="4" style="border: 1px solid #ddd; padding: 8px; text-align: right;">Tax (${e.taxRate||0}%):</td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">\u20b9${parseFloat(e.taxAmount||0).toLocaleString()}</td>\n            </tr>\n          `:""}\n          <tr style="background-color: #e9ecef; font-weight: bold; font-size: 12px;">\n            <td colspan="4" style="border: 1px solid #ddd; padding: 10px; text-align: right;">Total Amount:</td>\n            <td style="border: 1px solid #ddd; padding: 10px; text-align: right;">\u20b9${parseFloat(e.finalAmount||0).toLocaleString()}</td>\n          </tr>\n        </tfoot>\n      </table>\n\n      ${e.description?`\n        <div style="margin-bottom: 20px;">\n          <h4 style="font-size: 14px; margin: 0 0 8px 0; color: #333;">Description:</h4>\n          <p style="font-size: 11px; line-height: 1.4; margin: 0;">${e.description}</p>\n        </div>\n      `:""}\n\n      ${e.specifications?`\n        <div style="margin-bottom: 20px;">\n          <h4 style="font-size: 14px; margin: 0 0 8px 0; color: #333;">Technical Specifications:</h4>\n          <p style="font-size: 11px; line-height: 1.4; margin: 0; white-space: pre-line;">${e.specifications}</p>\n        </div>\n      `:""}\n\n      ${e.terms?`\n        <div style="margin-bottom: 20px;">\n          <h4 style="font-size: 14px; margin: 0 0 8px 0; color: #333;">Terms & Conditions:</h4>\n          <p style="font-size: 11px; line-height: 1.4; margin: 0; white-space: pre-line;">${e.terms}</p>\n        </div>\n      `:""}\n\n      <div style="margin-top: 40px; display: flex; justify-content: space-between;">\n        <div style="width: 45%;">\n          <div style="border-top: 1px solid #333; padding-top: 5px; text-align: center;">\n            <p style="font-size: 11px; margin: 0; color: #666;">Authorized Signature</p>\n            <p style="font-size: 10px; margin: 5px 0 0 0; color: #666;">Name & Title</p>\n            <p style="font-size: 10px; margin: 0; color: #666;">Date: ${(new Date).toLocaleDateString()}</p>\n          </div>\n        </div>\n        <div style="width: 45%;">\n          <div style="border-top: 1px solid #333; padding-top: 5px; text-align: center;">\n            <p style="font-size: 11px; margin: 0; color: #666;">Vendor Acknowledgment</p>\n            <p style="font-size: 10px; margin: 5px 0 0 0; color: #666;">Authorized Signature</p>\n            <p style="font-size: 10px; margin: 0; color: #666;">Date: ___________________</p>\n          </div>\n        </div>\n      </div>\n    `,n}downloadPDF(e,t){e.save(t||`PO_${Date.now()}.pdf`)}getPDFBlob(e){return e.output("blob")}getPDFDataURL(e){return e.output("datauristring")}};const h=new class{constructor(){this.uploadEndpoint="https://file.io"}async uploadPDF(e,t){try{const n=new FormData;n.append("file",e,t);const r=await fetch(this.uploadEndpoint,{method:"POST",body:n});if(!r.ok)throw new Error(`Upload failed: ${r.statusText}`);const a=await r.json();if(a.success)return{success:!0,url:a.link,filename:t,expires:a.expires||"1 day"};throw new Error("Upload failed: Invalid response")}catch(n){return console.error("File upload error:",n),{success:!1,error:n.message}}}async createDataURL(e){return new Promise(t=>{const n=new FileReader;n.onload=()=>t(n.result),n.readAsDataURL(e)})}async generateShareableLink(e,t){try{const n={filename:t,data:await this.createDataURL(e),timestamp:Date.now()},r=`po_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;localStorage.setItem(`share_${r}`,JSON.stringify(n));return{success:!0,url:`${window.location.origin}/share/${r}`,filename:t,expires:"7 days"}}catch(n){return console.error("Data URL generation error:",n),{success:!1,error:n.message}}}};const x=new class{constructor(){this.businessName={NODE_ENV:"production",PUBLIC_URL:"/VendorFlow1",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RAZORPAY_KEY_ID:"rzp_test_ehF70nQuE6Bvnr",REACT_APP_RAZORPAY_KEY_SECRET:"F7BrfZOMgL4R1WdnwyGTtM5W"}.REACT_APP_BUSINESS_NAME||"VMT Admin",this.websiteUrl="https://vmttech.in",this.companyName="VMT Technologies"}generatePOMessage(e,t){const n=e.poNumber||"N/A",r=parseFloat(e.finalAmount||e.totalAmount||0).toLocaleString(),a=e.deliveryDate?new Date(e.deliveryDate).toLocaleDateString():"TBD";return`\ud83c\udfe2 *${this.companyName}* - Purchase Order\n\nDear ${t.name},\n\nWe are pleased to share with you our Purchase Order details:\n\n\ud83d\udccb *PO Details:*\n\u2022 PO Number: *${n}*\n\u2022 Date: ${(new Date).toLocaleDateString()}\n\u2022 Total Amount: *\u20b9${r}*\n\u2022 Delivery Date: ${a}\n\n${e.operation?`\u2022 Operation: ${e.operation}`:""}\n\n\ud83d\udcc4 *Document:*\nPlease find the complete Purchase Order document attached with all terms, conditions, and item details.\n\n\ud83c\udf10 *Our Website:*\nVisit us at: ${this.websiteUrl}\nFor more information about our services and company profile.\n\n\ud83d\udcde *Contact Information:*\nFor any queries or clarifications, please contact us directly.\n\nThank you for your continued partnership!\n\nBest regards,\n${this.businessName}\n${this.websiteUrl}`}generatePOMessageWithPDF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=e.poNumber||"N/A",a=parseFloat(e.finalAmount||e.totalAmount||0).toLocaleString(),s=e.deliveryDate?new Date(e.deliveryDate).toLocaleDateString():"TBD";let i=`\ud83c\udfe2 *${this.companyName}* - Purchase Order\n\nDear ${t.name},\n\nWe are pleased to share with you our Purchase Order details:\n\n\ud83d\udccb *PO Details:*\n\u2022 PO Number: *${r}*\n\u2022 Date: ${(new Date).toLocaleDateString()}\n\u2022 Total Amount: *\u20b9${a}*\n\u2022 Delivery Date: ${s}\n\n${e.operation?`\u2022 Operation: ${e.operation}`:""}`;return i+=n?`\n\n\ud83d\udcc4 *Document Link:*\n${n}\n\nPlease download the complete Purchase Order document with all terms, conditions, and item details.`:"\n\n\ud83d\udcc4 *Document:*\nPlease find the complete Purchase Order document attached with all terms, conditions, and item details.",i+=`\n\n\ud83c\udf10 *Our Website:*\nVisit us at: ${this.websiteUrl}\nFor more information about our services and company profile.\n\n\ud83d\udcde *Contact Information:*\nFor any queries or clarifications, please contact us directly.\n\nThank you for your continued partnership!\n\nBest regards,\n${this.businessName}\n${this.websiteUrl}`,i}generateSimplePOMessage(e,t){const n=e.poNumber||"N/A";return`Hello ${t.name},\n\nPlease find attached the Purchase Order #${n}.\n\nVisit us: ${this.websiteUrl}\n\nThank you!\n${this.businessName}`}generateStatusUpdateMessage(e,t,n){const r=e.poNumber||"N/A";return`\ud83c\udfe2 *${this.companyName}* - PO Status Update\n\nPO Number: *${r}*\nStatus: ${n} \u2192 *${t.toUpperCase()}*\n\n${{pending:"\u23f3",approved:"\u2705",rejected:"\u274c",completed:"\ud83c\udf89",in_progress:"\ud83d\udd04",cancelled:"\u274c"}[t]} ${{approved:"Your Purchase Order has been approved! You can proceed with the work.",rejected:"Your Purchase Order has been rejected. Please contact us for more details.",completed:"Purchase Order has been marked as completed. Thank you for your service!",in_progress:"Purchase Order is now in progress. Work has begun.",cancelled:"Purchase Order has been cancelled. Please contact us for more details."}[t]||`PO status has been updated to ${t}.`}\n\n\ud83c\udf10 Visit us: ${this.websiteUrl}\n\n${this.businessName}`}generateGeneralMessage(e,t,n){return`\ud83c\udfe2 *${this.companyName}* - ${e}\n\nDear ${n.name},\n\n${t}\n\n\ud83c\udf10 Visit us: ${this.websiteUrl}\n\nBest regards,\n${this.businessName}`}generateWelcomeMessage(e){return`\ud83c\udfe2 *${this.companyName}* - Welcome!\n\nDear ${e.name},\n\nWelcome to our vendor network! We're excited to work with you.\n\n\ud83c\udf10 *Our Website:*\nVisit us at: ${this.websiteUrl}\nLearn more about our services and company profile.\n\n\ud83d\udcde *Contact Information:*\nFor any questions or support, please don't hesitate to contact us.\n\nWe look forward to a successful partnership!\n\nBest regards,\n${this.businessName}\n${this.websiteUrl}`}};const y=new class{constructor(){this.baseURL={NODE_ENV:"production",PUBLIC_URL:"/VendorFlow1",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RAZORPAY_KEY_ID:"rzp_test_ehF70nQuE6Bvnr",REACT_APP_RAZORPAY_KEY_SECRET:"F7BrfZOMgL4R1WdnwyGTtM5W"}.REACT_APP_WHATSAPP_API_URL||"https://graph.facebook.com/v18.0",this.accessToken={NODE_ENV:"production",PUBLIC_URL:"/VendorFlow1",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RAZORPAY_KEY_ID:"rzp_test_ehF70nQuE6Bvnr",REACT_APP_RAZORPAY_KEY_SECRET:"F7BrfZOMgL4R1WdnwyGTtM5W"}.REACT_APP_WHATSAPP_ACCESS_TOKEN||"1306260161141866|7yXEM5nBjGO291Bz@NXLEvzJFto",this.phoneNumberId={NODE_ENV:"production",PUBLIC_URL:"/VendorFlow1",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RAZORPAY_KEY_ID:"rzp_test_ehF70nQuE6Bvnr",REACT_APP_RAZORPAY_KEY_SECRET:"F7BrfZOMgL4R1WdnwyGTtM5W"}.REACT_APP_WHATSAPP_PHONE_NUMBER_ID||"9503367989",this.businessName={NODE_ENV:"production",PUBLIC_URL:"/VendorFlow1",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RAZORPAY_KEY_ID:"rzp_test_ehF70nQuE6Bvnr",REACT_APP_RAZORPAY_KEY_SECRET:"F7BrfZOMgL4R1WdnwyGTtM5W"}.REACT_APP_BUSINESS_NAME||"VMT Admin"}formatPhoneNumber(e){let t=e.replace(/\D/g,"");return 10===t.length?t="91"+t:t.startsWith("0")&&(t="91"+t.substring(1)),t}async sendPOToVendor(e,t){try{const r=await g.generatePOPDF(e,t),a=this.formatPhoneNumber(t.phone),s=`PO_${e.poNumber||Date.now()}_${t.name.replace(/\s+/g,"_")}.pdf`,i=g.getPDFBlob(r);if(navigator.share&&navigator.canShare)try{const n=new File([i],s,{type:"application/pdf"});if(navigator.canShare({files:[n]}))return await navigator.share({title:`Purchase Order #${e.poNumber||"N/A"}`,text:`Hello ${t.name},\n\nPlease find the Purchase Order #${e.poNumber||"N/A"} attached.\n\nThank you!`,files:[n]}),{success:!0,messageId:"pdf_shared_native",phone:a,filename:s,message:"PDF shared directly via device sharing."}}catch(n){console.log("Web Share API failed, falling back to other methods:",n)}const o=await h.uploadPDF(i,s);if(o.success){const n=x.generatePOMessageWithPDF(e,t,o.url),r=`https://wa.me/${a}?text=${encodeURIComponent(n)}`;return window.open(r,"_blank"),{success:!0,messageId:"pdf_uploaded",phone:a,whatsappUrl:r,filename:s,shareUrl:o.url,message:"PDF uploaded and shared via link. WhatsApp Web opened with the link."}}g.downloadPDF(r,s);const l=x.generateSimplePOMessage(e,t),d=`https://wa.me/${a}?text=${encodeURIComponent(l)}`;return window.open(d,"_blank"),{success:!0,messageId:"pdf_downloaded",phone:a,whatsappUrl:d,filename:s,message:`PDF downloaded as "${s}". WhatsApp Web opened. Please attach the downloaded PDF file.`}}catch(r){return console.error("WhatsApp PDF Service Error:",r),{success:!1,error:r.message||"Failed to generate and share PDF for WhatsApp"}}}generatePOMessage(e,t){return x.generatePOMessage(e,t)}async sendPOStatusUpdate(e,t,n,r){try{var a;if(!this.accessToken||!this.phoneNumberId)return{success:!1,error:"WhatsApp API not configured"};const s=this.formatPhoneNumber(t.phone),i=x.generateStatusUpdateMessage(e,n,r),o=await fetch(`${this.baseURL}/${this.phoneNumberId}/messages`,{method:"POST",headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"},body:JSON.stringify({messaging_product:"whatsapp",to:s,type:"text",text:{body:i}})}),l=await o.json();return o.ok?{success:!0,messageId:l.messages[0].id}:{success:!1,error:null===(a=l.error)||void 0===a?void 0:a.message}}catch(s){return console.error("WhatsApp Status Update Error:",s),{success:!1,error:s.message}}}async sendCustomMessage(e,t){try{var n;if(!this.accessToken||!this.phoneNumberId)return{success:!1,error:"WhatsApp API not configured"};const r=this.formatPhoneNumber(e),a=await fetch(`${this.baseURL}/${this.phoneNumberId}/messages`,{method:"POST",headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"},body:JSON.stringify({messaging_product:"whatsapp",to:r,type:"text",text:{body:t}})}),s=await a.json();return a.ok?{success:!0,messageId:s.messages[0].id}:{success:!1,error:null===(n=s.error)||void 0===n?void 0:n.message}}catch(r){return console.error("WhatsApp Custom Message Error:",r),{success:!1,error:r.message}}}async sendDocument(e,t,n,r){try{var a;if(!this.accessToken||!this.phoneNumberId)return{success:!1,error:"WhatsApp API not configured"};const s=this.formatPhoneNumber(e),i=await fetch(`${this.baseURL}/${this.phoneNumberId}/messages`,{method:"POST",headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"},body:JSON.stringify({messaging_product:"whatsapp",to:s,type:"document",document:{link:t,filename:n,caption:r}})}),o=await i.json();return i.ok?{success:!0,messageId:o.messages[0].id}:{success:!1,error:null===(a=o.error)||void 0===a?void 0:a.message}}catch(s){return console.error("WhatsApp Document Send Error:",s),{success:!1,error:s.message}}}isConfigured(){return!0}async testConnection(){try{if(!this.isConfigured())return{success:!1,error:"WhatsApp API not configured"};return(await fetch(`${this.baseURL}/${this.phoneNumberId}`,{headers:{Authorization:`Bearer ${this.accessToken}`}})).ok?{success:!0}:{success:!1,error:"Invalid credentials"}}catch(e){return{success:!1,error:e.message}}}};var f=n(1847),b=n(579);function v(){const e=(0,a.Zp)(),{id:t}=(0,a.g)(),n=Boolean(t),{showSuccess:u,showError:p}=(0,d.hN)(),[m,g]=(0,r.useState)(!1),[h,x]=(0,r.useState)([]),[v,N]=(0,r.useState)(null),[w,j]=(0,r.useState)([]),[P,A]=(0,r.useState)(!1),[D,S]=(0,r.useState)(!1),[_,O]=(0,r.useState)({vendorId:"",operations:[],description:"",quantity:1,unitPrice:"",totalAmount:"",deliveryDate:"",invoiceDate:(new Date).toISOString().split("T")[0],dueDate:(new Date).toISOString().split("T")[0],stateOfSupply:"",paymentType:"Cash",terms:"",specifications:"",priority:"medium",status:"pending",paymentTerms:"30",shippingAddress:"",billingAddress:"",currency:"INR",taxRate:18,taxAmount:0,discountAmount:0,finalAmount:0,roundOffEnabled:!0,roundOffValue:0,approvalRequired:!0,expectedDeliveryDays:7,warrantPeriod:"",qualityRequirements:"",items:[{id:1,description:"",quantity:1,unitPrice:"",amount:"",unit:"pcs",specifications:"",deliveryDate:"",operation:""}]});(0,r.useEffect)(()=>{E(),T(),n&&k()},[t]),(0,r.useEffect)(()=>{if(_.vendorId){const e=h.find(e=>e.id===_.vendorId);N(e)}},[_.vendorId,h]),(0,r.useEffect)(()=>{R()},[_.items,_.taxRate,_.discountAmount,_.roundOffEnabled]);const E=async()=>{try{const e=await(0,s.GG)((0,s.rJ)(i.db,"vendors")),t=[];e.forEach(e=>{const n={id:e.id,...e.data()};"active"===n.status&&t.push(n)}),x(t)}catch(e){console.error("Error fetching vendors:",e),p("Failed to load vendors")}},T=async()=>{try{const e=await(0,l.E4)();j(e)}catch(e){console.error("Error fetching items:",e)}},k=async()=>{try{g(!0);const a=await(0,o.KN)(t);var e,n,r;if(a)O({...a,operations:Array.isArray(a.operations)?a.operations:a.operation?[a.operation]:[],deliveryDate:(null===(e=a.deliveryDate)||void 0===e||null===(n=e.toDate)||void 0===n||null===(r=n.call(e))||void 0===r?void 0:r.toISOString().split("T")[0])||a.deliveryDate||"",items:(a.items||[{id:1,description:"",quantity:1,unitPrice:"",amount:""}]).map((e,t)=>({id:e.id||t+1,description:e.description||"",quantity:e.quantity||1,unitPrice:e.unitPrice||"",amount:e.amount||"",unit:e.unit||"pcs",specifications:e.specifications||"",deliveryDate:e.deliveryDate||"",operation:e.operation||""}))})}catch(a){console.error("Error fetching PO:",a),p("Failed to load purchase order")}finally{g(!1)}},C=()=>{const e=new Date;return`PO${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}${Math.floor(1e3*Math.random()).toString().padStart(3,"0")}`},R=()=>{const e=_.items.reduce((e,t)=>{const n=parseFloat(t.quantity)*parseFloat(t.unitPrice||0);return e+(isNaN(n)?0:n)},0),t=parseFloat(_.discountAmount||0),n=e-t,r=n*parseFloat(_.taxRate||0)/100;let a=n+r,s=parseFloat(_.roundOffValue||0);if(_.roundOffEnabled){const e=Math.round(a);s=Number((e-a).toFixed(2)),a=e}O(t=>({...t,totalAmount:e.toFixed(2),taxAmount:r.toFixed(2),finalAmount:a.toFixed(2),roundOffValue:s}))},$=e=>{const{name:t,value:n}=e.target;O(e=>({...e,[t]:n}))},I=(e,t,n)=>{const r=_.items.map((r,a)=>{if(a===e){const e={...r,[t]:n};if("quantity"===t||"unitPrice"===t){const r=parseFloat("quantity"===t?n:e.quantity)||0,a=parseFloat("unitPrice"===t?n:e.unitPrice)||0;e.amount=(r*a).toFixed(2)}return e}return r});O(e=>({...e,items:r}))};return m&&n?(0,b.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-indigo-50 to-purple-50",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,b.jsx)("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 mb-8 overflow-hidden",children:(0,b.jsx)("div",{className:"bg-gradient-to-r from-indigo-600 via-blue-600 to-purple-600 px-8 py-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("button",{onClick:()=>e("/admin/purchase-orders"),className:"p-3 bg-white/20 hover:bg-white/30 rounded-xl transition-all duration-200 backdrop-blur-sm",children:(0,b.jsx)(c.kRp,{className:"text-white",size:20})}),(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-sm",children:(0,b.jsx)(c.jH2,{className:"text-white",size:24})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-white",children:n?"Edit Purchase Order":"Create New Purchase Order"}),(0,b.jsx)("p",{className:"text-blue-100 text-sm",children:n?"Update PO details and vendor information":"Generate professional purchase order for vendor operations"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>{_.vendorId?(S(!1),A(!0)):p("Please select vendor before preview")},className:"inline-flex items-center px-6 py-3 bg-white/20 hover:bg-white/30 text-white font-medium rounded-xl transition-all duration-200 backdrop-blur-sm",children:[(0,b.jsx)(c.Vap,{className:"mr-2",size:16}),"Preview"]}),(0,b.jsxs)("button",{type:"button",onClick:()=>{_.vendorId?(S(!0),A(!0)):p("Please select vendor before printing")},className:"inline-flex items-center px-6 py-3 bg-white/20 hover:bg-white/30 text-white font-medium rounded-xl transition-all duration-200 backdrop-blur-sm",children:[(0,b.jsx)(c.a4x,{className:"mr-2",size:16}),"Print"]}),(null===v||void 0===v?void 0:v.phone)&&(0,b.jsx)("button",{type:"button",onClick:async()=>{if(_.vendorId&&_.operations&&_.operations.length)if(v&&v.phone)try{const e={..._,poNumber:_.poNumber||C()},t=await y.sendPOToVendor(e,v);t.success?u(t.message||"PO ready to send via WhatsApp"):p(t.error||"Failed to prepare PO for WhatsApp")}catch(e){console.error("WhatsApp share error:",e),p("Failed to share via WhatsApp")}else p("Selected vendor does not have a valid phone number");else p("Please select vendor and at least one operation before sending")},className:"inline-flex items-center px-6 py-3 bg-green-500/90 hover:bg-green-600 text-white font-medium rounded-xl transition-all duration-200 backdrop-blur-sm",children:"Send via WhatsApp"}),(0,b.jsx)("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl px-4 py-2",children:(0,b.jsx)("span",{className:"text-white text-sm font-medium",children:(new Date).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})})})]})]})})}),(0,b.jsxs)("form",{onSubmit:async r=>{if(r.preventDefault(),_.vendorId)if(_.items.some(e=>!e.description||!e.quantity||!e.unitPrice||!e.operation))p("Please fill in all item details and select operation for each item");else try{g(!0);const r=(0,o.B8)({..._,poNumber:n?_.poNumber:C()});n?(await(0,o.vb)(t,r),u("Purchase order updated successfully")):(await(0,o.G8)(r),u("Purchase order created successfully")),e("/admin/purchase-orders")}catch(a){console.error("Error saving PO:",a),p("Failed to save purchase order")}finally{g(!1)}else p("Please select a vendor")},className:"space-y-8",children:[(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-100",children:(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center",children:(0,b.jsx)(c.S8s,{className:"text-white",size:16})}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Basic Information"}),(0,b.jsx)("div",{className:"flex-1"}),(0,b.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:"Vendor & Operation Details"})]})}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Select Vendor *"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("select",{name:"vendorId",value:_.vendorId,onChange:$,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[(0,b.jsx)("option",{value:"",children:"Choose vendor..."}),h.map(e=>(0,b.jsxs)("option",{value:e.id,children:[e.name," - ",e.category]},e.id))]}),(0,b.jsx)(c.JXP,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]}),v&&(0,b.jsx)("div",{className:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200",children:(0,b.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(c.JXP,{className:"text-blue-600",size:16})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:v.name}),(0,b.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:[(0,b.jsx)("strong",{children:"Contact:"})," ",v.email," | ",v.phone]}),(0,b.jsxs)("p",{className:"text-xs text-gray-600",children:[(0,b.jsx)("strong",{children:"Address:"})," ",v.address]})]})]})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Delivery Date"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"date",name:"deliveryDate",value:_.deliveryDate,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"}),(0,b.jsx)(c.wIk,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Invoice Date"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"date",name:"invoiceDate",value:_.invoiceDate,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"}),(0,b.jsx)(c.wIk,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Due Date"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"date",name:"dueDate",value:_.dueDate,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"}),(0,b.jsx)(c.wIk,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"State of Supply"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{name:"stateOfSupply",value:_.stateOfSupply,onChange:$,placeholder:"Enter state name",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"}),(0,b.jsx)(c.HzC,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Priority Level"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("select",{name:"priority",value:_.priority,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[(0,b.jsx)("option",{value:"low",children:"Low Priority"}),(0,b.jsx)("option",{value:"medium",children:"Medium Priority"}),(0,b.jsx)("option",{value:"high",children:"High Priority"}),(0,b.jsx)("option",{value:"urgent",children:"Urgent"})]}),(0,b.jsx)(c.y3G,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Terms (Days)"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("select",{name:"paymentTerms",value:_.paymentTerms,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[(0,b.jsx)("option",{value:"0",children:"Advance Payment"}),(0,b.jsx)("option",{value:"15",children:"15 Days"}),(0,b.jsx)("option",{value:"30",children:"30 Days"}),(0,b.jsx)("option",{value:"45",children:"45 Days"}),(0,b.jsx)("option",{value:"60",children:"60 Days"}),(0,b.jsx)("option",{value:"90",children:"90 Days"})]}),(0,b.jsx)(c.z8N,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Expected Delivery (Days)"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:"number",name:"expectedDeliveryDays",value:_.expectedDeliveryDays,onChange:$,min:"1",placeholder:"Enter delivery days",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"}),(0,b.jsx)(c.Ohp,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Currency"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("select",{name:"currency",value:_.currency,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[(0,b.jsx)("option",{value:"INR",children:"INR (\u20b9)"}),(0,b.jsx)("option",{value:"USD",children:"USD ($)"}),(0,b.jsx)("option",{value:"EUR",children:"EUR (\u20ac)"})]}),(0,b.jsx)(c.z8N,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]})]}),(0,b.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Work Description"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("textarea",{name:"description",value:_.description,onChange:$,rows:4,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 resize-none",placeholder:"Describe the work to be performed, specifications, and requirements..."}),(0,b.jsx)(c.jH2,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 px-6 py-4 border-b border-gray-100",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center",children:(0,b.jsx)(c.est,{className:"text-white",size:16})}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Items & Services"}),(0,b.jsxs)("span",{className:"bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:[_.items.length," Item",1!==_.items.length?"s":""]})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>{const e={id:Date.now(),description:"",quantity:1,unitPrice:"",amount:"",unit:"pcs",specifications:"",deliveryDate:"",operation:""};O(t=>({...t,items:[...t.items,e]}))},className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white font-medium rounded-xl hover:from-purple-600 hover:to-pink-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[(0,b.jsx)(c.GGD,{className:"mr-2",size:16}),"Add Item"]})]})}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("div",{className:"space-y-4",children:_.items.map((e,t)=>(0,b.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Item"}),(0,b.jsxs)("select",{value:e.itemId||"",onChange:e=>((e,t)=>{const n=w.find(e=>e.id===t);if(!n)return void I(e,"itemId","");const r=_.items.map((t,r)=>{var a,s,i,o;if(r!==e)return t;const l=parseFloat(t.quantity)||1,d=null!==(a=null!==(s=null!=(null===n||void 0===n||null===(i=n.pricing)||void 0===i?void 0:i.salePrice)?Number(n.pricing.salePrice):null)&&void 0!==s?s:null!=(null===n||void 0===n||null===(o=n.pricing)||void 0===o?void 0:o.purchasePrice)?Number(n.pricing.purchasePrice):null)&&void 0!==a?a:parseFloat(t.unitPrice)||0,c=(l*d).toFixed(2);return{...t,itemId:n.id,description:n.name||t.description,unit:n.unit||t.unit||"pcs",unitPrice:d,amount:c}});O(e=>({...e,items:r}))})(t,e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,b.jsx)("option",{value:"",children:"-- Choose --"}),w.map(e=>(0,b.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,b.jsx)("input",{type:"text",value:e.description,onChange:e=>I(t,"description",e.target.value),placeholder:"Item description",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Operation *"}),(0,b.jsxs)("select",{value:e.operation||"",onChange:e=>I(t,"operation",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select Operation"}),(0,b.jsx)("option",{value:"HBL",children:"HBL (Horizontal Boring & Lathe)"}),(0,b.jsx)("option",{value:"VTL",children:"VTL (Vertical Turning Lathe)"}),(0,b.jsx)("option",{value:"Drilling",children:"Drilling"}),(0,b.jsx)("option",{value:"VMC",children:"VMC (Vertical Machining Center)"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),(0,b.jsx)("input",{type:"number",min:"1",value:e.quantity,onChange:e=>I(t,"quantity",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),(0,b.jsxs)("select",{value:e.unit,onChange:e=>I(t,"unit",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,b.jsx)("option",{value:"pcs",children:"Pieces"}),(0,b.jsx)("option",{value:"kg",children:"Kilograms"}),(0,b.jsx)("option",{value:"m",children:"Meters"}),(0,b.jsx)("option",{value:"hrs",children:"Hours"}),(0,b.jsx)("option",{value:"sets",children:"Sets"}),(0,b.jsx)("option",{value:"lots",children:"Lots"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Price *"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",value:e.unitPrice,onChange:e=>I(t,"unitPrice",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),(0,b.jsxs)("div",{className:"flex items-end",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),(0,b.jsx)("input",{type:"text",value:`\u20b9${e.amount}`,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),_.items.length>1&&(0,b.jsx)("button",{type:"button",onClick:()=>(e=>{_.items.length>1&&O(t=>({...t,items:t.items.filter((t,n)=>n!==e)}))})(t),className:"ml-2 p-2 text-red-600 hover:text-red-800",title:"Remove Item",children:(0,b.jsx)(c.IXo,{size:16})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Specifications"}),(0,b.jsx)("textarea",{value:e.specifications,onChange:e=>I(t,"specifications",e.target.value),placeholder:"Technical specifications for this item...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Delivery Date"}),(0,b.jsx)("input",{type:"date",value:e.deliveryDate,onChange:e=>I(t,"deliveryDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]})]},e.id))}),(0,b.jsxs)("div",{className:"mt-6 bg-gray-50 p-4 rounded-lg",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount Amount"}),(0,b.jsx)("input",{type:"number",name:"discountAmount",value:_.discountAmount,onChange:$,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"0.00"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Type"}),(0,b.jsxs)("select",{value:_.paymentType,onChange:e=>O(t=>({...t,paymentType:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,b.jsx)("option",{children:"Cash"}),(0,b.jsx)("option",{children:"Online"}),(0,b.jsx)("option",{children:"Credit"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax Rate (%)"}),(0,b.jsxs)("select",{name:"taxRate",value:_.taxRate,onChange:$,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,b.jsx)("option",{value:"0",children:"No Tax (0%)"}),(0,b.jsx)("option",{value:"5",children:"GST 5%"}),(0,b.jsx)("option",{value:"12",children:"GST 12%"}),(0,b.jsx)("option",{value:"18",children:"GST 18%"}),(0,b.jsx)("option",{value:"28",children:"GST 28%"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Round Off"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("input",{type:"checkbox",checked:_.roundOffEnabled,onChange:e=>O(t=>({...t,roundOffEnabled:e.target.checked})),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,b.jsx)("input",{type:"number",step:"0.01",value:_.roundOffValue,onChange:e=>O(t=>({...t,roundOffValue:e.target.value})),className:"w-28 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-right"})]})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Approval Required"}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",name:"approvalRequired",checked:_.approvalRequired,onChange:e=>O(t=>({...t,approvalRequired:e.target.checked})),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,b.jsx)("label",{className:"ml-2 text-sm text-gray-700",children:"Requires management approval"})]})]})})]}),(0,b.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Subtotal:"}),(0,b.jsxs)("span",{className:"font-medium",children:["\u20b9",parseFloat(_.totalAmount||0).toLocaleString()]})]}),parseFloat(_.discountAmount)>0&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Discount:"}),(0,b.jsxs)("span",{className:"font-medium text-red-600",children:["-\u20b9",parseFloat(_.discountAmount||0).toLocaleString()]})]}),parseFloat(_.taxAmount)>0&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsxs)("span",{className:"text-gray-600",children:["Tax (",_.taxRate,"%):"]}),(0,b.jsxs)("span",{className:"font-medium",children:["\u20b9",parseFloat(_.taxAmount||0).toLocaleString()]})]}),_.roundOffEnabled&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Round Off:"}),(0,b.jsxs)("span",{className:"font-medium",children:["\u20b9",parseFloat(_.roundOffValue||0).toLocaleString()]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-lg font-bold border-t border-gray-300 pt-2",children:[(0,b.jsx)("span",{className:"text-gray-900",children:"Final Amount:"}),(0,b.jsxs)("span",{className:"text-indigo-600",children:["\u20b9",parseFloat(_.finalAmount||0).toLocaleString()]})]})]})})]})]})]}),(0,b.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Technical Specifications"}),(0,b.jsx)("textarea",{name:"specifications",value:_.specifications,onChange:$,rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter technical specifications, tolerances, materials, etc..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quality Requirements"}),(0,b.jsx)("textarea",{name:"qualityRequirements",value:_.qualityRequirements,onChange:$,rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Quality standards, inspection requirements, certifications needed..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shipping Address"}),(0,b.jsx)("textarea",{name:"shippingAddress",value:_.shippingAddress,onChange:$,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Complete shipping address with contact details..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Warranty Period"}),(0,b.jsx)("input",{type:"text",name:"warrantPeriod",value:_.warrantPeriod,onChange:$,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., 12 months, 2 years, etc."})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Terms & Conditions"}),(0,b.jsx)("textarea",{name:"terms",value:_.terms,onChange:$,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Payment terms, delivery conditions, penalties, special conditions..."})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>e("/admin/purchase-orders"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,b.jsxs)("button",{type:"submit",disabled:m,className:"inline-flex items-center px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:[m?(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}):(0,b.jsx)(c.Bc_,{className:"mr-2",size:16}),n?"Update PO":"Create PO"]})]})]}),P&&(0,b.jsx)(f.A,{poData:_,vendor:v,vendorId:_.vendorId,onClose:()=>A(!1),autoPrint:D})]})})}},9295:(e,t,n)=>{n.d(t,{Ds:()=>h,E4:()=>g,U3:()=>c,_r:()=>x,fk:()=>p,uG:()=>d,u_:()=>m,wE:()=>u});var r=n(5472),a=n(8147),s=n(791);const i="items";function o(e){var t,n,r,a,s,i,o,l,d,c,u,p,m,g,h,x;const y=e=>""===e||null===e||void 0===e?null:Number(e);return{name:String(e.name||"").trim(),type:"service"===e.type?"service":"product",hsn:String(e.hsn||"").trim(),code:String(e.code||"").trim(),unit:String(e.unit||"").trim(),category:String(e.category||"").trim(),imageUrl:String(e.imageUrl||"").trim(),pricing:{salePrice:null!==(t=y(null===(n=e.pricing)||void 0===n?void 0:n.salePrice))&&void 0!==t?t:0,purchasePrice:null!==(r=y(null===(a=e.pricing)||void 0===a?void 0:a.purchasePrice))&&void 0!==r?r:0,discountType:["percentage","flat"].includes(null===(s=e.pricing)||void 0===s?void 0:s.discountType)?e.pricing.discountType:"percentage",discountValue:null!==(i=y(null===(o=e.pricing)||void 0===o?void 0:o.discountValue))&&void 0!==i?i:0,taxRate:null!==(l=y(null===(d=e.pricing)||void 0===d?void 0:d.taxRate))&&void 0!==l?l:0,taxMode:["with_tax","without_tax"].includes(null===(c=e.pricing)||void 0===c?void 0:c.taxMode)?e.pricing.taxMode:"without_tax"},stock:{track:Boolean(null===(u=e.stock)||void 0===u?void 0:u.track),openingQty:null!==(p=y(null===(m=e.stock)||void 0===m?void 0:m.openingQty))&&void 0!==p?p:0,minQty:null!==(g=y(null===(h=e.stock)||void 0===h?void 0:h.minQty))&&void 0!==g?g:0,location:String((null===(x=e.stock)||void 0===x?void 0:x.location)||"").trim()},status:"inactive"===e.status?"inactive":"active",notes:String(e.notes||"").trim()}}function l(e){var t,n,r,a,s,i,o,l,d,c,u,p,m,g,h,x;const y=e.data()||{};return{id:e.id,name:y.name||"",type:y.type||"product",hsn:y.hsn||"",code:y.code||"",unit:y.unit||"",category:y.category||"",imageUrl:y.imageUrl||"",pricing:{salePrice:"number"===typeof(null===(t=y.pricing)||void 0===t?void 0:t.salePrice)?y.pricing.salePrice:Number((null===(n=y.pricing)||void 0===n?void 0:n.salePrice)||0),purchasePrice:"number"===typeof(null===(r=y.pricing)||void 0===r?void 0:r.purchasePrice)?y.pricing.purchasePrice:Number((null===(a=y.pricing)||void 0===a?void 0:a.purchasePrice)||0),discountType:(null===(s=y.pricing)||void 0===s?void 0:s.discountType)||"percentage",discountValue:"number"===typeof(null===(i=y.pricing)||void 0===i?void 0:i.discountValue)?y.pricing.discountValue:Number((null===(o=y.pricing)||void 0===o?void 0:o.discountValue)||0),taxRate:"number"===typeof(null===(l=y.pricing)||void 0===l?void 0:l.taxRate)?y.pricing.taxRate:Number((null===(d=y.pricing)||void 0===d?void 0:d.taxRate)||0),taxMode:(null===(c=y.pricing)||void 0===c?void 0:c.taxMode)||"without_tax"},stock:{track:Boolean(null===(u=y.stock)||void 0===u?void 0:u.track),openingQty:"number"===typeof(null===(p=y.stock)||void 0===p?void 0:p.openingQty)?y.stock.openingQty:Number((null===(m=y.stock)||void 0===m?void 0:m.openingQty)||0),minQty:"number"===typeof(null===(g=y.stock)||void 0===g?void 0:g.minQty)?y.stock.minQty:Number((null===(h=y.stock)||void 0===h?void 0:h.minQty)||0),location:(null===(x=y.stock)||void 0===x?void 0:x.location)||""},status:y.status||"active",notes:y.notes||"",createdAt:y.createdAt,updatedAt:y.updatedAt}}function d(e){const t={};return(!e.name||String(e.name).trim().length<2)&&(t.name="Item name is required"),e.unit||(t.unit="Unit is required"),e.pricing&&e.pricing.salePrice<0&&(t.salePrice="Sale price must be >= 0"),e.pricing&&e.pricing.purchasePrice<0&&(t.purchasePrice="Purchase price must be >= 0"),e.pricing&&e.pricing.taxRate<0&&(t.taxRate="Tax rate must be >= 0"),t}async function c(e,t){const n=`items/${t||"tmp"}_${Date.now()}_${e.name}`,r=(0,a.KR)(s.I,n),i=await(0,a.D)(r,e);return(0,a.qk)(i.ref)}async function u(e){const t=d(e);if(Object.keys(t).length){const e=new Error("ITEM_VALIDATION_FAILED");throw e.details=t,e}const n=o(e),a=(0,r.O5)();return{id:(await(0,r.gS)((0,r.rJ)(s.db,i),{...n,createdAt:a,updatedAt:a})).id,...n}}async function p(e,t){const n=d(t);if(Object.keys(n).length){const e=new Error("ITEM_VALIDATION_FAILED");throw e.details=n,e}const a=o(t);await(0,r.mZ)((0,r.H9)(s.db,i,e),{...a,updatedAt:(0,r.O5)()})}async function m(e){const t=await(0,r.x7)((0,r.H9)(s.db,i,e));return t.exists()?l(t):null}async function g(){const e=(0,r.P)((0,r.rJ)(s.db,i),(0,r.My)("createdAt","desc"));return(await(0,r.GG)(e)).docs.map(l)}async function h(e){let{text:t,type:n,category:a,status:o}=e;let d=(await(0,r.GG)((0,r.rJ)(s.db,i))).docs.map(l);if(t){const e=t.toLowerCase();d=d.filter(t=>(t.name||"").toLowerCase().includes(e)||(t.code||"").toLowerCase().includes(e)||(t.hsn||"").toLowerCase().includes(e))}return n&&(d=d.filter(e=>e.type===n)),a&&(d=d.filter(e=>e.category===a)),o&&(d=d.filter(e=>e.status===o)),d}async function x(e){const t=(0,r.wP)(s.db);e.forEach(e=>t.delete((0,r.H9)(s.db,i,e))),await t.commit()}}}]);
//# sourceMappingURL=434.e2b7df37.chunk.js.map