"use strict";(self.webpackChunkvendor_management_system=self.webpackChunkvendor_management_system||[]).push([[404],{1404:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var n=i(5043),s=i(3216),a=i(5475),c=i(5772),l=i(9295),r=i(3505),o=i(579);function d(){const{id:e}=(0,s.g)(),t=Boolean(e)&&"new"!==e,i=(0,s.Zp)(),{showError:d,showSuccess:u}=(0,r.hN)(),[m,p]=(0,n.useState)(!1),[x,g]=(0,n.useState)({}),[h,v]=(0,n.useState)({name:"",type:"product",hsn:"",code:"",unit:"",category:"",imageUrl:"",pricing:{salePrice:"",purchasePrice:"",discountType:"percentage",discountValue:"",taxRate:"",taxMode:"without_tax"},stock:{track:!1,openingQty:"",minQty:"",location:""},status:"active",notes:""});(0,n.useEffect)(()=>{t&&y()},[e]);const y=async()=>{try{p(!0);const t=await(0,l.u_)(e);t&&v({...t})}catch(t){d("Failed to load item")}finally{p(!1)}},b=e=>{const{name:t,value:i,type:n,checked:s}=e.target;v(e=>({...e,[t]:"checkbox"===n?s:i}))},f=e=>{const{name:t,value:i}=e.target;v(e=>({...e,pricing:{...e.pricing,[t]:i}}))},j=e=>{const{name:t,value:i,type:n,checked:s}=e.target;v(e=>({...e,stock:{...e.stock,[t]:"checkbox"===n?s:i}}))},N=async n=>{n.preventDefault();const s=(0,l.uG)(h);if(g(s),Object.keys(s).length)d("Please fix the highlighted fields");else try{p(!0),t?(await(0,l.fk)(e,h),u("Item updated")):(await(0,l.wE)(h),u("Item created")),i("/admin/items")}catch(a){d("Save failed")}finally{p(!1)}};return(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)(a.N_,{to:"/admin/items",className:"inline-flex items-center px-3 py-2 border rounded",children:[(0,o.jsx)(c.kRp,{className:"mr-2"}),"Back"]}),(0,o.jsxs)("button",{onClick:N,disabled:m,className:"px-4 py-2 bg-indigo-600 text-white rounded inline-flex items-center",children:[(0,o.jsx)(c.Bc_,{className:"mr-2"}),m?"Saving...":"Save"]})]}),(0,o.jsxs)("form",{onSubmit:N,className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,o.jsxs)("div",{className:"bg-white border rounded-lg p-6 lg:col-span-2 space-y-4",children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Item Name *"}),(0,o.jsx)("input",{name:"name",value:h.name,onChange:b,className:"mt-1 w-full border rounded px-3 py-2 "+(x.name?"border-red-500":"")})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Type"}),(0,o.jsxs)("select",{name:"type",value:h.type,onChange:b,className:"mt-1 w-full border rounded px-3 py-2",children:[(0,o.jsx)("option",{value:"product",children:"Product"}),(0,o.jsx)("option",{value:"service",children:"Service"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"HSN"}),(0,o.jsx)("input",{name:"hsn",value:h.hsn,onChange:b,className:"mt-1 w-full border rounded px-3 py-2"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Item Code"}),(0,o.jsx)("input",{name:"code",value:h.code,onChange:b,className:"mt-1 w-full border rounded px-3 py-2"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Unit *"}),(0,o.jsx)("input",{name:"unit",value:h.unit,onChange:b,className:"mt-1 w-full border rounded px-3 py-2 "+(x.unit?"border-red-500":"")})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Category"}),(0,o.jsx)("input",{name:"category",value:h.category,onChange:b,className:"mt-1 w-full border rounded px-3 py-2"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Notes"}),(0,o.jsx)("textarea",{name:"notes",value:h.notes,onChange:b,rows:3,className:"mt-1 w-full border rounded px-3 py-2"})]})]}),(0,o.jsxs)("div",{className:"bg-white border rounded-lg p-6 space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Item Image"}),(0,o.jsxs)("div",{className:"mt-1 flex items-center space-x-3",children:[h.imageUrl&&(0,o.jsx)("img",{src:h.imageUrl,alt:"preview",className:"h-16 w-16 object-cover rounded"}),(0,o.jsxs)("label",{className:"inline-flex items-center px-3 py-2 border rounded cursor-pointer",children:[(0,o.jsx)(c.B88,{className:"mr-2"})," Upload",(0,o.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:async t=>{var i;const n=null===(i=t.target.files)||void 0===i?void 0:i[0];if(n)try{p(!0);const t=await(0,l.U3)(n,e||h.code||h.name);v(e=>({...e,imageUrl:t})),u("Image uploaded")}catch(s){d("Image upload failed")}finally{p(!1)}}})]})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Status"}),(0,o.jsxs)("select",{name:"status",value:h.status,onChange:b,className:"mt-1 w-full border rounded px-3 py-2",children:[(0,o.jsx)("option",{value:"active",children:"Active"}),(0,o.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]}),(0,o.jsxs)("div",{className:"bg-white border rounded-lg p-6 lg:col-span-3",children:[(0,o.jsx)("h3",{className:"font-semibold mb-3",children:"Pricing"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Sale Price"}),(0,o.jsx)("input",{name:"salePrice",type:"number",step:"0.01",value:h.pricing.salePrice,onChange:f,className:"mt-1 w-full border rounded px-3 py-2 "+(x.salePrice?"border-red-500":"")})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Purchase Price"}),(0,o.jsx)("input",{name:"purchasePrice",type:"number",step:"0.01",value:h.pricing.purchasePrice,onChange:f,className:"mt-1 w-full border rounded px-3 py-2 "+(x.purchasePrice?"border-red-500":"")})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Tax Rate (%)"}),(0,o.jsx)("input",{name:"taxRate",type:"number",step:"0.01",value:h.pricing.taxRate,onChange:f,className:"mt-1 w-full border rounded px-3 py-2 "+(x.taxRate?"border-red-500":"")})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Tax Mode"}),(0,o.jsxs)("select",{name:"taxMode",value:h.pricing.taxMode,onChange:f,className:"mt-1 w-full border rounded px-3 py-2",children:[(0,o.jsx)("option",{value:"without_tax",children:"Without Tax"}),(0,o.jsx)("option",{value:"with_tax",children:"With Tax"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Discount Type"}),(0,o.jsxs)("select",{name:"discountType",value:h.pricing.discountType,onChange:f,className:"mt-1 w-full border rounded px-3 py-2",children:[(0,o.jsx)("option",{value:"percentage",children:"Percentage"}),(0,o.jsx)("option",{value:"flat",children:"Flat"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Discount Value"}),(0,o.jsx)("input",{name:"discountValue",type:"number",step:"0.01",value:h.pricing.discountValue,onChange:f,className:"mt-1 w-full border rounded px-3 py-2"})]})]})]}),(0,o.jsxs)("div",{className:"bg-white border rounded-lg p-6 lg:col-span-3",children:[(0,o.jsx)("h3",{className:"font-semibold mb-3",children:"Stock"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[(0,o.jsxs)("div",{className:"md:col-span-1 flex items-center space-x-2",children:[(0,o.jsx)("input",{type:"checkbox",name:"track",checked:h.stock.track,onChange:j}),(0,o.jsx)("label",{className:"text-sm font-medium",children:"Track Stock"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Opening Qty"}),(0,o.jsx)("input",{name:"openingQty",type:"number",step:"0.01",value:h.stock.openingQty,onChange:j,className:"mt-1 w-full border rounded px-3 py-2"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Minimum Qty"}),(0,o.jsx)("input",{name:"minQty",type:"number",step:"0.01",value:h.stock.minQty,onChange:j,className:"mt-1 w-full border rounded px-3 py-2"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"text-sm font-medium",children:"Location"}),(0,o.jsx)("input",{name:"location",value:h.stock.location,onChange:j,className:"mt-1 w-full border rounded px-3 py-2"})]})]})]})]})]})}},9295:(e,t,i)=>{i.d(t,{Ds:()=>g,E4:()=>x,U3:()=>d,_r:()=>h,fk:()=>m,uG:()=>o,u_:()=>p,wE:()=>u});var n=i(5472),s=i(8147),a=i(791);const c="items";function l(e){var t,i,n,s,a,c,l,r,o,d,u,m,p,x,g,h;const v=e=>""===e||null===e||void 0===e?null:Number(e);return{name:String(e.name||"").trim(),type:"service"===e.type?"service":"product",hsn:String(e.hsn||"").trim(),code:String(e.code||"").trim(),unit:String(e.unit||"").trim(),category:String(e.category||"").trim(),imageUrl:String(e.imageUrl||"").trim(),pricing:{salePrice:null!==(t=v(null===(i=e.pricing)||void 0===i?void 0:i.salePrice))&&void 0!==t?t:0,purchasePrice:null!==(n=v(null===(s=e.pricing)||void 0===s?void 0:s.purchasePrice))&&void 0!==n?n:0,discountType:["percentage","flat"].includes(null===(a=e.pricing)||void 0===a?void 0:a.discountType)?e.pricing.discountType:"percentage",discountValue:null!==(c=v(null===(l=e.pricing)||void 0===l?void 0:l.discountValue))&&void 0!==c?c:0,taxRate:null!==(r=v(null===(o=e.pricing)||void 0===o?void 0:o.taxRate))&&void 0!==r?r:0,taxMode:["with_tax","without_tax"].includes(null===(d=e.pricing)||void 0===d?void 0:d.taxMode)?e.pricing.taxMode:"without_tax"},stock:{track:Boolean(null===(u=e.stock)||void 0===u?void 0:u.track),openingQty:null!==(m=v(null===(p=e.stock)||void 0===p?void 0:p.openingQty))&&void 0!==m?m:0,minQty:null!==(x=v(null===(g=e.stock)||void 0===g?void 0:g.minQty))&&void 0!==x?x:0,location:String((null===(h=e.stock)||void 0===h?void 0:h.location)||"").trim()},status:"inactive"===e.status?"inactive":"active",notes:String(e.notes||"").trim()}}function r(e){var t,i,n,s,a,c,l,r,o,d,u,m,p,x,g,h;const v=e.data()||{};return{id:e.id,name:v.name||"",type:v.type||"product",hsn:v.hsn||"",code:v.code||"",unit:v.unit||"",category:v.category||"",imageUrl:v.imageUrl||"",pricing:{salePrice:"number"===typeof(null===(t=v.pricing)||void 0===t?void 0:t.salePrice)?v.pricing.salePrice:Number((null===(i=v.pricing)||void 0===i?void 0:i.salePrice)||0),purchasePrice:"number"===typeof(null===(n=v.pricing)||void 0===n?void 0:n.purchasePrice)?v.pricing.purchasePrice:Number((null===(s=v.pricing)||void 0===s?void 0:s.purchasePrice)||0),discountType:(null===(a=v.pricing)||void 0===a?void 0:a.discountType)||"percentage",discountValue:"number"===typeof(null===(c=v.pricing)||void 0===c?void 0:c.discountValue)?v.pricing.discountValue:Number((null===(l=v.pricing)||void 0===l?void 0:l.discountValue)||0),taxRate:"number"===typeof(null===(r=v.pricing)||void 0===r?void 0:r.taxRate)?v.pricing.taxRate:Number((null===(o=v.pricing)||void 0===o?void 0:o.taxRate)||0),taxMode:(null===(d=v.pricing)||void 0===d?void 0:d.taxMode)||"without_tax"},stock:{track:Boolean(null===(u=v.stock)||void 0===u?void 0:u.track),openingQty:"number"===typeof(null===(m=v.stock)||void 0===m?void 0:m.openingQty)?v.stock.openingQty:Number((null===(p=v.stock)||void 0===p?void 0:p.openingQty)||0),minQty:"number"===typeof(null===(x=v.stock)||void 0===x?void 0:x.minQty)?v.stock.minQty:Number((null===(g=v.stock)||void 0===g?void 0:g.minQty)||0),location:(null===(h=v.stock)||void 0===h?void 0:h.location)||""},status:v.status||"active",notes:v.notes||"",createdAt:v.createdAt,updatedAt:v.updatedAt}}function o(e){const t={};return(!e.name||String(e.name).trim().length<2)&&(t.name="Item name is required"),e.unit||(t.unit="Unit is required"),e.pricing&&e.pricing.salePrice<0&&(t.salePrice="Sale price must be >= 0"),e.pricing&&e.pricing.purchasePrice<0&&(t.purchasePrice="Purchase price must be >= 0"),e.pricing&&e.pricing.taxRate<0&&(t.taxRate="Tax rate must be >= 0"),t}async function d(e,t){const i=`items/${t||"tmp"}_${Date.now()}_${e.name}`,n=(0,s.KR)(a.I,i),c=await(0,s.D)(n,e);return(0,s.qk)(c.ref)}async function u(e){const t=o(e);if(Object.keys(t).length){const e=new Error("ITEM_VALIDATION_FAILED");throw e.details=t,e}const i=l(e),s=(0,n.O5)();return{id:(await(0,n.gS)((0,n.rJ)(a.db,c),{...i,createdAt:s,updatedAt:s})).id,...i}}async function m(e,t){const i=o(t);if(Object.keys(i).length){const e=new Error("ITEM_VALIDATION_FAILED");throw e.details=i,e}const s=l(t);await(0,n.mZ)((0,n.H9)(a.db,c,e),{...s,updatedAt:(0,n.O5)()})}async function p(e){const t=await(0,n.x7)((0,n.H9)(a.db,c,e));return t.exists()?r(t):null}async function x(){const e=(0,n.P)((0,n.rJ)(a.db,c),(0,n.My)("createdAt","desc"));return(await(0,n.GG)(e)).docs.map(r)}async function g(e){let{text:t,type:i,category:s,status:l}=e;let o=(await(0,n.GG)((0,n.rJ)(a.db,c))).docs.map(r);if(t){const e=t.toLowerCase();o=o.filter(t=>(t.name||"").toLowerCase().includes(e)||(t.code||"").toLowerCase().includes(e)||(t.hsn||"").toLowerCase().includes(e))}return i&&(o=o.filter(e=>e.type===i)),s&&(o=o.filter(e=>e.category===s)),l&&(o=o.filter(e=>e.status===l)),o}async function h(e){const t=(0,n.wP)(a.db);e.forEach(e=>t.delete((0,n.H9)(a.db,c,e))),await t.commit()}}}]);
//# sourceMappingURL=404.e322ea78.chunk.js.map