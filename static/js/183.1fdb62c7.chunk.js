"use strict";(self.webpackChunkvendor_management_system=self.webpackChunkvendor_management_system||[]).push([[183],{8183:(e,s,t)=>{t.r(s),t.d(s,{default:()=>m});var n=t(5043),r=t(3216),i=t(5475),a=t(5472),o=t(791),d=t(3505),l=t(5772),c=t(579);function m(){const e=(0,r.Zp)(),[s]=(0,i.ok)(),{showSuccess:t,showError:m}=(0,d.hN)(),[u,x]=(0,n.useState)(!1),[g,b]=(0,n.useState)([]),[p,h]=(0,n.useState)(null),[f,y]=(0,n.useState)({vendorId:s.get("vendorId")||"",jobTitle:"",description:"",requirements:"",budget:"",deadline:"",priority:"medium",status:"assigned",location:"",contactPerson:"",contactEmail:"",contactPhone:"",deliverables:[],milestones:[],jobType:"machining",estimatedHours:"",skillsRequired:[],materials:[],safetyRequirements:"",qualityStandards:"",paymentTerms:"net30",currency:"INR",taxRate:"18",advancePayment:"",penaltyClause:"",bonusClause:"",workingHours:"8",overtimeRate:"",equipmentRequired:[],inspectionRequired:!1,certificationRequired:!1,insuranceRequired:!1}),[j,v]=(0,n.useState)({}),[N,w]=(0,n.useState)(!1);(0,n.useEffect)(()=>{C(),f.vendorId&&k(f.vendorId)},[f.vendorId]);const C=async()=>{try{const e=await(0,a.GG)((0,a.rJ)(o.db,"vendors")),s=[];e.forEach(e=>{const t={id:e.id,...e.data()};"active"===t.status&&s.push(t)}),b(s)}catch(e){console.error("Error fetching vendors:",e),m("Failed to load vendors")}},k=async e=>{try{const s=await(0,a.x7)((0,a.H9)(o.db,"vendors",e));s.exists()&&h({id:s.id,...s.data()})}catch(s){console.error("Error fetching vendor details:",s)}},q=e=>{const{name:s,value:t}=e.target;y(e=>({...e,[s]:t})),"vendorId"===s&&k(t)},R=(e,s,t)=>{y(n=>({...n,milestones:n.milestones.map((n,r)=>r===e?{...n,[s]:t}:n)}))};return(0,c.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,c.jsxs)("div",{className:"mb-6",children:[(0,c.jsxs)(i.N_,{to:"/admin/job-assignments",className:"text-indigo-600 hover:text-indigo-800 flex items-center mb-4",children:[(0,c.jsx)(l.kRp,{className:"mr-2"}),"Back to Job Assignments"]}),(0,c.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Assign New Job"})]}),(0,c.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),(()=>{const e={};return f.vendorId||(e.vendorId="Vendor is required"),f.jobTitle.trim()||(e.jobTitle="Job title is required"),f.description.trim()||(e.description="Description is required"),f.deadline||(e.deadline="Deadline is required"),f.budget&&isNaN(f.budget)&&(e.budget="Budget must be a number"),f.estimatedHours&&isNaN(f.estimatedHours)&&(e.estimatedHours="Estimated hours must be a number"),f.taxRate&&(isNaN(f.taxRate)||f.taxRate<0||f.taxRate>100)&&(e.taxRate="Tax rate must be between 0-100"),f.deadline&&new Date(f.deadline)<=new Date&&(e.deadline="Deadline must be in the future"),v(e),0===Object.keys(e).length})())try{x(!0);const s=(()=>{const e=parseFloat(f.budget||0),s=parseFloat(f.taxRate||0),t=parseFloat(f.advancePayment||0),n=e*s/100,r=e+n;return{subtotal:e,taxAmount:n,totalWithTax:r,advancePayment:t,remainingAmount:r-t}})(),n={...f,createdAt:new Date,updatedAt:new Date,assignedBy:"admin",deliverables:f.deliverables.filter(e=>""!==e.trim()),milestones:f.milestones.filter(e=>e.title&&e.date),skillsRequired:f.skillsRequired.filter(e=>""!==e.trim()),materials:f.materials.filter(e=>e.name&&e.quantity),equipmentRequired:f.equipmentRequired.filter(e=>""!==e.trim()),costBreakdown:s,jobNumber:`JOB-${Date.now()}`,estimatedCompletionDate:f.deadline};await(0,a.gS)((0,a.rJ)(o.db,"jobAssignments"),n),t("Job assigned successfully"),e("/admin/job-assignments")}catch(n){console.error("Error assigning job:",n),m("Failed to assign job")}finally{x(!1)}else m("Please fix the validation errors")},className:"space-y-6",children:[(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,c.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,c.jsx)(l.JXP,{className:"mr-2"}),"Vendor Selection"]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Vendor *"}),(0,c.jsxs)("select",{name:"vendorId",value:f.vendorId,onChange:q,required:!0,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,c.jsx)("option",{value:"",children:"Choose a vendor..."}),g.map(e=>(0,c.jsxs)("option",{value:e.id,children:[e.companyName," - ",e.category]},e.id))]})]}),p&&(0,c.jsxs)("div",{className:"bg-gray-50 p-4 rounded-md",children:[(0,c.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Vendor Details"}),(0,c.jsxs)("p",{className:"text-sm text-gray-600",children:["Contact: ",p.contactPerson]}),(0,c.jsxs)("p",{className:"text-sm text-gray-600",children:["Email: ",p.email]}),(0,c.jsxs)("p",{className:"text-sm text-gray-600",children:["Phone: ",p.phone]})]})]})]}),(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,c.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,c.jsx)(l.jH2,{className:"mr-2"}),"Job Details"]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{className:"md:col-span-2",children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Title *"}),(0,c.jsx)("input",{type:"text",name:"jobTitle",value:f.jobTitle,onChange:q,required:!0,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,c.jsxs)("div",{className:"md:col-span-2",children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,c.jsx)("textarea",{name:"description",value:f.description,onChange:q,required:!0,rows:4,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,c.jsxs)("div",{className:"md:col-span-2",children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Requirements"}),(0,c.jsx)("textarea",{name:"requirements",value:f.requirements,onChange:q,rows:3,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Type *"}),(0,c.jsxs)("select",{name:"jobType",value:f.jobType,onChange:q,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,c.jsx)("option",{value:"machining",children:"Machining"}),(0,c.jsx)("option",{value:"fabrication",children:"Fabrication"}),(0,c.jsx)("option",{value:"assembly",children:"Assembly"}),(0,c.jsx)("option",{value:"welding",children:"Welding"}),(0,c.jsx)("option",{value:"inspection",children:"Inspection"}),(0,c.jsx)("option",{value:"maintenance",children:"Maintenance"}),(0,c.jsx)("option",{value:"consulting",children:"Consulting"}),(0,c.jsx)("option",{value:"other",children:"Other"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Budget (\u20b9)"}),(0,c.jsx)("input",{type:"number",name:"budget",value:f.budget,onChange:q,className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 "+(j.budget?"border-red-300":"border-gray-300")}),j.budget&&(0,c.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.budget})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Hours"}),(0,c.jsx)("input",{type:"number",name:"estimatedHours",value:f.estimatedHours,onChange:q,className:"w-full border rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 "+(j.estimatedHours?"border-red-300":"border-gray-300")}),j.estimatedHours&&(0,c.jsx)("p",{className:"text-red-500 text-sm mt-1",children:j.estimatedHours})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deadline *"}),(0,c.jsx)("input",{type:"date",name:"deadline",value:f.deadline,onChange:q,required:!0,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,c.jsxs)("select",{name:"priority",value:f.priority,onChange:q,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,c.jsx)("option",{value:"low",children:"Low"}),(0,c.jsx)("option",{value:"medium",children:"Medium"}),(0,c.jsx)("option",{value:"high",children:"High"}),(0,c.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),(0,c.jsx)("input",{type:"text",name:"location",value:f.location,onChange:q,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]})]}),(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,c.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact Information"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),(0,c.jsx)("input",{type:"text",name:"contactPerson",value:f.contactPerson,onChange:q,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Email"}),(0,c.jsx)("input",{type:"email",name:"contactEmail",value:f.contactEmail,onChange:q,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Phone"}),(0,c.jsx)("input",{type:"tel",name:"contactPhone",value:f.contactPhone,onChange:q,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]})]}),(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Deliverables"}),(0,c.jsx)("button",{type:"button",onClick:()=>{y(e=>({...e,deliverables:[...e.deliverables,""]}))},className:"px-3 py-1 bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200 text-sm",children:"Add Deliverable"})]}),f.deliverables.map((e,s)=>(0,c.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,c.jsx)("input",{type:"text",value:e,onChange:e=>((e,s)=>{y(t=>({...t,deliverables:t.deliverables.map((t,n)=>n===e?s:t)}))})(s,e.target.value),placeholder:"Enter deliverable...",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),(0,c.jsx)("button",{type:"button",onClick:()=>(e=>{y(s=>({...s,deliverables:s.deliverables.filter((s,t)=>t!==e)}))})(s),className:"px-2 py-2 text-red-600 hover:text-red-800",children:"Remove"})]},s))]}),(0,c.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,c.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,c.jsx)(l.wIk,{className:"mr-2"}),"Milestones"]}),(0,c.jsx)("button",{type:"button",onClick:()=>{y(e=>({...e,milestones:[...e.milestones,{title:"",date:"",description:""}]}))},className:"px-3 py-1 bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200 text-sm",children:"Add Milestone"})]}),f.milestones.map((e,s)=>(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 p-4 border border-gray-200 rounded-md",children:[(0,c.jsx)("div",{children:(0,c.jsx)("input",{type:"text",value:e.title,onChange:e=>R(s,"title",e.target.value),placeholder:"Milestone title...",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})}),(0,c.jsx)("div",{children:(0,c.jsx)("input",{type:"date",value:e.date,onChange:e=>R(s,"date",e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})}),(0,c.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,c.jsx)("input",{type:"text",value:e.description,onChange:e=>R(s,"description",e.target.value),placeholder:"Description...",className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),(0,c.jsx)("button",{type:"button",onClick:()=>(e=>{y(s=>({...s,milestones:s.milestones.filter((s,t)=>t!==e)}))})(s),className:"px-2 py-2 text-red-600 hover:text-red-800",children:"Remove"})]})]},s))]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,c.jsx)(i.N_,{to:"/admin/job-assignments",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,c.jsxs)("button",{type:"submit",disabled:u,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 flex items-center",children:[u&&(0,c.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Assign Job"]})]})]})]})}}}]);
//# sourceMappingURL=183.1fdb62c7.chunk.js.map