"use strict";(self.webpackChunkvendor_management_system=self.webpackChunkvendor_management_system||[]).push([[434],{1432:(e,t,n)=>{n.d(t,{DP:()=>c,D_:()=>b,OC:()=>g,_d:()=>x,bB:()=>f,hI:()=>u,oX:()=>o,p$:()=>l,zC:()=>h,zy:()=>N});var r=n(5472),i=n(791);const a="vendors",s="vendorActivity";function o(e){var t,n,r,i,a,s;const o=e=>""===e||null===e||void 0===e?null:Number(e);return{name:String(e.name||"").trim(),email:String(e.email||"").trim().toLowerCase(),phone:String(e.phone||"").trim(),address:String(e.address||"").trim(),city:String(e.city||"").trim(),state:String(e.state||"").trim(),zipCode:String(e.zipCode||"").trim(),country:String(e.country||"India").trim(),website:String(e.website||"").trim(),contactPerson:String(e.contactPerson||"").trim(),contactPhone:String(e.contactPhone||"").trim(),contactEmail:String(e.contactEmail||"").trim().toLowerCase(),category:String(e.category||"").trim(),rating:null!==(t=o(e.rating))&&void 0!==t?t:0,gstNumber:String(e.gstNumber||"").trim(),panNumber:String(e.panNumber||"").trim(),bankDetails:{accountNumber:String((null===(n=e.bankDetails)||void 0===n?void 0:n.accountNumber)||"").trim(),ifscCode:String((null===(r=e.bankDetails)||void 0===r?void 0:r.ifscCode)||"").trim(),bankName:String((null===(i=e.bankDetails)||void 0===i?void 0:i.bankName)||"").trim(),accountHolderName:String((null===(a=e.bankDetails)||void 0===a?void 0:a.accountHolderName)||"").trim()},services:Array.isArray(e.services)?e.services.filter(Boolean):[],status:e.status||"active",notes:String(e.notes||"").trim(),establishedYear:o(e.establishedYear),employeeCount:o(e.employeeCount),annualRevenue:o(e.annualRevenue),creditLimit:o(e.creditLimit),preferredPaymentTerms:null!==(s=o(e.preferredPaymentTerms))&&void 0!==s?s:30,taxId:String(e.taxId||"").trim()}}function d(e){var t,n,r,i,a,s,o,d,l;const c=e.data()||{};return{id:e.id,name:c.name||"",email:c.email||"",phone:c.phone||"",address:c.address||"",city:c.city||"",state:c.state||"",zipCode:c.zipCode||"",country:c.country||"India",website:c.website||"",contactPerson:c.contactPerson||"",contactPhone:c.contactPhone||"",contactEmail:c.contactEmail||"",category:c.category||"",rating:"number"===typeof c.rating?c.rating:Number(c.rating||0),gstNumber:c.gstNumber||"",panNumber:c.panNumber||"",bankDetails:{accountNumber:(null===(t=c.bankDetails)||void 0===t?void 0:t.accountNumber)||"",ifscCode:(null===(n=c.bankDetails)||void 0===n?void 0:n.ifscCode)||"",bankName:(null===(r=c.bankDetails)||void 0===r?void 0:r.bankName)||"",accountHolderName:(null===(i=c.bankDetails)||void 0===i?void 0:i.accountHolderName)||""},services:Array.isArray(c.services)?c.services:[],status:c.status||"active",notes:c.notes||"",establishedYear:null!==(a=c.establishedYear)&&void 0!==a?a:"",employeeCount:null!==(s=c.employeeCount)&&void 0!==s?s:"",annualRevenue:null!==(o=c.annualRevenue)&&void 0!==o?o:"",creditLimit:null!==(d=c.creditLimit)&&void 0!==d?d:"",preferredPaymentTerms:null!==(l=c.preferredPaymentTerms)&&void 0!==l?l:30,taxId:c.taxId||"",createdAt:c.createdAt,updatedAt:c.updatedAt}}async function l(){const e=(0,r.P)((0,r.rJ)(i.db,a),(0,r.My)("createdAt","desc"));return(await(0,r.GG)(e)).docs.map(d)}async function c(){return(await(0,r.GG)((0,r.rJ)(i.db,a))).docs.map(d)}async function u(e){const t=await(0,r.x7)((0,r.H9)(i.db,a,e));return t.exists()?d(t):null}async function p(e,t,n){const s=[];if(e){const t=(0,r.P)((0,r.rJ)(i.db,a),(0,r._M)("email","==",e));(await(0,r.GG)(t)).forEach(e=>s.push(e))}if(t){const e=(0,r.P)((0,r.rJ)(i.db,a),(0,r._M)("phone","==",t));(await(0,r.GG)(e)).forEach(e=>s.push(e))}for(const r of s)if(!n||r.id!==n){const i=r.data();if(e&&i.email===e&&(!n||r.id!==n))return{type:"email",id:r.id};if(t&&i.phone===t&&(!n||r.id!==n))return{type:"phone",id:r.id}}return null}async function m(e,t,n){try{await(0,r.gS)((0,r.rJ)(i.db,s),{vendorId:e,action:t,details:n||{},timestamp:(0,r.O5)()})}catch(a){}}async function h(e){const t=o(e),n=await p(t.email,t.phone);if(n){throw new Error("email"===n.type?"DUPLICATE_VENDOR_EMAIL":"DUPLICATE_VENDOR_PHONE")}const s=(0,r.O5)(),d=await(0,r.gS)((0,r.rJ)(i.db,a),{...t,createdAt:s,updatedAt:s});await m(d.id,"create",{name:t.name,email:t.email})}async function x(e,t){const n=o(t),s=await p(n.email,n.phone,e);if(s){throw new Error("email"===s.type?"DUPLICATE_VENDOR_EMAIL":"DUPLICATE_VENDOR_PHONE")}await(0,r.mZ)((0,r.H9)(i.db,a,e),{...n,updatedAt:(0,r.O5)()}),await m(e,"update",{name:n.name,email:n.email})}async function g(e){await(0,r.kd)((0,r.H9)(i.db,a,e)),await m(e,"delete")}async function b(e,t){const n=(0,r.wP)(i.db);e.forEach(e=>{n.update((0,r.H9)(i.db,a,e),{...t,updatedAt:(0,r.O5)()})}),await n.commit();for(const r of e)m(r,"bulk_update",{fields:t})}async function f(e){const t=(0,r.wP)(i.db);e.forEach(e=>t.delete((0,r.H9)(i.db,a,e))),await t.commit();for(const n of e)m(n,"bulk_delete")}async function y(e){const t=(0,r.P)((0,r.rJ)(i.db,"purchaseOrders"),(0,r._M)("vendorId","==",e));return(await(0,r.GG)(t)).docs.map(e=>e.data())}async function v(e){const t=(0,r.P)((0,r.rJ)(i.db,"jobAssignments"),(0,r._M)("vendorId","==",e));return(await(0,r.GG)(t)).docs.map(e=>e.data())}async function N(e){const t={};for(const r of e)try{const[e,n]=await Promise.all([y(r.id),v(r.id)]);t[r.id]={totalPOs:e.length,totalJobs:n.length,totalSpend:e.reduce((e,t)=>e+(parseFloat(t.totalAmount)||0),0),completedJobs:n.filter(e=>"completed"===e.status).length,pendingPOs:e.filter(e=>"pending"===e.status).length,avgRating:r.rating||0,lastActivity:Math.max(...e.map(e=>{var t,n,r;return(null===(t=e.createdAt)||void 0===t||null===(n=t.toDate)||void 0===n||null===(r=n.call(t))||void 0===r?void 0:r.getTime())||0}),...n.map(e=>{var t,n,r;return(null===(t=e.createdAt)||void 0===t||null===(n=t.toDate)||void 0===n||null===(r=n.call(t))||void 0===r?void 0:r.getTime())||0}))}}catch(n){t[r.id]={totalPOs:0,totalJobs:0,totalSpend:0,completedJobs:0,pendingPOs:0,avgRating:0,lastActivity:0}}return t}},8434:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var r=n(5043),i=n(3216),a=n(5472),s=n(791),o=n(9369),d=n(9295),l=(n(1432),n(3505)),c=n(5772),u=n(1389),p=n(5239),m=n.n(p);const h=new class{async generatePOPDF(e,t){try{const n=this.createPOElement(e,t);document.body.appendChild(n);const r=await m()(n,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff"});document.body.removeChild(n);const i=r.toDataURL("image/png"),a=new u.Ay("p","mm","a4"),s=210,o=295,d=r.height*s/r.width;let l=d,c=0;for(a.addImage(i,"PNG",0,c,s,d),l-=o;l>=0;)c=l-d,a.addPage(),a.addImage(i,"PNG",0,c,s,d),l-=o;return a}catch(n){throw console.error("Error generating PDF:",n),n}}createPOElement(e,t){const n=document.createElement("div");return n.style.position="absolute",n.style.left="-9999px",n.style.top="0",n.style.width="210mm",n.style.backgroundColor="white",n.style.padding="20px",n.style.fontFamily="Arial, sans-serif",n.style.fontSize="12px",n.style.lineHeight="1.4",n.innerHTML=`\n      <div style="text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px;">\n        <h1 style="font-size: 24px; margin: 0; color: #333;">PURCHASE ORDER</h1>\n        <p style="font-size: 16px; margin: 5px 0; color: #666;">PO Number: ${e.poNumber||"PO"+Date.now()}</p>\n        <p style="font-size: 14px; margin: 0; color: #666;">Date: ${(new Date).toLocaleDateString()}</p>\n      </div>\n\n      <div style="display: flex; justify-content: space-between; margin-bottom: 30px;">\n        <div style="width: 48%;">\n          <h3 style="font-size: 14px; margin: 0 0 10px 0; color: #333;">From:</h3>\n          <div style="font-size: 12px; line-height: 1.5;">\n            <p style="margin: 2px 0; font-weight: bold;">Your Company Name</p>\n            <p style="margin: 2px 0;">123 Business Street</p>\n            <p style="margin: 2px 0;">City, State 12345</p>\n            <p style="margin: 2px 0;">Phone: (555) 123-4567</p>\n            <p style="margin: 2px 0;">Email: info@company.com</p>\n          </div>\n        </div>\n        <div style="width: 48%;">\n          <h3 style="font-size: 14px; margin: 0 0 10px 0; color: #333;">To:</h3>\n          <div style="font-size: 12px; line-height: 1.5;">\n            <p style="margin: 2px 0; font-weight: bold;">${t.name}</p>\n            <p style="margin: 2px 0;">${t.address||"N/A"}</p>\n            <p style="margin: 2px 0;">Phone: ${t.phone}</p>\n            <p style="margin: 2px 0;">Email: ${t.email||"N/A"}</p>\n          </div>\n        </div>\n      </div>\n\n      <div style="margin-bottom: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 5px;">\n        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; font-size: 12px;">\n          <div>\n            <strong>Operation:</strong><br>\n            ${e.operation||"N/A"}\n          </div>\n          <div>\n            <strong>Delivery Date:</strong><br>\n            ${e.deliveryDate?new Date(e.deliveryDate).toLocaleDateString():"TBD"}\n          </div>\n          <div>\n            <strong>Payment Terms:</strong><br>\n            ${e.paymentTerms||30} Days\n          </div>\n          <div>\n            <strong>Priority:</strong><br>\n            ${e.priority||"Medium"}\n          </div>\n        </div>\n      </div>\n\n      <h3 style="font-size: 16px; margin: 20px 0 10px 0; color: #333;">Items / Services</h3>\n      <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 11px;">\n        <thead>\n          <tr style="background-color: #f8f9fa;">\n            <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Description</th>\n            <th style="border: 1px solid #ddd; padding: 8px; text-align: center;">Qty</th>\n            <th style="border: 1px solid #ddd; padding: 8px; text-align: center;">Unit</th>\n            <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">Unit Price</th>\n            <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">Amount</th>\n          </tr>\n        </thead>\n        <tbody>\n          ${(e.items||[]).map(e=>`\n            <tr>\n              <td style="border: 1px solid #ddd; padding: 8px;">\n                <div style="font-weight: bold;">${e.description||"N/A"}</div>\n                ${e.specifications?`<div style="font-size: 10px; color: #666; margin-top: 2px;">${e.specifications}</div>`:""}\n              </td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: center;">${e.quantity||0}</td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: center;">${e.unit||"pcs"}</td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">\u20b9${parseFloat(e.unitPrice||0).toLocaleString()}</td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">\u20b9${parseFloat(e.amount||0).toLocaleString()}</td>\n            </tr>\n          `).join("")}\n        </tbody>\n        <tfoot>\n          <tr style="background-color: #f8f9fa; font-weight: bold;">\n            <td colspan="4" style="border: 1px solid #ddd; padding: 8px; text-align: right;">Subtotal:</td>\n            <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">\u20b9${parseFloat(e.totalAmount||0).toLocaleString()}</td>\n          </tr>\n          ${parseFloat(e.discountAmount||0)>0?`\n            <tr style="background-color: #f8f9fa; font-weight: bold;">\n              <td colspan="4" style="border: 1px solid #ddd; padding: 8px; text-align: right;">Discount:</td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: right; color: red;">-\u20b9${parseFloat(e.discountAmount||0).toLocaleString()}</td>\n            </tr>\n          `:""}\n          ${parseFloat(e.taxAmount||0)>0?`\n            <tr style="background-color: #f8f9fa; font-weight: bold;">\n              <td colspan="4" style="border: 1px solid #ddd; padding: 8px; text-align: right;">Tax (${e.taxRate||0}%):</td>\n              <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">\u20b9${parseFloat(e.taxAmount||0).toLocaleString()}</td>\n            </tr>\n          `:""}\n          <tr style="background-color: #e9ecef; font-weight: bold; font-size: 12px;">\n            <td colspan="4" style="border: 1px solid #ddd; padding: 10px; text-align: right;">Total Amount:</td>\n            <td style="border: 1px solid #ddd; padding: 10px; text-align: right;">\u20b9${parseFloat(e.finalAmount||0).toLocaleString()}</td>\n          </tr>\n        </tfoot>\n      </table>\n\n      ${e.description?`\n        <div style="margin-bottom: 20px;">\n          <h4 style="font-size: 14px; margin: 0 0 8px 0; color: #333;">Description:</h4>\n          <p style="font-size: 11px; line-height: 1.4; margin: 0;">${e.description}</p>\n        </div>\n      `:""}\n\n      ${e.specifications?`\n        <div style="margin-bottom: 20px;">\n          <h4 style="font-size: 14px; margin: 0 0 8px 0; color: #333;">Technical Specifications:</h4>\n          <p style="font-size: 11px; line-height: 1.4; margin: 0; white-space: pre-line;">${e.specifications}</p>\n        </div>\n      `:""}\n\n      ${e.terms?`\n        <div style="margin-bottom: 20px;">\n          <h4 style="font-size: 14px; margin: 0 0 8px 0; color: #333;">Terms & Conditions:</h4>\n          <p style="font-size: 11px; line-height: 1.4; margin: 0; white-space: pre-line;">${e.terms}</p>\n        </div>\n      `:""}\n\n      <div style="margin-top: 40px; display: flex; justify-content: space-between;">\n        <div style="width: 45%;">\n          <div style="border-top: 1px solid #333; padding-top: 5px; text-align: center;">\n            <p style="font-size: 11px; margin: 0; color: #666;">Authorized Signature</p>\n            <p style="font-size: 10px; margin: 5px 0 0 0; color: #666;">Name & Title</p>\n            <p style="font-size: 10px; margin: 0; color: #666;">Date: ${(new Date).toLocaleDateString()}</p>\n          </div>\n        </div>\n        <div style="width: 45%;">\n          <div style="border-top: 1px solid #333; padding-top: 5px; text-align: center;">\n            <p style="font-size: 11px; margin: 0; color: #666;">Vendor Acknowledgment</p>\n            <p style="font-size: 10px; margin: 5px 0 0 0; color: #666;">Authorized Signature</p>\n            <p style="font-size: 10px; margin: 0; color: #666;">Date: ___________________</p>\n          </div>\n        </div>\n      </div>\n    `,n}downloadPDF(e,t){e.save(t||`PO_${Date.now()}.pdf`)}getPDFBlob(e){return e.output("blob")}getPDFDataURL(e){return e.output("datauristring")}};const x=new class{constructor(){this.uploadEndpoint="https://file.io"}async uploadPDF(e,t){try{const n=new FormData;n.append("file",e,t);const r=await fetch(this.uploadEndpoint,{method:"POST",body:n});if(!r.ok)throw new Error(`Upload failed: ${r.statusText}`);const i=await r.json();if(i.success)return{success:!0,url:i.link,filename:t,expires:i.expires||"1 day"};throw new Error("Upload failed: Invalid response")}catch(n){return console.error("File upload error:",n),{success:!1,error:n.message}}}async createDataURL(e){return new Promise(t=>{const n=new FileReader;n.onload=()=>t(n.result),n.readAsDataURL(e)})}async generateShareableLink(e,t){try{const n={filename:t,data:await this.createDataURL(e),timestamp:Date.now()},r=`po_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;localStorage.setItem(`share_${r}`,JSON.stringify(n));return{success:!0,url:`${window.location.origin}/share/${r}`,filename:t,expires:"7 days"}}catch(n){return console.error("Data URL generation error:",n),{success:!1,error:n.message}}}};const g=new class{constructor(){this.businessName={NODE_ENV:"production",PUBLIC_URL:"/VendorFlow1",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RAZORPAY_KEY_ID:"rzp_test_ehF70nQuE6Bvnr",REACT_APP_RAZORPAY_KEY_SECRET:"F7BrfZOMgL4R1WdnwyGTtM5W"}.REACT_APP_BUSINESS_NAME||"VMT Admin",this.websiteUrl="https://vmttech.in",this.companyName="VMT Technologies"}generatePOMessage(e,t){const n=e.poNumber||"N/A",r=parseFloat(e.finalAmount||e.totalAmount||0).toLocaleString(),i=e.deliveryDate?new Date(e.deliveryDate).toLocaleDateString():"TBD";return`\ud83c\udfe2 *${this.companyName}* - Purchase Order\n\nDear ${t.name},\n\nWe are pleased to share with you our Purchase Order details:\n\n\ud83d\udccb *PO Details:*\n\u2022 PO Number: *${n}*\n\u2022 Date: ${(new Date).toLocaleDateString()}\n\u2022 Total Amount: *\u20b9${r}*\n\u2022 Delivery Date: ${i}\n\n${e.operation?`\u2022 Operation: ${e.operation}`:""}\n\n\ud83d\udcc4 *Document:*\nPlease find the complete Purchase Order document attached with all terms, conditions, and item details.\n\n\ud83c\udf10 *Our Website:*\nVisit us at: ${this.websiteUrl}\nFor more information about our services and company profile.\n\n\ud83d\udcde *Contact Information:*\nFor any queries or clarifications, please contact us directly.\n\nThank you for your continued partnership!\n\nBest regards,\n${this.businessName}\n${this.websiteUrl}`}generatePOMessageWithPDF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=e.poNumber||"N/A",i=parseFloat(e.finalAmount||e.totalAmount||0).toLocaleString(),a=e.deliveryDate?new Date(e.deliveryDate).toLocaleDateString():"TBD";let s=`\ud83c\udfe2 *${this.companyName}* - Purchase Order\n\nDear ${t.name},\n\nWe are pleased to share with you our Purchase Order details:\n\n\ud83d\udccb *PO Details:*\n\u2022 PO Number: *${r}*\n\u2022 Date: ${(new Date).toLocaleDateString()}\n\u2022 Total Amount: *\u20b9${i}*\n\u2022 Delivery Date: ${a}\n\n${e.operation?`\u2022 Operation: ${e.operation}`:""}`;return s+=n?`\n\n\ud83d\udcc4 *Document Link:*\n${n}\n\nPlease download the complete Purchase Order document with all terms, conditions, and item details.`:"\n\n\ud83d\udcc4 *Document:*\nPlease find the complete Purchase Order document attached with all terms, conditions, and item details.",s+=`\n\n\ud83c\udf10 *Our Website:*\nVisit us at: ${this.websiteUrl}\nFor more information about our services and company profile.\n\n\ud83d\udcde *Contact Information:*\nFor any queries or clarifications, please contact us directly.\n\nThank you for your continued partnership!\n\nBest regards,\n${this.businessName}\n${this.websiteUrl}`,s}generateSimplePOMessage(e,t){const n=e.poNumber||"N/A";return`Hello ${t.name},\n\nPlease find attached the Purchase Order #${n}.\n\nVisit us: ${this.websiteUrl}\n\nThank you!\n${this.businessName}`}generateStatusUpdateMessage(e,t,n){const r=e.poNumber||"N/A";return`\ud83c\udfe2 *${this.companyName}* - PO Status Update\n\nPO Number: *${r}*\nStatus: ${n} \u2192 *${t.toUpperCase()}*\n\n${{pending:"\u23f3",approved:"\u2705",rejected:"\u274c",completed:"\ud83c\udf89",in_progress:"\ud83d\udd04",cancelled:"\u274c"}[t]} ${{approved:"Your Purchase Order has been approved! You can proceed with the work.",rejected:"Your Purchase Order has been rejected. Please contact us for more details.",completed:"Purchase Order has been marked as completed. Thank you for your service!",in_progress:"Purchase Order is now in progress. Work has begun.",cancelled:"Purchase Order has been cancelled. Please contact us for more details."}[t]||`PO status has been updated to ${t}.`}\n\n\ud83c\udf10 Visit us: ${this.websiteUrl}\n\n${this.businessName}`}generateGeneralMessage(e,t,n){return`\ud83c\udfe2 *${this.companyName}* - ${e}\n\nDear ${n.name},\n\n${t}\n\n\ud83c\udf10 Visit us: ${this.websiteUrl}\n\nBest regards,\n${this.businessName}`}generateWelcomeMessage(e){return`\ud83c\udfe2 *${this.companyName}* - Welcome!\n\nDear ${e.name},\n\nWelcome to our vendor network! We're excited to work with you.\n\n\ud83c\udf10 *Our Website:*\nVisit us at: ${this.websiteUrl}\nLearn more about our services and company profile.\n\n\ud83d\udcde *Contact Information:*\nFor any questions or support, please don't hesitate to contact us.\n\nWe look forward to a successful partnership!\n\nBest regards,\n${this.businessName}\n${this.websiteUrl}`}};const b=new class{constructor(){this.baseURL={NODE_ENV:"production",PUBLIC_URL:"/VendorFlow1",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RAZORPAY_KEY_ID:"rzp_test_ehF70nQuE6Bvnr",REACT_APP_RAZORPAY_KEY_SECRET:"F7BrfZOMgL4R1WdnwyGTtM5W"}.REACT_APP_WHATSAPP_API_URL||"https://graph.facebook.com/v18.0",this.accessToken={NODE_ENV:"production",PUBLIC_URL:"/VendorFlow1",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RAZORPAY_KEY_ID:"rzp_test_ehF70nQuE6Bvnr",REACT_APP_RAZORPAY_KEY_SECRET:"F7BrfZOMgL4R1WdnwyGTtM5W"}.REACT_APP_WHATSAPP_ACCESS_TOKEN||"1306260161141866|7yXEM5nBjGO291Bz@NXLEvzJFto",this.phoneNumberId={NODE_ENV:"production",PUBLIC_URL:"/VendorFlow1",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RAZORPAY_KEY_ID:"rzp_test_ehF70nQuE6Bvnr",REACT_APP_RAZORPAY_KEY_SECRET:"F7BrfZOMgL4R1WdnwyGTtM5W"}.REACT_APP_WHATSAPP_PHONE_NUMBER_ID||"9503367989",this.businessName={NODE_ENV:"production",PUBLIC_URL:"/VendorFlow1",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RAZORPAY_KEY_ID:"rzp_test_ehF70nQuE6Bvnr",REACT_APP_RAZORPAY_KEY_SECRET:"F7BrfZOMgL4R1WdnwyGTtM5W"}.REACT_APP_BUSINESS_NAME||"VMT Admin"}formatPhoneNumber(e){let t=e.replace(/\D/g,"");return 10===t.length?t="91"+t:t.startsWith("0")&&(t="91"+t.substring(1)),t}async sendPOToVendor(e,t){try{const r=await h.generatePOPDF(e,t),i=this.formatPhoneNumber(t.phone),a=`PO_${e.poNumber||Date.now()}_${t.name.replace(/\s+/g,"_")}.pdf`,s=h.getPDFBlob(r);if(navigator.share&&navigator.canShare)try{const n=new File([s],a,{type:"application/pdf"});if(navigator.canShare({files:[n]}))return await navigator.share({title:`Purchase Order #${e.poNumber||"N/A"}`,text:`Hello ${t.name},\n\nPlease find the Purchase Order #${e.poNumber||"N/A"} attached.\n\nThank you!`,files:[n]}),{success:!0,messageId:"pdf_shared_native",phone:i,filename:a,message:"PDF shared directly via device sharing."}}catch(n){console.log("Web Share API failed, falling back to other methods:",n)}const o=await x.uploadPDF(s,a);if(o.success){const n=g.generatePOMessageWithPDF(e,t,o.url),r=`https://wa.me/${i}?text=${encodeURIComponent(n)}`;return window.open(r,"_blank"),{success:!0,messageId:"pdf_uploaded",phone:i,whatsappUrl:r,filename:a,shareUrl:o.url,message:"PDF uploaded and shared via link. WhatsApp Web opened with the link."}}h.downloadPDF(r,a);const d=g.generateSimplePOMessage(e,t),l=`https://wa.me/${i}?text=${encodeURIComponent(d)}`;return window.open(l,"_blank"),{success:!0,messageId:"pdf_downloaded",phone:i,whatsappUrl:l,filename:a,message:`PDF downloaded as "${a}". WhatsApp Web opened. Please attach the downloaded PDF file.`}}catch(r){return console.error("WhatsApp PDF Service Error:",r),{success:!1,error:r.message||"Failed to generate and share PDF for WhatsApp"}}}generatePOMessage(e,t){return g.generatePOMessage(e,t)}async sendPOStatusUpdate(e,t,n,r){try{var i;if(!this.accessToken||!this.phoneNumberId)return{success:!1,error:"WhatsApp API not configured"};const a=this.formatPhoneNumber(t.phone),s=g.generateStatusUpdateMessage(e,n,r),o=await fetch(`${this.baseURL}/${this.phoneNumberId}/messages`,{method:"POST",headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"},body:JSON.stringify({messaging_product:"whatsapp",to:a,type:"text",text:{body:s}})}),d=await o.json();return o.ok?{success:!0,messageId:d.messages[0].id}:{success:!1,error:null===(i=d.error)||void 0===i?void 0:i.message}}catch(a){return console.error("WhatsApp Status Update Error:",a),{success:!1,error:a.message}}}async sendCustomMessage(e,t){try{var n;if(!this.accessToken||!this.phoneNumberId)return{success:!1,error:"WhatsApp API not configured"};const r=this.formatPhoneNumber(e),i=await fetch(`${this.baseURL}/${this.phoneNumberId}/messages`,{method:"POST",headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"},body:JSON.stringify({messaging_product:"whatsapp",to:r,type:"text",text:{body:t}})}),a=await i.json();return i.ok?{success:!0,messageId:a.messages[0].id}:{success:!1,error:null===(n=a.error)||void 0===n?void 0:n.message}}catch(r){return console.error("WhatsApp Custom Message Error:",r),{success:!1,error:r.message}}}async sendDocument(e,t,n,r){try{var i;if(!this.accessToken||!this.phoneNumberId)return{success:!1,error:"WhatsApp API not configured"};const a=this.formatPhoneNumber(e),s=await fetch(`${this.baseURL}/${this.phoneNumberId}/messages`,{method:"POST",headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"},body:JSON.stringify({messaging_product:"whatsapp",to:a,type:"document",document:{link:t,filename:n,caption:r}})}),o=await s.json();return s.ok?{success:!0,messageId:o.messages[0].id}:{success:!1,error:null===(i=o.error)||void 0===i?void 0:i.message}}catch(a){return console.error("WhatsApp Document Send Error:",a),{success:!1,error:a.message}}}isConfigured(){return!0}async testConnection(){try{if(!this.isConfigured())return{success:!1,error:"WhatsApp API not configured"};return(await fetch(`${this.baseURL}/${this.phoneNumberId}`,{headers:{Authorization:`Bearer ${this.accessToken}`}})).ok?{success:!0}:{success:!1,error:"Invalid credentials"}}catch(e){return{success:!1,error:e.message}}}};var f=n(579);const y=[{value:"HBL",label:"HBL (Horizontal Boring & Lathe)",description:"Horizontal boring and lathe operations"},{value:"VTL",label:"VTL (Vertical Turning Lathe)",description:"Vertical turning lathe operations"},{value:"Drilling",label:"Drilling",description:"Drilling operations on various materials"},{value:"VMC",label:"VMC (Vertical Machining Center)",description:"Vertical machining center operations"}];function v(){const e=(0,i.Zp)(),{id:t}=(0,i.g)(),n=Boolean(t),{showSuccess:u,showError:p}=(0,l.hN)(),[m,h]=(0,r.useState)(!1),[x,g]=(0,r.useState)([]),[v,j]=(0,r.useState)(null),[w,_]=(0,r.useState)([]),[P,S]=(0,r.useState)(!1),[A,D]=(0,r.useState)({vendorId:"",operations:[],description:"",quantity:1,unitPrice:"",totalAmount:"",deliveryDate:"",invoiceDate:(new Date).toISOString().split("T")[0],dueDate:(new Date).toISOString().split("T")[0],stateOfSupply:"",paymentType:"Cash",terms:"",specifications:"",priority:"medium",status:"pending",paymentTerms:"30",shippingAddress:"",billingAddress:"",currency:"INR",taxRate:18,taxAmount:0,discountAmount:0,finalAmount:0,roundOffEnabled:!0,roundOffValue:0,approvalRequired:!0,expectedDeliveryDays:7,warrantPeriod:"",qualityRequirements:"",items:[{id:1,description:"",quantity:1,unitPrice:"",amount:"",unit:"pcs",specifications:"",deliveryDate:"",operation:""}]});(0,r.useEffect)(()=>{O(),T(),n&&E()},[t]),(0,r.useEffect)(()=>{if(A.vendorId){const e=x.find(e=>e.id===A.vendorId);j(e)}},[A.vendorId,x]),(0,r.useEffect)(()=>{C()},[A.items,A.taxRate,A.discountAmount,A.roundOffEnabled]);const O=async()=>{try{const e=await(0,a.GG)((0,a.rJ)(s.db,"vendors")),t=[];e.forEach(e=>{const n={id:e.id,...e.data()};"active"===n.status&&t.push(n)}),g(t)}catch(e){console.error("Error fetching vendors:",e),p("Failed to load vendors")}},T=async()=>{try{const e=await(0,d.E4)();_(e)}catch(e){console.error("Error fetching items:",e)}},E=async()=>{try{h(!0);const i=await(0,o.KN)(t);var e,n,r;if(i)D({...i,operations:Array.isArray(i.operations)?i.operations:i.operation?[i.operation]:[],deliveryDate:(null===(e=i.deliveryDate)||void 0===e||null===(n=e.toDate)||void 0===n||null===(r=n.call(e))||void 0===r?void 0:r.toISOString().split("T")[0])||i.deliveryDate||"",items:(i.items||[{id:1,description:"",quantity:1,unitPrice:"",amount:""}]).map((e,t)=>({id:e.id||t+1,description:e.description||"",quantity:e.quantity||1,unitPrice:e.unitPrice||"",amount:e.amount||"",unit:e.unit||"pcs",specifications:e.specifications||"",deliveryDate:e.deliveryDate||"",operation:e.operation||""}))})}catch(i){console.error("Error fetching PO:",i),p("Failed to load purchase order")}finally{h(!1)}},k=()=>{const e=new Date;return`PO${e.getFullYear()}${String(e.getMonth()+1).padStart(2,"0")}${String(e.getDate()).padStart(2,"0")}${Math.floor(1e3*Math.random()).toString().padStart(3,"0")}`},C=()=>{const e=A.items.reduce((e,t)=>{const n=parseFloat(t.quantity)*parseFloat(t.unitPrice||0);return e+(isNaN(n)?0:n)},0),t=parseFloat(A.discountAmount||0),n=e-t,r=n*parseFloat(A.taxRate||0)/100;let i=n+r,a=parseFloat(A.roundOffValue||0);if(A.roundOffEnabled){const e=Math.round(i);a=Number((e-i).toFixed(2)),i=e}D(t=>({...t,totalAmount:e.toFixed(2),taxAmount:r.toFixed(2),finalAmount:i.toFixed(2),roundOffValue:a}))},R=e=>{const{name:t,value:n}=e.target;D(e=>({...e,[t]:n}))},I=(e,t,n)=>{const r=A.items.map((r,i)=>{if(i===e){const e={...r,[t]:n};if("quantity"===t||"unitPrice"===t){const r=parseFloat("quantity"===t?n:e.quantity)||0,i=parseFloat("unitPrice"===t?n:e.unitPrice)||0;e.amount=(r*i).toFixed(2)}return e}return r});D(e=>({...e,items:r}))};return m&&n?(0,f.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,f.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):(0,f.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-indigo-50 to-purple-50",children:(0,f.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,f.jsx)("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 mb-8 overflow-hidden",children:(0,f.jsx)("div",{className:"bg-gradient-to-r from-indigo-600 via-blue-600 to-purple-600 px-8 py-6",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,f.jsx)("button",{onClick:()=>e("/admin/purchase-orders"),className:"p-3 bg-white/20 hover:bg-white/30 rounded-xl transition-all duration-200 backdrop-blur-sm",children:(0,f.jsx)(c.kRp,{className:"text-white",size:20})}),(0,f.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,f.jsx)("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-sm",children:(0,f.jsx)(c.jH2,{className:"text-white",size:24})}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h1",{className:"text-2xl font-bold text-white",children:n?"Edit Purchase Order":"Create New Purchase Order"}),(0,f.jsx)("p",{className:"text-blue-100 text-sm",children:n?"Update PO details and vendor information":"Generate professional purchase order for vendor operations"})]})]})]}),(0,f.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,f.jsxs)("button",{type:"button",onClick:()=>{A.vendorId&&A.operations&&A.operations.length?S(!0):p("Please select vendor and at least one operation before preview")},className:"inline-flex items-center px-6 py-3 bg-white/20 hover:bg-white/30 text-white font-medium rounded-xl transition-all duration-200 backdrop-blur-sm",children:[(0,f.jsx)(c.Vap,{className:"mr-2",size:16}),"Preview"]}),(null===v||void 0===v?void 0:v.phone)&&(0,f.jsx)("button",{type:"button",onClick:async()=>{if(A.vendorId&&A.operations&&A.operations.length)if(v&&v.phone)try{const e={...A,poNumber:A.poNumber||k()},t=await b.sendPOToVendor(e,v);t.success?u(t.message||"PO ready to send via WhatsApp"):p(t.error||"Failed to prepare PO for WhatsApp")}catch(e){console.error("WhatsApp share error:",e),p("Failed to share via WhatsApp")}else p("Selected vendor does not have a valid phone number");else p("Please select vendor and at least one operation before sending")},className:"inline-flex items-center px-6 py-3 bg-green-500/90 hover:bg-green-600 text-white font-medium rounded-xl transition-all duration-200 backdrop-blur-sm",children:"Send via WhatsApp"}),(0,f.jsx)("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl px-4 py-2",children:(0,f.jsx)("span",{className:"text-white text-sm font-medium",children:(new Date).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})})})]})]})})}),(0,f.jsxs)("form",{onSubmit:async r=>{if(r.preventDefault(),A.vendorId&&A.operations&&A.operations.length)if(A.items.some(e=>!e.description||!e.quantity||!e.unitPrice))p("Please fill in all item details");else try{h(!0);const r=(0,o.B8)({...A,poNumber:n?A.poNumber:k()});n?(await(0,o.vb)(t,r),u("Purchase order updated successfully")):(await(0,o.G8)(r),u("Purchase order created successfully")),e("/admin/purchase-orders")}catch(i){console.error("Error saving PO:",i),p("Failed to save purchase order")}finally{h(!1)}else p("Please select vendor and at least one operation")},className:"space-y-8",children:[(0,f.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[(0,f.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-100",children:(0,f.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,f.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center",children:(0,f.jsx)(c.S8s,{className:"text-white",size:16})}),(0,f.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Basic Information"}),(0,f.jsx)("div",{className:"flex-1"}),(0,f.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:"Vendor & Operation Details"})]})}),(0,f.jsxs)("div",{className:"p-6",children:[(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Select Vendor *"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsxs)("select",{name:"vendorId",value:A.vendorId,onChange:R,required:!0,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[(0,f.jsx)("option",{value:"",children:"Choose vendor..."}),x.map(e=>(0,f.jsxs)("option",{value:e.id,children:[e.name," - ",e.category]},e.id))]}),(0,f.jsx)(c.JXP,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]}),v&&(0,f.jsx)("div",{className:"mt-3 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200",children:(0,f.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,f.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,f.jsx)(c.JXP,{className:"text-blue-600",size:16})}),(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("p",{className:"text-sm font-medium text-gray-900",children:v.name}),(0,f.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:[(0,f.jsx)("strong",{children:"Contact:"})," ",v.email," | ",v.phone]}),(0,f.jsxs)("p",{className:"text-xs text-gray-600",children:[(0,f.jsx)("strong",{children:"Address:"})," ",v.address]})]})]})})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Operation Type(s) *"}),(0,f.jsxs)("div",{className:"relative p-3 border border-gray-300 rounded-xl",children:[(0,f.jsx)(c.i5c,{className:"absolute left-3 top-3.5 text-gray-400",size:16}),(0,f.jsx)("div",{className:"pl-6 grid grid-cols-1 sm:grid-cols-2 gap-2",children:y.map(e=>{const t=A.operations.includes(e.value);return(0,f.jsxs)("label",{className:"inline-flex items-center space-x-2",children:[(0,f.jsx)("input",{type:"checkbox",checked:t,onChange:t=>{const n=t.target.checked?[...A.operations,e.value]:A.operations.filter(t=>t!==e.value);D(e=>({...e,operations:n}))},className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,f.jsx)("span",{className:"text-sm text-gray-800",children:e.label})]},e.value)})})]}),A.operations.length>0&&(0,f.jsx)("div",{className:"mt-2 p-3 bg-green-50 rounded-lg border border-green-200",children:(0,f.jsxs)("p",{className:"text-sm text-green-800",children:[(0,f.jsx)(c.YrT,{className:"inline mr-2",size:14}),"Selected: ",A.operations.map(e=>{var t;return(null===(t=y.find(t=>t.value===e))||void 0===t?void 0:t.label)||e}).join(", ")]})})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Delivery Date"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)("input",{type:"date",name:"deliveryDate",value:A.deliveryDate,onChange:R,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"}),(0,f.jsx)(c.wIk,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Invoice Date"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)("input",{type:"date",name:"invoiceDate",value:A.invoiceDate,onChange:R,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"}),(0,f.jsx)(c.wIk,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Due Date"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)("input",{type:"date",name:"dueDate",value:A.dueDate,onChange:R,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"}),(0,f.jsx)(c.wIk,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"State of Supply"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)("input",{name:"stateOfSupply",value:A.stateOfSupply,onChange:R,placeholder:"Enter state name",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"}),(0,f.jsx)(c.HzC,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Priority Level"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsxs)("select",{name:"priority",value:A.priority,onChange:R,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[(0,f.jsx)("option",{value:"low",children:"Low Priority"}),(0,f.jsx)("option",{value:"medium",children:"Medium Priority"}),(0,f.jsx)("option",{value:"high",children:"High Priority"}),(0,f.jsx)("option",{value:"urgent",children:"Urgent"})]}),(0,f.jsx)(c.y3G,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Terms (Days)"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsxs)("select",{name:"paymentTerms",value:A.paymentTerms,onChange:R,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[(0,f.jsx)("option",{value:"0",children:"Advance Payment"}),(0,f.jsx)("option",{value:"15",children:"15 Days"}),(0,f.jsx)("option",{value:"30",children:"30 Days"}),(0,f.jsx)("option",{value:"45",children:"45 Days"}),(0,f.jsx)("option",{value:"60",children:"60 Days"}),(0,f.jsx)("option",{value:"90",children:"90 Days"})]}),(0,f.jsx)(c.z8N,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Expected Delivery (Days)"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)("input",{type:"number",name:"expectedDeliveryDays",value:A.expectedDeliveryDays,onChange:R,min:"1",placeholder:"Enter delivery days",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200"}),(0,f.jsx)(c.Ohp,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]}),(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Currency"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsxs)("select",{name:"currency",value:A.currency,onChange:R,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 appearance-none bg-white",children:[(0,f.jsx)("option",{value:"INR",children:"INR (\u20b9)"}),(0,f.jsx)("option",{value:"USD",children:"USD ($)"}),(0,f.jsx)("option",{value:"EUR",children:"EUR (\u20ac)"})]}),(0,f.jsx)(c.z8N,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]})]}),(0,f.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Work Description"}),(0,f.jsxs)("div",{className:"relative",children:[(0,f.jsx)("textarea",{name:"description",value:A.description,onChange:R,rows:4,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 resize-none",placeholder:"Describe the work to be performed, specifications, and requirements..."}),(0,f.jsx)(c.jH2,{className:"absolute left-3 top-3.5 text-gray-400",size:16})]})]})]})]}),(0,f.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden",children:[(0,f.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 px-6 py-4 border-b border-gray-100",children:(0,f.jsxs)("div",{className:"flex items-center justify-between",children:[(0,f.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,f.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center",children:(0,f.jsx)(c.est,{className:"text-white",size:16})}),(0,f.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Items & Services"}),(0,f.jsxs)("span",{className:"bg-purple-100 text-purple-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:[A.items.length," Item",1!==A.items.length?"s":""]})]}),(0,f.jsxs)("button",{type:"button",onClick:()=>{const e={id:Date.now(),description:"",quantity:1,unitPrice:"",amount:"",unit:"pcs",specifications:"",deliveryDate:""};D(t=>({...t,items:[...t.items,e]}))},className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-600 text-white font-medium rounded-xl hover:from-purple-600 hover:to-pink-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[(0,f.jsx)(c.GGD,{className:"mr-2",size:16}),"Add Item"]})]})}),(0,f.jsxs)("div",{className:"p-6",children:[(0,f.jsx)("div",{className:"space-y-4",children:A.items.map((e,t)=>(0,f.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg",children:[(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Item"}),(0,f.jsxs)("select",{value:e.itemId||"",onChange:e=>((e,t)=>{const n=w.find(e=>e.id===t);if(!n)return void I(e,"itemId","");const r=A.items.map((t,r)=>{var i,a,s,o;if(r!==e)return t;const d=parseFloat(t.quantity)||1,l=null!==(i=null!==(a=null!=(null===n||void 0===n||null===(s=n.pricing)||void 0===s?void 0:s.salePrice)?Number(n.pricing.salePrice):null)&&void 0!==a?a:null!=(null===n||void 0===n||null===(o=n.pricing)||void 0===o?void 0:o.purchasePrice)?Number(n.pricing.purchasePrice):null)&&void 0!==i?i:parseFloat(t.unitPrice)||0,c=(d*l).toFixed(2);return{...t,itemId:n.id,description:n.name||t.description,unit:n.unit||t.unit||"pcs",unitPrice:l,amount:c}});D(e=>({...e,items:r}))})(t,e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,f.jsx)("option",{value:"",children:"-- Choose --"}),w.map(e=>(0,f.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,f.jsxs)("div",{className:"md:col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,f.jsx)("input",{type:"text",value:e.description,onChange:e=>I(t,"description",e.target.value),placeholder:"Item description",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),(0,f.jsx)("input",{type:"number",min:"1",value:e.quantity,onChange:e=>I(t,"quantity",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),(0,f.jsxs)("select",{value:e.unit,onChange:e=>I(t,"unit",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,f.jsx)("option",{value:"pcs",children:"Pieces"}),(0,f.jsx)("option",{value:"kg",children:"Kilograms"}),(0,f.jsx)("option",{value:"m",children:"Meters"}),(0,f.jsx)("option",{value:"hrs",children:"Hours"}),(0,f.jsx)("option",{value:"sets",children:"Sets"}),(0,f.jsx)("option",{value:"lots",children:"Lots"})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Price *"}),(0,f.jsx)("input",{type:"number",step:"0.01",min:"0",value:e.unitPrice,onChange:e=>I(t,"unitPrice",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),(0,f.jsxs)("div",{className:"flex items-end",children:[(0,f.jsxs)("div",{className:"flex-1",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),(0,f.jsx)("input",{type:"text",value:`\u20b9${e.amount}`,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),A.items.length>1&&(0,f.jsx)("button",{type:"button",onClick:()=>(e=>{A.items.length>1&&D(t=>({...t,items:t.items.filter((t,n)=>n!==e)}))})(t),className:"ml-2 p-2 text-red-600 hover:text-red-800",title:"Remove Item",children:(0,f.jsx)(c.IXo,{size:16})})]})]}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Specifications"}),(0,f.jsx)("textarea",{value:e.specifications,onChange:e=>I(t,"specifications",e.target.value),placeholder:"Technical specifications for this item...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Delivery Date"}),(0,f.jsx)("input",{type:"date",value:e.deliveryDate,onChange:e=>I(t,"deliveryDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]})]},e.id))}),(0,f.jsxs)("div",{className:"mt-6 bg-gray-50 p-4 rounded-lg",children:[(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount Amount"}),(0,f.jsx)("input",{type:"number",name:"discountAmount",value:A.discountAmount,onChange:R,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"0.00"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Type"}),(0,f.jsxs)("select",{value:A.paymentType,onChange:e=>D(t=>({...t,paymentType:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,f.jsx)("option",{children:"Cash"}),(0,f.jsx)("option",{children:"Online"}),(0,f.jsx)("option",{children:"Credit"})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax Rate (%)"}),(0,f.jsxs)("select",{name:"taxRate",value:A.taxRate,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,f.jsx)("option",{value:"0",children:"No Tax (0%)"}),(0,f.jsx)("option",{value:"5",children:"GST 5%"}),(0,f.jsx)("option",{value:"12",children:"GST 12%"}),(0,f.jsx)("option",{value:"18",children:"GST 18%"}),(0,f.jsx)("option",{value:"28",children:"GST 28%"})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Round Off"}),(0,f.jsxs)("div",{className:"flex items-center gap-3",children:[(0,f.jsx)("input",{type:"checkbox",checked:A.roundOffEnabled,onChange:e=>D(t=>({...t,roundOffEnabled:e.target.checked})),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,f.jsx)("input",{type:"number",step:"0.01",value:A.roundOffValue,onChange:e=>D(t=>({...t,roundOffValue:e.target.value})),className:"w-28 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-right"})]})]}),(0,f.jsx)("div",{className:"flex items-end",children:(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Approval Required"}),(0,f.jsxs)("div",{className:"flex items-center",children:[(0,f.jsx)("input",{type:"checkbox",name:"approvalRequired",checked:A.approvalRequired,onChange:e=>D(t=>({...t,approvalRequired:e.target.checked})),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,f.jsx)("label",{className:"ml-2 text-sm text-gray-700",children:"Requires management approval"})]})]})})]}),(0,f.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,f.jsxs)("div",{className:"space-y-2",children:[(0,f.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,f.jsx)("span",{className:"text-gray-600",children:"Subtotal:"}),(0,f.jsxs)("span",{className:"font-medium",children:["\u20b9",parseFloat(A.totalAmount||0).toLocaleString()]})]}),parseFloat(A.discountAmount)>0&&(0,f.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,f.jsx)("span",{className:"text-gray-600",children:"Discount:"}),(0,f.jsxs)("span",{className:"font-medium text-red-600",children:["-\u20b9",parseFloat(A.discountAmount||0).toLocaleString()]})]}),parseFloat(A.taxAmount)>0&&(0,f.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,f.jsxs)("span",{className:"text-gray-600",children:["Tax (",A.taxRate,"%):"]}),(0,f.jsxs)("span",{className:"font-medium",children:["\u20b9",parseFloat(A.taxAmount||0).toLocaleString()]})]}),A.roundOffEnabled&&(0,f.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,f.jsx)("span",{className:"text-gray-600",children:"Round Off:"}),(0,f.jsxs)("span",{className:"font-medium",children:["\u20b9",parseFloat(A.roundOffValue||0).toLocaleString()]})]}),(0,f.jsxs)("div",{className:"flex justify-between text-lg font-bold border-t border-gray-300 pt-2",children:[(0,f.jsx)("span",{className:"text-gray-900",children:"Final Amount:"}),(0,f.jsxs)("span",{className:"text-indigo-600",children:["\u20b9",parseFloat(A.finalAmount||0).toLocaleString()]})]})]})})]})]})]}),(0,f.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,f.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Details"}),(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Technical Specifications"}),(0,f.jsx)("textarea",{name:"specifications",value:A.specifications,onChange:R,rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter technical specifications, tolerances, materials, etc..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quality Requirements"}),(0,f.jsx)("textarea",{name:"qualityRequirements",value:A.qualityRequirements,onChange:R,rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Quality standards, inspection requirements, certifications needed..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Shipping Address"}),(0,f.jsx)("textarea",{name:"shippingAddress",value:A.shippingAddress,onChange:R,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Complete shipping address with contact details..."})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Warranty Period"}),(0,f.jsx)("input",{type:"text",name:"warrantPeriod",value:A.warrantPeriod,onChange:R,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"e.g., 12 months, 2 years, etc."})]}),(0,f.jsxs)("div",{className:"md:col-span-2",children:[(0,f.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Terms & Conditions"}),(0,f.jsx)("textarea",{name:"terms",value:A.terms,onChange:R,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Payment terms, delivery conditions, penalties, special conditions..."})]})]})]}),(0,f.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,f.jsx)("button",{type:"button",onClick:()=>e("/admin/purchase-orders"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,f.jsxs)("button",{type:"submit",disabled:m,className:"inline-flex items-center px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:[m?(0,f.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}):(0,f.jsx)(c.Bc_,{className:"mr-2",size:16}),n?"Update PO":"Create PO"]})]})]}),P&&(0,f.jsx)(N,{formData:A,selectedVendor:v,onClose:()=>S(!1)})]})})}function N(e){let{formData:t,selectedVendor:n,onClose:r}=e;const i=e=>new Intl.NumberFormat("en-IN",{maximumFractionDigits:2,minimumFractionDigits:2}).format(e),a=e=>{const t=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],n=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","Ten","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(0===e)return"Zero";let i="";return Math.floor(e/1e7)>0&&(i+=a(Math.floor(e/1e7))+" Crore ",e%=1e7),Math.floor(e/1e5)>0&&(i+=a(Math.floor(e/1e5))+" Lakh ",e%=1e5),Math.floor(e/1e3)>0&&(i+=a(Math.floor(e/1e3))+" Thousand ",e%=1e3),Math.floor(e/100)>0&&(i+=a(Math.floor(e/100))+" Hundred ",e%=100),e>0&&(""!==i&&(i+="and "),e<10?i+=t[e]:e<20?i+=n[e-10]:(i+=r[Math.floor(e/10)],e%10>0&&(i+=" "+t[e%10]))),i.trim()},s=a(Math.floor(parseFloat(t.finalAmount||0)))+" Rupees"+(parseFloat(t.finalAmount||0)%1!==0?` and ${Math.round(parseFloat(t.finalAmount||0)%1*100)} Paise`:"");return(0,f.jsx)("div",{className:"print-overlay fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,f.jsxs)("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[(0,f.jsx)("style",{children:"\n            @media print {\n              @page { \n                size: A4 portrait; \n                margin: 10mm 15mm 15mm 15mm;\n              }\n              body { \n                -webkit-print-color-adjust: exact; \n                print-color-adjust: exact; \n                background: white !important;\n              }\n              * { \n                background: transparent !important; \n                box-shadow: none !important; \n                text-shadow: none !important;\n              }\n              /* Hide everything except the printable overlay */\n              body * { visibility: hidden !important; }\n              .print-overlay, .print-overlay * { visibility: visible !important; }\n              /* Normalize overlay into normal flow for print */\n              .print-overlay { \n                position: static !important; \n                inset: auto !important; \n                padding: 0 !important; \n                background: transparent !important; \n                overflow: visible !important;\n              }\n              html, body { \n                overflow: visible !important; \n                height: auto !important;\n                width: 210mm !important;\n                margin: 0 !important;\n                padding: 0 !important;\n              }\n              #po-preview { \n                width: 100% !important; \n                margin: 0 !important;\n                padding: 0 !important;\n              }\n              .no-print { display: none !important; }\n              .print-a4 { \n                box-shadow: none !important; \n                margin: 0 !important;\n                padding: 0 !important;\n              }\n              .page-break { page-break-after: always; }\n            }\n            \n            .print-a4 { \n              max-width: 210mm; \n              margin: 18px auto; \n              background: white; \n              font-family: 'Helvetica', 'Arial', sans-serif; \n              line-height: 1.35; \n              color: #000;\n              font-size: 12px;\n            }\n            \n            .company-header {\n              border-bottom: 2px solid #2c5282;\n              padding-bottom: 10px;\n              margin-bottom: 15px;\n            }\n            \n            .po-title { \n              background: #2c5282; \n              color: white; \n              padding: 8px 15px;\n              font-weight: bold;\n              font-size: 16px;\n              text-align: center;\n              border-radius: 4px;\n              margin: 10px 0;\n            }\n            \n            .section-title { \n              font-size: 13px; \n              font-weight: bold; \n              padding-bottom: 4px; \n              margin-bottom: 8px; \n              border-bottom: 1px solid #ccc;\n              text-transform: uppercase;\n              color: #2c5282;\n            }\n            \n            .table { \n              width: 100%; \n              border-collapse: collapse; \n              margin: 10px 0;\n            }\n            \n            .table th { \n              background: #f0f4f8; \n              border: 1px solid #ccc; \n              padding: 6px 8px; \n              font-size: 11px; \n              font-weight: bold;\n              text-align: left;\n            }\n            \n            .table td { \n              border: 1px solid #ccc; \n              padding: 6px 8px; \n              font-size: 11px;\n              vertical-align: top;\n            }\n            \n            .table-footer td {\n              font-weight: bold;\n              background: #f8f9fa;\n            }\n            \n            .signature-area {\n              margin-top: 40px;\n              border-top: 1px dashed #ccc;\n              padding-top: 15px;\n            }\n            \n            .terms-box {\n              border: 1px solid #ccc;\n              padding: 10px;\n              margin: 10px 0;\n              background: #f9f9f9;\n              font-size: 11px;\n            }\n            \n            .amount-in-words {\n              padding: 8px;\n              background: #f0f4f8;\n              border: 1px solid #ccc;\n              margin: 10px 0;\n              font-style: italic;\n            }\n            \n            .footer {\n              margin-top: 30px;\n              font-size: 10px;\n              text-align: center;\n              color: #666;\n            }\n          "}),(0,f.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center no-print",children:[(0,f.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Print Purchase Order"}),(0,f.jsxs)("div",{className:"flex space-x-2",children:[(0,f.jsxs)("button",{onClick:()=>{window.print()},className:"inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[(0,f.jsx)(c.a4x,{className:"mr-2",size:16})," Print / Save PDF"]}),(0,f.jsx)("button",{onClick:r,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Close"})]})]}),(0,f.jsxs)("div",{className:"print-a4 p-10",id:"po-preview",children:[(0,f.jsx)("div",{className:"company-header",children:(0,f.jsxs)("div",{className:"flex justify-between items-start",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"text-xl font-bold",children:"INDUSTRIAL MACHINING SOLUTIONS"}),(0,f.jsx)("div",{className:"text-sm",children:"Registered Office: 123 Industrial Estate, Phase II"}),(0,f.jsx)("div",{className:"text-sm",children:"Mumbai - 400 001, Maharashtra, India"}),(0,f.jsx)("div",{className:"text-sm",children:"GSTIN: 27ABCDE1234F1Z5 \u2022 PAN: ABCDE1234F"}),(0,f.jsx)("div",{className:"text-sm",children:"Phone: +91-22-12345678 \u2022 Email: operations@industrial-machining.com"})]}),(0,f.jsxs)("div",{className:"text-right",children:[(0,f.jsx)("div",{className:"text-sm",children:"CIN: U74999MH2020PTC123456"}),(0,f.jsx)("div",{className:"text-sm",children:"Website: www.industrial-machining.com"})]})]})}),(0,f.jsx)("div",{className:"po-title",children:"PURCHASE ORDER"}),(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-8 mb-6",children:[(0,f.jsx)("div",{children:(0,f.jsx)("table",{className:"details-table",children:(0,f.jsxs)("tbody",{children:[(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"font-bold pr-4",children:"PO Number:"}),(0,f.jsx)("td",{children:t.poNumber||"PO"+(new Date).getTime().toString().slice(-6)})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"font-bold",children:"PO Date:"}),(0,f.jsx)("td",{children:(new Date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"font-bold",children:"Reference:"}),(0,f.jsxs)("td",{children:["REF/",(new Date).getFullYear(),"/",Math.floor(1e3+9e3*Math.random())]})]})]})})}),(0,f.jsx)("div",{children:(0,f.jsx)("table",{className:"details-table",children:(0,f.jsxs)("tbody",{children:[(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"font-bold pr-4",children:"Operation Type:"}),(0,f.jsx)("td",{children:t.operations&&t.operations.length>0?t.operations.map(e=>{var t;return(null===(t=y.find(t=>t.value===e))||void 0===t?void 0:t.label)||e}).join(", "):"Not Specified"})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"font-bold",children:"Delivery By:"}),(0,f.jsx)("td",{children:t.deliveryDate?new Date(t.deliveryDate).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"}):"TBD"})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"font-bold",children:"Payment Terms:"}),(0,f.jsxs)("td",{children:[t.paymentTerms," Days"]})]})]})})})]}),(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsx)("div",{className:"section-title",children:"VENDOR DETAILS"}),n?(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"font-bold",children:n.name}),(0,f.jsx)("div",{className:"whitespace-pre-line",children:n.address||"Address not specified"}),(0,f.jsxs)("div",{children:["GSTIN: ",n.gstin||"Not provided"]})]}),(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"font-bold",children:"Contact:"})," ",n.contactPerson||"Not specified"]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"font-bold",children:"Phone:"})," ",n.phone||"Not provided"]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"font-bold",children:"Email:"})," ",n.email||"Not provided"]})]})]}):(0,f.jsx)("div",{children:"Vendor details not available"})]}),(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsx)("div",{className:"section-title",children:"ITEMS / SERVICES"}),(0,f.jsxs)("table",{className:"table",children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{style:{width:"5%"},children:"Sr No."}),(0,f.jsx)("th",{style:{width:"35%"},children:"Description"}),(0,f.jsx)("th",{style:{width:"10%"},children:"Operation"}),(0,f.jsx)("th",{style:{width:"8%"},children:"HSN/SAC"}),(0,f.jsx)("th",{style:{width:"8%"},children:"Qty"}),(0,f.jsx)("th",{style:{width:"8%"},children:"Unit"}),(0,f.jsx)("th",{style:{width:"12%"},children:"Rate (\u20b9)"}),(0,f.jsx)("th",{style:{width:"14%"},children:"Amount (\u20b9)"})]})}),(0,f.jsx)("tbody",{children:t.items.map((e,t)=>{var n;return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{className:"text-center",children:t+1}),(0,f.jsxs)("td",{children:[(0,f.jsx)("div",{className:"font-medium",children:e.description}),e.specifications&&(0,f.jsx)("div",{className:"text-xs mt-1 text-gray-600",children:e.specifications})]}),(0,f.jsx)("td",{children:e.operation?(null===(n=y.find(t=>t.value===e.operation))||void 0===n?void 0:n.label)||e.operation:"-"}),(0,f.jsx)("td",{className:"text-center",children:"9988"}),(0,f.jsx)("td",{className:"text-center",children:e.quantity}),(0,f.jsx)("td",{className:"text-center",children:e.unit}),(0,f.jsx)("td",{className:"text-right",children:i(parseFloat(e.unitPrice||0))}),(0,f.jsx)("td",{className:"text-right",children:i(parseFloat(e.amount||0))})]},t)})}),(0,f.jsxs)("tfoot",{className:"table-footer",children:[(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{colSpan:"6",className:"text-right font-bold",children:"Subtotal:"}),(0,f.jsx)("td",{colSpan:"2",className:"text-right",children:i(parseFloat(t.totalAmount||0))})]}),parseFloat(t.discountAmount)>0&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{colSpan:"6",className:"text-right font-bold",children:"Discount:"}),(0,f.jsxs)("td",{colSpan:"2",className:"text-right",children:["-",i(parseFloat(t.discountAmount||0))]})]}),parseFloat(t.taxAmount)>0&&(0,f.jsxs)("tr",{children:[(0,f.jsxs)("td",{colSpan:"6",className:"text-right font-bold",children:["GST (",t.taxRate,"%):"]}),(0,f.jsx)("td",{colSpan:"2",className:"text-right",children:i(parseFloat(t.taxAmount||0))})]}),t.roundOffEnabled&&(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{colSpan:"6",className:"text-right font-bold",children:"Round Off:"}),(0,f.jsx)("td",{colSpan:"2",className:"text-right",children:i(parseFloat(t.roundOffValue||0))})]}),(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{colSpan:"6",className:"text-right font-bold",children:"TOTAL (\u20b9):"}),(0,f.jsx)("td",{colSpan:"2",className:"text-right font-bold",children:i(parseFloat(t.finalAmount||0))})]})]})]})]}),(0,f.jsxs)("div",{className:"amount-in-words",children:[(0,f.jsx)("span",{className:"font-bold",children:"Amount in Words: "}),s," Only"]}),(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsx)("div",{className:"section-title",children:"TERMS AND CONDITIONS"}),(0,f.jsx)("div",{className:"terms-box",children:(0,f.jsxs)("ol",{className:"list-decimal pl-5 space-y-1",children:[(0,f.jsx)("li",{children:"All materials must conform to the specifications and drawings provided."}),(0,f.jsx)("li",{children:"Goods must be delivered by the specified date. Delays may result in penalties."}),(0,f.jsx)("li",{children:"All goods must be properly packed to prevent damage during transit."}),(0,f.jsx)("li",{children:"Invoice must quote our Purchase Order number and date."}),(0,f.jsxs)("li",{children:["Payment will be made within ",t.paymentTerms," days of receipt of satisfactory goods/services and proper invoice."]}),(0,f.jsx)("li",{children:"Goods found defective during inspection will be rejected and returned at vendor's cost."}),(0,f.jsx)("li",{children:"The vendor must ensure all statutory compliances including GST are properly followed."}),(0,f.jsx)("li",{children:"This order is subject to the jurisdiction of courts in Mumbai."}),t.terms&&(0,f.jsx)("li",{children:t.terms})]})})]}),t.description&&(0,f.jsxs)("div",{className:"mb-6",children:[(0,f.jsx)("div",{className:"section-title",children:"SPECIAL INSTRUCTIONS / WORK DESCRIPTION"}),(0,f.jsx)("div",{className:"p-3 border border-gray-300",children:t.description})]}),(0,f.jsx)("div",{className:"signature-area",children:(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"font-bold mb-2",children:"For INDUSTRIAL MACHINING SOLUTIONS"}),(0,f.jsx)("div",{className:"h-16 border-b border-gray-400"}),(0,f.jsx)("div",{className:"text-sm mt-1",children:"Authorized Signatory"}),(0,f.jsx)("div",{className:"text-sm",children:"Name: _________________________"}),(0,f.jsx)("div",{className:"text-sm",children:"Designation: ____________________"})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"font-bold mb-2",children:"VENDOR ACCEPTANCE"}),(0,f.jsx)("div",{className:"h-16 border-b border-gray-400"}),(0,f.jsx)("div",{className:"text-sm mt-1",children:"Authorized Signatory"}),(0,f.jsx)("div",{className:"text-sm",children:"Name: _________________________"}),(0,f.jsx)("div",{className:"text-sm",children:"Designation: ____________________"}),(0,f.jsx)("div",{className:"text-sm",children:"Date: __________________________"}),(0,f.jsx)("div",{className:"text-sm",children:"Company Seal"})]})]})}),(0,f.jsxs)("div",{className:"footer",children:[(0,f.jsx)("div",{children:"This is a computer generated document and does not require a physical signature"}),(0,f.jsx)("div",{children:"Page 1 of 1"})]})]})]})})}},9295:(e,t,n)=>{n.d(t,{Ds:()=>x,E4:()=>h,U3:()=>c,_r:()=>g,fk:()=>p,uG:()=>l,u_:()=>m,wE:()=>u});var r=n(5472),i=n(8147),a=n(791);const s="items";function o(e){var t,n,r,i,a,s,o,d,l,c,u,p,m,h,x,g;const b=e=>""===e||null===e||void 0===e?null:Number(e);return{name:String(e.name||"").trim(),type:"service"===e.type?"service":"product",hsn:String(e.hsn||"").trim(),code:String(e.code||"").trim(),unit:String(e.unit||"").trim(),category:String(e.category||"").trim(),imageUrl:String(e.imageUrl||"").trim(),pricing:{salePrice:null!==(t=b(null===(n=e.pricing)||void 0===n?void 0:n.salePrice))&&void 0!==t?t:0,purchasePrice:null!==(r=b(null===(i=e.pricing)||void 0===i?void 0:i.purchasePrice))&&void 0!==r?r:0,discountType:["percentage","flat"].includes(null===(a=e.pricing)||void 0===a?void 0:a.discountType)?e.pricing.discountType:"percentage",discountValue:null!==(s=b(null===(o=e.pricing)||void 0===o?void 0:o.discountValue))&&void 0!==s?s:0,taxRate:null!==(d=b(null===(l=e.pricing)||void 0===l?void 0:l.taxRate))&&void 0!==d?d:0,taxMode:["with_tax","without_tax"].includes(null===(c=e.pricing)||void 0===c?void 0:c.taxMode)?e.pricing.taxMode:"without_tax"},stock:{track:Boolean(null===(u=e.stock)||void 0===u?void 0:u.track),openingQty:null!==(p=b(null===(m=e.stock)||void 0===m?void 0:m.openingQty))&&void 0!==p?p:0,minQty:null!==(h=b(null===(x=e.stock)||void 0===x?void 0:x.minQty))&&void 0!==h?h:0,location:String((null===(g=e.stock)||void 0===g?void 0:g.location)||"").trim()},status:"inactive"===e.status?"inactive":"active",notes:String(e.notes||"").trim()}}function d(e){var t,n,r,i,a,s,o,d,l,c,u,p,m,h,x,g;const b=e.data()||{};return{id:e.id,name:b.name||"",type:b.type||"product",hsn:b.hsn||"",code:b.code||"",unit:b.unit||"",category:b.category||"",imageUrl:b.imageUrl||"",pricing:{salePrice:"number"===typeof(null===(t=b.pricing)||void 0===t?void 0:t.salePrice)?b.pricing.salePrice:Number((null===(n=b.pricing)||void 0===n?void 0:n.salePrice)||0),purchasePrice:"number"===typeof(null===(r=b.pricing)||void 0===r?void 0:r.purchasePrice)?b.pricing.purchasePrice:Number((null===(i=b.pricing)||void 0===i?void 0:i.purchasePrice)||0),discountType:(null===(a=b.pricing)||void 0===a?void 0:a.discountType)||"percentage",discountValue:"number"===typeof(null===(s=b.pricing)||void 0===s?void 0:s.discountValue)?b.pricing.discountValue:Number((null===(o=b.pricing)||void 0===o?void 0:o.discountValue)||0),taxRate:"number"===typeof(null===(d=b.pricing)||void 0===d?void 0:d.taxRate)?b.pricing.taxRate:Number((null===(l=b.pricing)||void 0===l?void 0:l.taxRate)||0),taxMode:(null===(c=b.pricing)||void 0===c?void 0:c.taxMode)||"without_tax"},stock:{track:Boolean(null===(u=b.stock)||void 0===u?void 0:u.track),openingQty:"number"===typeof(null===(p=b.stock)||void 0===p?void 0:p.openingQty)?b.stock.openingQty:Number((null===(m=b.stock)||void 0===m?void 0:m.openingQty)||0),minQty:"number"===typeof(null===(h=b.stock)||void 0===h?void 0:h.minQty)?b.stock.minQty:Number((null===(x=b.stock)||void 0===x?void 0:x.minQty)||0),location:(null===(g=b.stock)||void 0===g?void 0:g.location)||""},status:b.status||"active",notes:b.notes||"",createdAt:b.createdAt,updatedAt:b.updatedAt}}function l(e){const t={};return(!e.name||String(e.name).trim().length<2)&&(t.name="Item name is required"),e.unit||(t.unit="Unit is required"),e.pricing&&e.pricing.salePrice<0&&(t.salePrice="Sale price must be >= 0"),e.pricing&&e.pricing.purchasePrice<0&&(t.purchasePrice="Purchase price must be >= 0"),e.pricing&&e.pricing.taxRate<0&&(t.taxRate="Tax rate must be >= 0"),t}async function c(e,t){const n=`items/${t||"tmp"}_${Date.now()}_${e.name}`,r=(0,i.KR)(a.I,n),s=await(0,i.D)(r,e);return(0,i.qk)(s.ref)}async function u(e){const t=l(e);if(Object.keys(t).length){const e=new Error("ITEM_VALIDATION_FAILED");throw e.details=t,e}const n=o(e),i=(0,r.O5)();return{id:(await(0,r.gS)((0,r.rJ)(a.db,s),{...n,createdAt:i,updatedAt:i})).id,...n}}async function p(e,t){const n=l(t);if(Object.keys(n).length){const e=new Error("ITEM_VALIDATION_FAILED");throw e.details=n,e}const i=o(t);await(0,r.mZ)((0,r.H9)(a.db,s,e),{...i,updatedAt:(0,r.O5)()})}async function m(e){const t=await(0,r.x7)((0,r.H9)(a.db,s,e));return t.exists()?d(t):null}async function h(){const e=(0,r.P)((0,r.rJ)(a.db,s),(0,r.My)("createdAt","desc"));return(await(0,r.GG)(e)).docs.map(d)}async function x(e){let{text:t,type:n,category:i,status:o}=e;let l=(await(0,r.GG)((0,r.rJ)(a.db,s))).docs.map(d);if(t){const e=t.toLowerCase();l=l.filter(t=>(t.name||"").toLowerCase().includes(e)||(t.code||"").toLowerCase().includes(e)||(t.hsn||"").toLowerCase().includes(e))}return n&&(l=l.filter(e=>e.type===n)),i&&(l=l.filter(e=>e.category===i)),o&&(l=l.filter(e=>e.status===o)),l}async function g(e){const t=(0,r.wP)(a.db);e.forEach(e=>t.delete((0,r.H9)(a.db,s,e))),await t.commit()}},9369:(e,t,n)=>{n.d(t,{B8:()=>o,G8:()=>u,KN:()=>c,Oh:()=>h,Zz:()=>m,uM:()=>x,vb:()=>p});var r=n(5472),i=n(791);const a="purchaseOrders",s="poActivity";function o(e){var t;const n=Array.isArray(e.items)?e.items:[],r=Array.isArray(e.operations)?e.operations.filter(Boolean):e.operation?[String(e.operation)]:[],i=n.map(e=>{var t,n;const r=Number(e.quantity)||0,i=Number(null!==(t=e.unitPrice)&&void 0!==t?t:e.rate)||0;return{description:String(e.description||"").trim(),quantity:r,unitPrice:i,amount:Number(null!==(n=e.amount)&&void 0!==n?n:r*i).toFixed?Number((r*i).toFixed(2)):r*i,unit:String(e.unit||"pcs"),specifications:String(e.specifications||""),deliveryDate:e.deliveryDate||"",itemId:e.itemId||null,operation:e.operation||null}}),a=i.reduce((e,t)=>e+(Number(t.amount)||0),0),s=Number(e.discountAmount||0),o=a-s,d=Number(e.taxRate||0),l=o*d/100;let c=o+l;const u=Boolean(e.roundOffEnabled);let p=Number(e.roundOffValue||0);if(u){const e=Math.round(c);p=Number((e-c).toFixed(2)),c=e}const m=r.reduce((t,n)=>(t[String(n)]=e.operationsStatus&&e.operationsStatus[n]||"pending",t),{}),h=r.reduce((t,n)=>{const r=e.operationsMeta&&e.operationsMeta[n]||{};return t[String(n)]={status:m[String(n)]||"pending",notes:r.notes||"",updatedAt:r.updatedAt||null,updatedBy:r.updatedBy||null,startedAt:r.startedAt||null,completedAt:r.completedAt||null},t},{});return{vendorId:String(e.vendorId||"").trim(),operation:r[0]?String(r[0]).trim():"",operations:r,operationsStatus:m,operationsMeta:h,description:String(e.description||""),deliveryDate:e.deliveryDate?e.deliveryDate instanceof Date?e.deliveryDate:new Date(e.deliveryDate):null,priority:e.priority||"medium",status:e.status||"pending",paymentTerms:String(null!==(t=e.paymentTerms)&&void 0!==t?t:"30"),shippingAddress:String(e.shippingAddress||""),billingAddress:String(e.billingAddress||""),currency:e.currency||"INR",invoiceDate:e.invoiceDate||null,dueDate:e.dueDate||null,stateOfSupply:String(e.stateOfSupply||""),taxRate:d,discountAmount:s,items:i,totalAmount:Number(a.toFixed(2)),taxAmount:Number(l.toFixed(2)),finalAmount:Number(c.toFixed(2)),roundOffEnabled:u,roundOffValue:p,specifications:String(e.specifications||""),qualityRequirements:String(e.qualityRequirements||""),expectedDeliveryDays:Number(e.expectedDeliveryDays||0)||0,warrantPeriod:String(e.warrantPeriod||""),terms:String(e.terms||""),poNumber:e.poNumber||null}}function d(e){const t=e.data()||{};return{id:e.id,...t}}async function l(e,t,n){try{await(0,r.gS)((0,r.rJ)(i.db,s),{poId:e,action:t,details:n||{},timestamp:(0,r.O5)()})}catch(a){}}async function c(e){const t=await(0,r.x7)((0,r.H9)(i.db,a,e));return t.exists()?d(t):null}async function u(e){const t=o(e),n=(0,r.O5)(),s=await(0,r.gS)((0,r.rJ)(i.db,a),{...t,createdAt:n,updatedAt:n});return await l(s.id,"create",{vendorId:t.vendorId,amount:t.finalAmount}),{id:s.id,...t}}async function p(e,t){const n=o(t);await(0,r.mZ)((0,r.H9)(i.db,a,e),{...n,updatedAt:(0,r.O5)()}),await l(e,"update",{status:n.status})}async function m(e){await(0,r.kd)((0,r.H9)(i.db,a,e)),await l(e,"delete")}async function h(e,t){const n=(0,r.wP)(i.db);e.forEach(e=>n.update((0,r.H9)(i.db,a,e),{...t,updatedAt:(0,r.O5)()})),await n.commit();for(const r of e)l(r,"bulk_update",{fields:t})}async function x(e){const t=(0,r.wP)(i.db);e.forEach(e=>t.delete((0,r.H9)(i.db,a,e))),await t.commit();for(const n of e)l(n,"bulk_delete")}}}]);
//# sourceMappingURL=434.86b587b5.chunk.js.map