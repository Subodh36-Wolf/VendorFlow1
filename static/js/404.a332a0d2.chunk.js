"use strict";(self.webpackChunkvendor_management_system=self.webpackChunkvendor_management_system||[]).push([[404],{1404:(e,i,t)=>{t.r(i),t.d(i,{default:()=>d});var r=t(5043),a=t(3216),n=t(5475),s=t(5772),o=t(9295),l=t(3505),c=t(579);function d(){const{id:e}=(0,a.g)(),i=Boolean(e)&&"new"!==e,t=(0,a.Zp)(),{showError:d,showSuccess:u}=(0,l.hN)(),[m,g]=(0,r.useState)(!1),[x,p]=(0,r.useState)({}),[h,b]=(0,r.useState)({name:"",type:"product",hsn:"",code:"",unit:"",category:"",imageUrl:"",pricing:{salePrice:"",purchasePrice:"",discountType:"percentage",discountValue:"",taxRate:"",taxMode:"without_tax"},stock:{track:!1,openingQty:"",minQty:"",location:""},status:"active",notes:""});(0,r.useEffect)(()=>{i&&y()},[e]);const y=async()=>{try{g(!0);const i=await(0,o.u_)(e);i&&b({...i})}catch(i){d("Failed to load item")}finally{g(!1)}},v=e=>{const{name:i,value:t,type:r,checked:a}=e.target;b(e=>({...e,[i]:"checkbox"===r?a:t}))},f=e=>{const{name:i,value:t}=e.target;b(e=>({...e,pricing:{...e.pricing,[i]:t}}))},j=e=>{const{name:i,value:t,type:r,checked:a}=e.target;b(e=>({...e,stock:{...e.stock,[i]:"checkbox"===r?a:t}}))},N=async r=>{r.preventDefault();const a=(0,o.uG)(h);if(p(a),Object.keys(a).length)d("Please fix the highlighted fields");else try{g(!0),i?(await(0,o.fk)(e,h),u("Item updated")):(await(0,o.wE)(h),u("Item created")),t("/admin/items")}catch(n){d("Save failed")}finally{g(!1)}};return(0,c.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[(0,c.jsx)("div",{className:"sticky top-0 z-20 bg-white/90 backdrop-blur border-b border-gray-200",children:(0,c.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between",children:[(0,c.jsxs)(n.N_,{to:"/admin/items",className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,c.jsx)(s.kRp,{className:"mr-2"})," Back"]}),(0,c.jsxs)("button",{onClick:N,disabled:m,className:"inline-flex items-center px-4 py-2 rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60","aria-label":"Save item",children:[(0,c.jsx)(s.Bc_,{className:"mr-2"})," ",m?"Saving...":"Save"]})]})}),(0,c.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,c.jsxs)("form",{onSubmit:N,className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,c.jsxs)("div",{className:"bg-white rounded-2xl shadow border border-gray-100 lg:col-span-2 overflow-hidden",children:[(0,c.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 px-4 sm:px-6 py-3 border-b border-gray-100",children:(0,c.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Basic Information"})}),(0,c.jsxs)("div",{className:"p-4 sm:p-6 space-y-4",children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Item Name *"}),(0,c.jsx)("input",{name:"name",value:h.name,onChange:v,className:"mt-1 w-full border rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 "+(x.name?"border-red-500":"border-gray-300"),placeholder:"Enter item name"}),x.name&&(0,c.jsx)("p",{className:"mt-1 text-xs text-red-600",children:x.name})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),(0,c.jsxs)("select",{name:"type",value:h.type,onChange:v,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",children:[(0,c.jsx)("option",{value:"product",children:"Product"}),(0,c.jsx)("option",{value:"service",children:"Service"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"HSN"}),(0,c.jsx)("input",{name:"hsn",value:h.hsn,onChange:v,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"Enter HSN code"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Item Code"}),(0,c.jsx)("input",{name:"code",value:h.code,onChange:v,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"Unique item code"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Unit *"}),(0,c.jsx)("input",{name:"unit",value:h.unit,onChange:v,className:"mt-1 w-full border rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 "+(x.unit?"border-red-500":"border-gray-300"),placeholder:"e.g., Nos, Kg, Meter"}),x.unit&&(0,c.jsx)("p",{className:"mt-1 text-xs text-red-600",children:x.unit})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),(0,c.jsx)("input",{name:"category",value:h.category,onChange:v,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"Category name"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),(0,c.jsx)("textarea",{name:"notes",value:h.notes,onChange:v,rows:3,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"Additional details about this item"})]})]})]}),(0,c.jsxs)("div",{className:"bg-white rounded-2xl shadow border border-gray-100 overflow-hidden",children:[(0,c.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 px-4 sm:px-6 py-3 border-b border-gray-100",children:(0,c.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Media & Status"})}),(0,c.jsxs)("div",{className:"p-4 sm:p-6 space-y-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Item Image"}),(0,c.jsxs)("div",{className:"mt-2 flex items-center space-x-3",children:[h.imageUrl&&(0,c.jsx)("img",{src:h.imageUrl,alt:"preview",className:"h-16 w-16 object-cover rounded"}),(0,c.jsxs)("label",{className:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,c.jsx)(s.B88,{className:"mr-2"})," Upload",(0,c.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:async i=>{var t;const r=null===(t=i.target.files)||void 0===t?void 0:t[0];if(r)try{g(!0);const i=await(0,o.U3)(r,e||h.code||h.name);b(e=>({...e,imageUrl:i})),u("Image uploaded")}catch(a){d("Image upload failed")}finally{g(!1)}}})]})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,c.jsxs)("select",{name:"status",value:h.status,onChange:v,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",children:[(0,c.jsx)("option",{value:"active",children:"Active"}),(0,c.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]})]}),(0,c.jsxs)("div",{className:"bg-white rounded-2xl shadow border border-gray-100 lg:col-span-3 overflow-hidden",children:[(0,c.jsx)("div",{className:"bg-gradient-to-r from-emerald-50 to-green-50 px-4 sm:px-6 py-3 border-b border-gray-100",children:(0,c.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Pricing"})}),(0,c.jsx)("div",{className:"p-4 sm:p-6",children:(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Sale Price"}),(0,c.jsx)("input",{name:"salePrice",type:"number",step:"0.01",value:h.pricing.salePrice,onChange:f,className:"mt-1 w-full border rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 "+(x.salePrice?"border-red-500":"border-gray-300"),placeholder:"0.00"}),x.salePrice&&(0,c.jsx)("p",{className:"mt-1 text-xs text-red-600",children:x.salePrice})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Purchase Price"}),(0,c.jsx)("input",{name:"purchasePrice",type:"number",step:"0.01",value:h.pricing.purchasePrice,onChange:f,className:"mt-1 w-full border rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 "+(x.purchasePrice?"border-red-500":"border-gray-300"),placeholder:"0.00"}),x.purchasePrice&&(0,c.jsx)("p",{className:"mt-1 text-xs text-red-600",children:x.purchasePrice})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Tax Rate (%)"}),(0,c.jsx)("input",{name:"taxRate",type:"number",step:"0.01",value:h.pricing.taxRate,onChange:f,className:"mt-1 w-full border rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500 "+(x.taxRate?"border-red-500":"border-gray-300"),placeholder:"0"}),x.taxRate&&(0,c.jsx)("p",{className:"mt-1 text-xs text-red-600",children:x.taxRate})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Tax Mode"}),(0,c.jsxs)("select",{name:"taxMode",value:h.pricing.taxMode,onChange:f,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",children:[(0,c.jsx)("option",{value:"without_tax",children:"Without Tax"}),(0,c.jsx)("option",{value:"with_tax",children:"With Tax"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Discount Type"}),(0,c.jsxs)("select",{name:"discountType",value:h.pricing.discountType,onChange:f,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",children:[(0,c.jsx)("option",{value:"percentage",children:"Percentage"}),(0,c.jsx)("option",{value:"flat",children:"Flat"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Discount Value"}),(0,c.jsx)("input",{name:"discountValue",type:"number",step:"0.01",value:h.pricing.discountValue,onChange:f,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"0.00"})]})]})})]}),(0,c.jsxs)("div",{className:"bg-white rounded-2xl shadow border border-gray-100 lg:col-span-3 overflow-hidden",children:[(0,c.jsx)("div",{className:"bg-gradient-to-r from-amber-50 to-yellow-50 px-4 sm:px-6 py-3 border-b border-gray-100",children:(0,c.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Stock"})}),(0,c.jsx)("div",{className:"p-4 sm:p-6",children:(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[(0,c.jsxs)("label",{className:"md:col-span-1 inline-flex items-center space-x-2",children:[(0,c.jsx)("input",{type:"checkbox",name:"track",checked:h.stock.track,onChange:j,className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),(0,c.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Track Stock"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Opening Qty"}),(0,c.jsx)("input",{name:"openingQty",type:"number",step:"0.01",value:h.stock.openingQty,onChange:j,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"0"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Minimum Qty"}),(0,c.jsx)("input",{name:"minQty",type:"number",step:"0.01",value:h.stock.minQty,onChange:j,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"0"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),(0,c.jsx)("input",{name:"location",value:h.stock.location,onChange:j,className:"mt-1 w-full border border-gray-300 rounded-xl px-3 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"Rack / Bin"})]})]})})]})]})}),(0,c.jsx)("div",{className:"fixed bottom-0 inset-x-0 md:hidden z-20 p-3",children:(0,c.jsxs)("div",{className:"bg-white border border-gray-200 shadow-lg rounded-xl p-2 flex items-center justify-between",children:[(0,c.jsx)(n.N_,{to:"/admin/items",className:"px-4 py-2 border border-gray-300 rounded-lg",children:"Back"}),(0,c.jsx)("button",{onClick:N,disabled:m,className:"px-5 py-2 bg-indigo-600 text-white rounded-lg disabled:opacity-60",children:m?"Saving...":"Save"})]})})]})}},9295:(e,i,t)=>{t.d(i,{Ds:()=>p,E4:()=>x,U3:()=>d,_r:()=>h,fk:()=>m,uG:()=>c,u_:()=>g,wE:()=>u});var r=t(5472),a=t(8147),n=t(791);const s="items";function o(e){var i,t,r,a,n,s,o,l,c,d,u,m,g,x,p,h;const b=e=>""===e||null===e||void 0===e?null:Number(e);return{name:String(e.name||"").trim(),type:"service"===e.type?"service":"product",hsn:String(e.hsn||"").trim(),code:String(e.code||"").trim(),unit:String(e.unit||"").trim(),category:String(e.category||"").trim(),imageUrl:String(e.imageUrl||"").trim(),pricing:{salePrice:null!==(i=b(null===(t=e.pricing)||void 0===t?void 0:t.salePrice))&&void 0!==i?i:0,purchasePrice:null!==(r=b(null===(a=e.pricing)||void 0===a?void 0:a.purchasePrice))&&void 0!==r?r:0,discountType:["percentage","flat"].includes(null===(n=e.pricing)||void 0===n?void 0:n.discountType)?e.pricing.discountType:"percentage",discountValue:null!==(s=b(null===(o=e.pricing)||void 0===o?void 0:o.discountValue))&&void 0!==s?s:0,taxRate:null!==(l=b(null===(c=e.pricing)||void 0===c?void 0:c.taxRate))&&void 0!==l?l:0,taxMode:["with_tax","without_tax"].includes(null===(d=e.pricing)||void 0===d?void 0:d.taxMode)?e.pricing.taxMode:"without_tax"},stock:{track:Boolean(null===(u=e.stock)||void 0===u?void 0:u.track),openingQty:null!==(m=b(null===(g=e.stock)||void 0===g?void 0:g.openingQty))&&void 0!==m?m:0,minQty:null!==(x=b(null===(p=e.stock)||void 0===p?void 0:p.minQty))&&void 0!==x?x:0,location:String((null===(h=e.stock)||void 0===h?void 0:h.location)||"").trim()},status:"inactive"===e.status?"inactive":"active",notes:String(e.notes||"").trim()}}function l(e){var i,t,r,a,n,s,o,l,c,d,u,m,g,x,p,h;const b=e.data()||{};return{id:e.id,name:b.name||"",type:b.type||"product",hsn:b.hsn||"",code:b.code||"",unit:b.unit||"",category:b.category||"",imageUrl:b.imageUrl||"",pricing:{salePrice:"number"===typeof(null===(i=b.pricing)||void 0===i?void 0:i.salePrice)?b.pricing.salePrice:Number((null===(t=b.pricing)||void 0===t?void 0:t.salePrice)||0),purchasePrice:"number"===typeof(null===(r=b.pricing)||void 0===r?void 0:r.purchasePrice)?b.pricing.purchasePrice:Number((null===(a=b.pricing)||void 0===a?void 0:a.purchasePrice)||0),discountType:(null===(n=b.pricing)||void 0===n?void 0:n.discountType)||"percentage",discountValue:"number"===typeof(null===(s=b.pricing)||void 0===s?void 0:s.discountValue)?b.pricing.discountValue:Number((null===(o=b.pricing)||void 0===o?void 0:o.discountValue)||0),taxRate:"number"===typeof(null===(l=b.pricing)||void 0===l?void 0:l.taxRate)?b.pricing.taxRate:Number((null===(c=b.pricing)||void 0===c?void 0:c.taxRate)||0),taxMode:(null===(d=b.pricing)||void 0===d?void 0:d.taxMode)||"without_tax"},stock:{track:Boolean(null===(u=b.stock)||void 0===u?void 0:u.track),openingQty:"number"===typeof(null===(m=b.stock)||void 0===m?void 0:m.openingQty)?b.stock.openingQty:Number((null===(g=b.stock)||void 0===g?void 0:g.openingQty)||0),minQty:"number"===typeof(null===(x=b.stock)||void 0===x?void 0:x.minQty)?b.stock.minQty:Number((null===(p=b.stock)||void 0===p?void 0:p.minQty)||0),location:(null===(h=b.stock)||void 0===h?void 0:h.location)||""},status:b.status||"active",notes:b.notes||"",createdAt:b.createdAt,updatedAt:b.updatedAt}}function c(e){const i={};return(!e.name||String(e.name).trim().length<2)&&(i.name="Item name is required"),e.unit||(i.unit="Unit is required"),e.pricing&&e.pricing.salePrice<0&&(i.salePrice="Sale price must be >= 0"),e.pricing&&e.pricing.purchasePrice<0&&(i.purchasePrice="Purchase price must be >= 0"),e.pricing&&e.pricing.taxRate<0&&(i.taxRate="Tax rate must be >= 0"),i}async function d(e,i){const t=`items/${i||"tmp"}_${Date.now()}_${e.name}`,r=(0,a.KR)(n.I,t),s=await(0,a.D)(r,e);return(0,a.qk)(s.ref)}async function u(e){const i=c(e);if(Object.keys(i).length){const e=new Error("ITEM_VALIDATION_FAILED");throw e.details=i,e}const t=o(e),a=(0,r.O5)();return{id:(await(0,r.gS)((0,r.rJ)(n.db,s),{...t,createdAt:a,updatedAt:a})).id,...t}}async function m(e,i){const t=c(i);if(Object.keys(t).length){const e=new Error("ITEM_VALIDATION_FAILED");throw e.details=t,e}const a=o(i);await(0,r.mZ)((0,r.H9)(n.db,s,e),{...a,updatedAt:(0,r.O5)()})}async function g(e){const i=await(0,r.x7)((0,r.H9)(n.db,s,e));return i.exists()?l(i):null}async function x(){const e=(0,r.P)((0,r.rJ)(n.db,s),(0,r.My)("createdAt","desc"));return(await(0,r.GG)(e)).docs.map(l)}async function p(e){let{text:i,type:t,category:a,status:o}=e;let c=(await(0,r.GG)((0,r.rJ)(n.db,s))).docs.map(l);if(i){const e=i.toLowerCase();c=c.filter(i=>(i.name||"").toLowerCase().includes(e)||(i.code||"").toLowerCase().includes(e)||(i.hsn||"").toLowerCase().includes(e))}return t&&(c=c.filter(e=>e.type===t)),a&&(c=c.filter(e=>e.category===a)),o&&(c=c.filter(e=>e.status===o)),c}async function h(e){const i=(0,r.wP)(n.db);e.forEach(e=>i.delete((0,r.H9)(n.db,s,e))),await i.commit()}}}]);
//# sourceMappingURL=404.a332a0d2.chunk.js.map