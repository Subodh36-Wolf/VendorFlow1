"use strict";(self.webpackChunkvendor_management_system=self.webpackChunkvendor_management_system||[]).push([[196],{7196:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var a=s(5043),r=s(5472),n=s(791),l=s(3505),i=s(8729),d=s(5772),o=s(579);const c={HBL:{name:"Horizontal Boring",icon:d.i5c,color:"blue"},VTL:{name:"Vertical Turning",icon:d.Ojn,color:"purple"},Drilling:{name:"Drilling",icon:d.FrA,color:"green"},VMC:{name:"Vertical Machining",icon:d.x_j,color:"indigo"}},m=async function(e,t,s,a,l){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";try{var d,o,m;const N=(0,r.H9)(n.db,"purchaseOrders",e),w=await(0,r.x7)(N);if(!w.exists())throw new Error("Purchase order not found");const S=w.data()||{},O=S.operationsStatus||{},k=O[s]||{},$=k[t]||"pending",C={...k,[t]:a},I={...O,[s]:C},A=S.items||[];let _=0,D=0;A.forEach((e,t)=>{const s=I[t]||{};Object.keys(s).forEach(e=>{_++,"completed"===s[e]&&D++})});const P=_>0?Math.round(D/_*100):0;let E=S.status||"pending";_>0&&D===_?E="completed":(D>0||Object.values(I).some(e=>Object.values(e).some(e=>"in_progress"===e)))&&(E="in_progress");const M=(0,r.wP)(n.db),T={status:a,notes:i||"",updatedAt:(0,r.O5)(),updatedBy:{uid:(null===l||void 0===l?void 0:l.uid)||null,email:(null===l||void 0===l?void 0:l.email)||null,name:(null===l||void 0===l?void 0:l.displayName)||null},itemIndex:s,itemDescription:(null===(d=A[s])||void 0===d?void 0:d.description)||`Item ${s+1}`},z={};"in_progress"===a&&(z.startedAt=(0,r.O5)()),"completed"===a&&(z.completedAt=(0,r.O5)());const V=`${s}_${t}`;M.update(N,{operationsStatus:I,[`operationsMeta.${V}`]:{...(null===(o=S.operationsMeta)||void 0===o?void 0:o[V])||{},...T,...z},status:E,progress:P,updatedAt:(0,r.O5)()});try{var x;const l=S.vendorId||null,d=S.vendorName||S.vendor||"",o=S.poNumber||e,m=(null===(x=A[s])||void 0===x?void 0:x.description)||`Item ${s+1}`;let b="",N="medium",w="pending";var p;if("in_progress"===a)b=`Start ${(null===(p=c[t])||void 0===p?void 0:p.name)||t} for ${m} (PO ${o})`,N="high",w="in-progress";else if("completed"===a){var u;b=`Verify completion: ${(null===(u=c[t])||void 0===u?void 0:u.name)||t} for ${m} (PO ${o})`,N="medium",w="completed"}else if("pending"===a){var g;b=`Plan ${(null===(g=c[t])||void 0===g?void 0:g.name)||t} for ${m} (PO ${o})`,N="low",w="pending"}if(b){var h,v;const x=`${e}_${V}_${a}_${(new Date).toISOString().slice(0,10)}`,p=(0,r.H9)(n.db,"industrialTasks",x);M.set(p,{title:b,description:i||`Vendor: ${d||"N/A"} | Item: ${m} | Operation: ${(null===(h=c[t])||void 0===h?void 0:h.name)||t}`,priority:N,assignedTo:d||"",dueDate:(0,r.O5)(),category:"production",completed:"completed"===w,status:w,progress:"completed"===w?100:0,department:"manufacturing",equipment:"",estimatedTime:0,safetyNotes:"",sequence:[{step:`${(null===(v=c[t])||void 0===v?void 0:v.name)||t}`,completed:"completed"===w}],createdAt:(0,r.O5)(),updatedAt:(0,r.O5)(),vendorId:l,vendorName:d||null,poId:e,poNumber:o,operation:t,itemIndex:s,itemDescription:m,newStatus:a,source:"statusManager",autoGenerated:!0})}if("completed"===a){var j,y,f;const a=(new Date).toISOString().slice(0,10),x=`todo_${e}_${V}_collect_${a}`,p=(0,r.H9)(n.db,"vendorTodos",x),u=(t||"").toString().toLowerCase(),g=["hbl","vtl","drilling","vmc","grinding","assembly","painting","packing","other"].includes(u)?u:"other",h=(null===(j=A[s])||void 0===j?void 0:j.quantity)&&Number(null===(y=A[s])||void 0===y?void 0:y.quantity)||1;M.set(p,{date:a,vendors:l?[{vendorId:l,bodiesCount:h}]:[],totalBodies:h,operationType:g,targetLocation:"VMT Store",notes:i||`Collect material for ${(null===(f=c[t])||void 0===f?void 0:f.name)||t} - ${m} (PO ${o})`,status:"pending",priority:"high",createdAt:(0,r.O5)(),updatedAt:(0,r.O5)(),vendorId:l||null,vendorName:d||null,poId:e,poNumber:o,operation:t,itemIndex:s,itemDescription:m,source:"statusManager",autoGenerated:!0},{merge:!0})}}catch(b){console.warn("Todo auto-create skipped/failed:",(null===b||void 0===b?void 0:b.message)||b)}try{(await(0,r.GG)((0,r.P)((0,r.rJ)(n.db,"deliveryChallans"),(0,r._M)("poId","==",e)))).forEach(e=>{M.update((0,r.H9)(n.db,"deliveryChallans",e.id),{poStatus:E,poProgress:P,updatedAt:(0,r.O5)()})})}catch(b){console.warn("DC propagation skipped/failed:",(null===b||void 0===b?void 0:b.message)||b)}const G=e=>{switch(e){case"completed":return"completed";case"in_progress":return"in-progress";default:return"assigned"}};try{const t=[];(await(0,r.GG)((0,r.P)((0,r.rJ)(n.db,"jobAssignments"),(0,r._M)("poId","==",e)))).forEach(e=>t.push(e.id));const s=S.poNumber;if(0===t.length&&s){(await(0,r.GG)((0,r.P)((0,r.rJ)(n.db,"jobAssignments"),(0,r._M)("reference","==",s)))).forEach(e=>t.push(e.id))}const a=G(E);t.forEach(e=>{M.update((0,r.H9)(n.db,"jobAssignments",e),{status:a,updatedAt:(0,r.O5)()})})}catch(b){console.warn("Job propagation skipped/failed:",(null===b||void 0===b?void 0:b.message)||b)}const U=(0,r.H9)((0,r.rJ)(n.db,"operationHistory"));return M.set(U,{itemId:e,itemType:"po_operation",operation:t,itemIndex:s,itemDescription:(null===(m=A[s])||void 0===m?void 0:m.description)||`Item ${s+1}`,oldStatus:$,newStatus:a,notes:i||"",userId:(null===l||void 0===l?void 0:l.uid)||null,userName:(null===l||void 0===l?void 0:l.displayName)||(null===l||void 0===l?void 0:l.email)||"Unknown",timestamp:(0,r.O5)()}),await M.commit(),!0}catch(N){throw console.error("Error in operation status service:",N),N}},x=e=>{var t;let{item:s,history:a,onClose:r,getStatusColor:n,getStatusIcon:l,getVendorName:i}=e;return(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,o.jsxs)("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[(0,o.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["Operation History - ",s.poNumber]}),(0,o.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,o.jsx)(d.yGN,{size:24})})]}),(0,o.jsxs)("div",{className:"p-6",children:[(0,o.jsxs)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Vendor"}),(0,o.jsx)("p",{className:"text-lg font-medium",children:i(s.vendorId)})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Current Status"}),(0,o.jsxs)("p",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${n(s.status)}`,children:[l(s.status),(0,o.jsx)("span",{className:"ml-1 capitalize",children:null===(t=s.status)||void 0===t?void 0:t.replace("_"," ")})]})]})]}),(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Operation Timeline"}),a.length>0?(0,o.jsx)("div",{className:"space-y-4",children:a.map((e,t)=>{var s,r,n;return(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsxs)("div",{className:"flex flex-col items-center mr-4",children:[(0,o.jsx)("div",{className:"w-3 h-3 rounded-full "+("completed"===e.newStatus?"bg-green-500":"in_progress"===e.newStatus?"bg-blue-500":"pending"===e.newStatus?"bg-yellow-500":"bg-gray-500")}),t<a.length-1&&(0,o.jsx)("div",{className:"w-0.5 h-16 bg-gray-300 my-1"})]}),(0,o.jsxs)("div",{className:"flex-1 pb-4",children:[(0,o.jsxs)("div",{className:"flex justify-between",children:[(0,o.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(null===(s=c[e.operation])||void 0===s?void 0:s.name)||e.operation}),(0,o.jsx)("span",{className:"text-sm text-gray-500",children:(null===(r=e.timestamp)||void 0===r||null===(n=r.toDate)||void 0===n?void 0:n.call(r).toLocaleString())||"N/A"})]}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Changed from ",(0,o.jsx)("span",{className:"font-medium",children:e.oldStatus})," to ",(0,o.jsx)("span",{className:"font-medium",children:e.newStatus}),e.notes&&` - ${e.notes}`]}),(0,o.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["By: ",e.userName]})]})]},e.id||t)})}):(0,o.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No history available for this operation"})]}),(0,o.jsx)("div",{className:"p-6 border-t border-gray-200 flex justify-end",children:(0,o.jsx)("button",{onClick:r,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"Close"})})]})})},p=e=>{var t,s,r;let{isOpen:n,onClose:l,operation:i,itemIndex:m,currentStatus:x,onStatusUpdate:p,poData:u}=e;const[g,h]=(0,a.useState)(""),[v,j]=(0,a.useState)(x),[y,f]=(0,a.useState)(!1);(0,a.useEffect)(()=>{n&&(j(x),h(""))},[n,x]);if(!n)return null;const b=(null===u||void 0===u||null===(t=u.items)||void 0===t||null===(s=t[m])||void 0===s?void 0:s.description)||`Item ${m+1}`;return(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[(0,o.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Update Operation Status"}),(0,o.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[(null===(r=c[i])||void 0===r?void 0:r.name)||i," - ",b]})]}),(0,o.jsxs)("div",{className:"p-6 space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,o.jsxs)("button",{onClick:()=>j("pending"),className:"p-3 rounded-lg border text-center "+("pending"===v?"bg-yellow-100 border-yellow-500 text-yellow-700":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"),children:[(0,o.jsx)(d.Ohp,{className:"mx-auto mb-1"}),(0,o.jsx)("span",{className:"text-xs",children:"Pending"})]}),(0,o.jsxs)("button",{onClick:()=>j("in_progress"),className:"p-3 rounded-lg border text-center "+("in_progress"===v?"bg-blue-100 border-blue-500 text-blue-700":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"),children:[(0,o.jsx)(d.aze,{className:"mx-auto mb-1"}),(0,o.jsx)("span",{className:"text-xs",children:"In Progress"})]}),(0,o.jsxs)("button",{onClick:()=>j("completed"),className:"p-3 rounded-lg border text-center "+("completed"===v?"bg-green-100 border-green-500 text-green-700":"bg-gray-100 border-gray-300 text-gray-700 hover:bg-gray-200"),children:[(0,o.jsx)(d.A3x,{className:"mx-auto mb-1"}),(0,o.jsx)("span",{className:"text-xs",children:"Completed"})]})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),(0,o.jsx)("textarea",{value:g,onChange:e=>h(e.target.value),placeholder:"Add any notes about this status change...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",rows:3})]})]}),(0,o.jsxs)("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:[(0,o.jsx)("button",{onClick:l,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:y,children:"Cancel"}),(0,o.jsx)("button",{onClick:async()=>{if(v!==x){f(!0);try{await p(v,g),l()}catch(e){console.error("Error updating status:",e)}finally{f(!1)}}else l()},disabled:y||v===x,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center",children:y?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update Status"})]})]})})};function u(){const{showSuccess:e,showError:t}=(0,l.hN)(),{currentUser:s}=(0,i.A)(),[u,j]=(0,a.useState)([]),[y,f]=(0,a.useState)([]),[b,N]=(0,a.useState)([]),[w,S]=(0,a.useState)(!0),[O,k]=(0,a.useState)({}),[$,C]=(0,a.useState)("operations"),[I,A]=(0,a.useState)(null),[_,D]=(0,a.useState)(!1),[P,E]=(0,a.useState)([]),[M,T]=(0,a.useState)({status:"all",operation:"all",search:"",dateRange:"all",vendor:"all"}),[z,V]=(0,a.useState)("table"),[G,U]=(0,a.useState)([]),[L,H]=(0,a.useState)(!1),[J,F]=(0,a.useState)({key:"createdAt",direction:"desc"}),[R,q]=(0,a.useState)(!1),B=(0,a.useRef)(null),[Q,W]=(0,a.useState)([]),[X,Z]=(0,a.useState)({}),[K,Y]=(0,a.useState)({isOpen:!1,poId:null,operation:null,itemIndex:null,currentStatus:null});(0,a.useEffect)(()=>{try{const e=localStorage.getItem("statusManagerFilters");if(e){const t=JSON.parse(e);T(e=>({...e,...t}))}}catch{}se();const e=()=>{H(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e),B.current&&clearInterval(B.current)}},[]),(0,a.useEffect)(()=>(R?(B.current&&clearInterval(B.current),B.current=setInterval(se,3e4)):B.current&&(clearInterval(B.current),B.current=null),()=>{B.current&&clearInterval(B.current)}),[R]),(0,a.useEffect)(()=>{try{localStorage.setItem("statusManagerFilters",JSON.stringify(M))}catch{}},[M]),(0,a.useEffect)(()=>{if(y.length>0&&b.length>0){const e={};b.forEach(t=>{const s=y.filter(e=>e.vendorId===t.id),a=[];s.forEach(e=>{Object.entries(e.operationsStatus||{}).forEach(s=>{let[r,n]=s;Object.entries(n).forEach(s=>{let[n,l]=s;if("completed"===l){var i,d;const s=(null===(i=e.items)||void 0===i||null===(d=i[parseInt(r)])||void 0===d?void 0:d.description)||`Item ${parseInt(r)+1}`;a.push({poNumber:e.poNumber,operation:n,itemIndex:parseInt(r),itemDescription:s,completionDate:e.updatedAt||e.createdAt,vendor:t.name})}})})});let r=0;s.forEach(e=>{var t;null===(t=e.items)||void 0===t||t.forEach((e,t)=>{const s=ee(e);r+=s.length})}),e[t.id]={name:t.name,totalPOs:s.length,totalOperations:r,completedOperations:a,efficiency:r>0?a.length/r*100:0,averageCompletionTime:te(s)}}),Z(e),W(Object.values(e).flatMap(e=>e.completedOperations).sort((e,t)=>new Date(t.completionDate)-new Date(e.completionDate)))}},[y,b]);const ee=e=>{const t=[];return e.operation&&""!==e.operation&&t.push(e.operation),t},te=e=>{let t=0,s=0;return e.forEach(e=>{Object.entries(e.operationsMeta||{}).forEach(e=>{let[a,r]=e;if(r.completedAt&&r.startedAt){const e=r.startedAt.toDate?r.startedAt.toDate():new Date(r.startedAt),a=r.completedAt.toDate?r.completedAt.toDate():new Date(r.completedAt);t+=a-e,s++}})}),s>0?t/s:0},se=async()=>{try{S(!0);const[e,t,s]=await Promise.all([(0,r.GG)((0,r.rJ)(n.db,"jobAssignments")),(0,r.GG)((0,r.P)((0,r.rJ)(n.db,"purchaseOrders"),(0,r.My)("createdAt","desc"))),(0,r.GG)((0,r.rJ)(n.db,"vendors"))]),a=[];e.forEach(e=>{a.push({id:e.id,...e.data()})});const l=[];t.forEach(e=>{const t=e.data();l.push({id:e.id,...t,operationsStatus:{...t.operationsStatus||{}}})});const i=[];s.forEach(e=>{i.push({id:e.id,...e.data()})}),j(a),f(l),N(i)}catch(e){console.error("Error fetching data:",e),t("Failed to load data")}finally{S(!1)}},ae=async function(a,r,n,l){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";try{var d,o;k(e=>({...e,[`${a}_${n}_${r}`]:!0}));const t=y.find(e=>e.id===a),x=(null===t||void 0===t||null===(d=t.operationsStatus)||void 0===d||null===(o=d[n])||void 0===o?void 0:o[r])||"pending";await m(a,r,n,l,s||{},i),f(e=>e.map(e=>{var t;if(e.id!==a)return e;const s={...(null===(t=e.operationsStatus)||void 0===t?void 0:t[n])||{},[r]:l},i={...e.operationsStatus||{},[n]:s},d=e.items||[];let o=0,c=0;d.forEach((e,t)=>{const s=i[t]||{};Object.keys(s).forEach(e=>{o++,"completed"===s[e]&&c++})});const m=o>0?Math.round(c/o*100):0;let x=e.status||"pending";return o>0&&c===o?x="completed":(c>0||Object.values(i).some(e=>Object.values(e).some(e=>"in_progress"===e)))&&(x="in_progress"),{...e,operationsStatus:i,status:x,progress:m}})),e(`Updated ${c[r].name} for item ${n+1} from ${x} to ${l}`)}catch(x){console.error("Error updating operation status:",x),t("Failed to update operation status")}finally{k(e=>({...e,[`${a}_${n}_${r}`]:!1}))}},re=e=>{const t=b.find(t=>t.id===e);return t?t.name:"Unknown Vendor"},ne=e=>{switch(e){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"rejected":case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},le=e=>{switch(e){case"completed":return(0,o.jsx)(d.A3x,{className:"text-green-500"});case"in_progress":return(0,o.jsx)(d.aze,{className:"text-blue-500"});case"pending":return(0,o.jsx)(d.Ohp,{className:"text-yellow-500"});case"rejected":case"cancelled":return(0,o.jsx)(d.yGN,{className:"text-red-500"});default:return(0,o.jsx)(d.y3G,{className:"text-gray-500"})}},ie=(0,a.useMemo)(()=>y.filter(e=>{var t;const s="all"===M.status||e.status===M.status,a="all"===M.vendor||e.vendorId===M.vendor,r="all"===M.operation||e.operationsStatus&&M.operation in e.operationsStatus,n=(null===(t=e.poNumber)||void 0===t?void 0:t.toLowerCase().includes(M.search.toLowerCase()))||re(e.vendorId).toLowerCase().includes(M.search.toLowerCase());let l=!0;if("all"!==M.dateRange&&e.createdAt){const t=e.createdAt.toDate?e.createdAt.toDate():new Date(e.createdAt),s=new Date,a=Math.floor((s-t)/864e5);switch(M.dateRange){case"today":l=0===a;break;case"week":l=a<=7;break;case"month":l=a<=30;break;default:l=!0}}return s&&a&&r&&n&&l}).sort((e,t)=>{const s=e[J.key],a=t[J.key];return"progress"===J.key?"asc"===J.direction?s-a:a-s:s<a?"asc"===J.direction?-1:1:s>a?"asc"===J.direction?1:-1:0}),[y,M,J]),de=(0,a.useMemo)(()=>[...new Set(y.map(e=>e.vendorId))].map(e=>({id:e,name:re(e)})).filter(e=>"Unknown Vendor"!==e.name),[y,b]);return w?(0,o.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,o.jsxs)("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start space-y-4 lg:space-y-0",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,o.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center",children:(0,o.jsx)(d.z1n,{className:"text-white",size:24})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Machine Operations Manager"}),(0,o.jsx)("p",{className:"text-base text-gray-600 mt-1",children:"Track and manage all machine operations"})]})]}),(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,o.jsx)(d.zd,{className:"text-indigo-500",size:16}),(0,o.jsx)("span",{children:"Live Updates"}),(0,o.jsx)("div",{className:"w-2 h-2 rounded-full animate-pulse "+(R?"bg-green-400":"bg-gray-400")})]}),(0,o.jsx)("button",{onClick:()=>q(!R),className:"p-2 rounded-lg transition-all duration-200 "+(R?"bg-green-100 text-green-600 hover:bg-green-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:R?"Disable auto-refresh":"Enable auto-refresh",children:(0,o.jsx)(d.jTZ,{className:R?"animate-spin":"",size:16})}),(0,o.jsxs)("button",{onClick:se,className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl",children:[(0,o.jsx)(d.jTZ,{className:"mr-2",size:16}),"Refresh Data"]})]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,o.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-lg border border-blue-100",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-blue-600 text-sm font-medium",children:"Total POs"}),(0,o.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:y.length})]}),(0,o.jsx)(d.jH2,{className:"text-blue-500",size:24})]})}),(0,o.jsx)("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-4 rounded-lg border border-green-100",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-green-600 text-sm font-medium",children:"Completed Ops"}),(0,o.jsx)("p",{className:"text-2xl font-bold text-green-900",children:Q.length})]}),(0,o.jsx)(d.A3x,{className:"text-green-500",size:24})]})}),(0,o.jsx)("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 p-4 rounded-lg border border-yellow-100",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-yellow-600 text-sm font-medium",children:"In Progress"}),(0,o.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:y.filter(e=>"in_progress"===e.status).length})]}),(0,o.jsx)(d.aze,{className:"text-yellow-500",size:24})]})}),(0,o.jsx)("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-4 rounded-lg border border-purple-100",children:(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{className:"text-purple-600 text-sm font-medium",children:"Active Vendors"}),(0,o.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:de.length})]}),(0,o.jsx)(d.JXP,{className:"text-purple-500",size:24})]})})]})]}),(0,o.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-2",children:(0,o.jsx)("nav",{className:"flex space-x-2",children:["operations","vendors","completed"].map(e=>(0,o.jsx)("button",{onClick:()=>C(e),className:"flex-1 py-3 px-4 rounded-lg font-medium text-sm transition-all duration-200 "+($===e?"bg-gradient-to-r from-indigo-500 to-purple-600 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:(0,o.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:["operations"===e&&(0,o.jsx)(d.z1n,{size:16}),"vendors"===e&&(0,o.jsx)(d.vQY,{size:16}),"completed"===e&&(0,o.jsx)(d.A3x,{size:16}),(0,o.jsx)("span",{className:"capitalize",children:e})]})},e))})}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,o.jsx)("aside",{className:"lg:col-span-1 space-y-4",children:(0,o.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 sticky top-4",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filters"}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)(d.CKj,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),(0,o.jsx)("input",{type:"text",placeholder:"Search POs or vendors...",value:M.search,onChange:e=>T(t=>({...t,search:e.target.value})),className:"w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,o.jsxs)("select",{value:M.status,onChange:e=>T(t=>({...t,status:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,o.jsx)("option",{value:"all",children:"All Status"}),(0,o.jsx)("option",{value:"pending",children:"Pending"}),(0,o.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,o.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Operation"}),(0,o.jsxs)("select",{value:M.operation,onChange:e=>T(t=>({...t,operation:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,o.jsx)("option",{value:"all",children:"All Operations"}),Object.keys(c).map(e=>(0,o.jsx)("option",{value:e,children:c[e].name},e))]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor"}),(0,o.jsxs)("select",{value:M.vendor,onChange:e=>T(t=>({...t,vendor:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,o.jsx)("option",{value:"all",children:"All Vendors"}),de.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Range"}),(0,o.jsxs)("select",{value:M.dateRange,onChange:e=>T(t=>({...t,dateRange:e.target.value})),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,o.jsx)("option",{value:"all",children:"All Time"}),(0,o.jsx)("option",{value:"today",children:"Today"}),(0,o.jsx)("option",{value:"week",children:"This Week"}),(0,o.jsx)("option",{value:"month",children:"This Month"})]})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,o.jsxs)("span",{className:"text-xs text-gray-500",children:[ie.length," POs"]}),(0,o.jsx)("button",{className:"text-xs text-indigo-600 hover:text-indigo-800",onClick:()=>T({status:"all",operation:"all",search:"",dateRange:"all",vendor:"all"}),children:"Clear Filters"})]})]})]})}),(0,o.jsxs)("section",{className:"lg:col-span-3",children:["operations"===$&&(0,o.jsx)(g,{pos:ie,vendors:b,updating:O,onUpdateOperationStatus:ae,onOpenTracker:(e,t)=>{A({...e,type:t}),D(!0),(async(e,t)=>{try{const s=(0,r.P)((0,r.rJ)(n.db,"operationHistory"),(0,r._M)("itemId","==",e),(0,r._M)("itemType","==",t)),a=await(0,r.GG)(s),l=[];a.forEach(e=>{l.push({id:e.id,...e.data()})}),l.sort((e,t)=>{var s,a,r,n,l,i,d,o,c,m;const x=null!==(s=null===(a=e.timestamp)||void 0===a||null===(r=a.toDate)||void 0===r||null===(n=r.call(a))||void 0===n||null===(l=n.getTime)||void 0===l?void 0:l.call(n))&&void 0!==s?s:new Date(e.timestamp||0).getTime();return(null!==(i=null===(d=t.timestamp)||void 0===d||null===(o=d.toDate)||void 0===o||null===(c=o.call(d))||void 0===c||null===(m=c.getTime)||void 0===m?void 0:m.call(c))&&void 0!==i?i:new Date(t.timestamp||0).getTime())-x}),E(l)}catch(s){console.error("Error fetching operation history:",s),E([])}})(e.id,t)},onOpenStatusUpdateModal:(e,t,s,a)=>{Y({isOpen:!0,poId:e,operation:t,itemIndex:s,currentStatus:a})},getVendorName:re,getStatusColor:ne,getStatusIcon:le,getOperationIcon:e=>{var t,s;const a=(null===(t=c[e])||void 0===t?void 0:t.icon)||d.i5c,r=null===(s=c[e])||void 0===s?void 0:s.color,n="blue"===r?"text-blue-500":"purple"===r?"text-purple-500":"green"===r?"text-green-500":"indigo"===r?"text-indigo-500":"text-gray-500";return(0,o.jsx)(a,{className:n})}}),"vendors"===$&&(0,o.jsx)(h,{vendorPerformance:X,getVendorName:re}),"completed"===$&&(0,o.jsx)(v,{completedOperations:Q,vendors:b,getVendorName:re})]})]}),_&&I&&(0,o.jsx)(x,{item:I,history:P,onClose:()=>{D(!1),A(null),se()},getStatusColor:ne,getStatusIcon:le,getVendorName:re}),(0,o.jsx)(p,{isOpen:K.isOpen,onClose:()=>{Y({isOpen:!1,poId:null,operation:null,itemIndex:null,currentStatus:null})},operation:K.operation,itemIndex:K.itemIndex,currentStatus:K.currentStatus,onStatusUpdate:async(e,t)=>{const{poId:s,operation:a,itemIndex:r}=K;await ae(s,a,r,e,t)},poData:y.find(e=>e.id===K.poId)})]})}function g(e){let{pos:t,vendors:s,updating:r,onUpdateOperationStatus:n,onOpenTracker:l,onOpenStatusUpdateModal:i,getVendorName:m,getStatusColor:x,getStatusIcon:p,getOperationIcon:u}=e;const[g,h]=(0,a.useState)(null),v=(e,t,s,a)=>{n(e,t,s,a,`Status changed to ${a}`)},j=e=>{const t=[];return e.operation&&""!==e.operation&&t.push(e.operation),t},y=(e,t,s)=>{var a;const r=j(s);if(0===r.length)return 0;const n=(null===(a=e.operationsStatus)||void 0===a?void 0:a[t])||{},l=r.filter(e=>"completed"===n[e]).length;return Math.round(l/r.length*100)};return(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,o.jsxs)("div",{className:"md:hidden divide-y divide-gray-100",children:[t.map(e=>{var t,s,a,n,d;return(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsxs)("div",{className:"flex items-start justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"text-sm text-gray-500",children:"PO"}),(0,o.jsx)("div",{className:"text-base font-semibold text-gray-900",children:e.poNumber}),(0,o.jsx)("div",{className:"text-xs text-gray-500",children:(null===(t=e.createdAt)||void 0===t||null===(s=t.toDate)||void 0===s||null===(a=s.call(t))||void 0===a?void 0:a.toLocaleDateString())||"N/A"})]}),(0,o.jsxs)("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${x(e.status)}`,children:[p(e.status),(0,o.jsx)("span",{className:"ml-1 capitalize",children:null===(n=e.status)||void 0===n?void 0:n.replace("_"," ")})]})]}),(0,o.jsxs)("div",{className:"mt-3 flex items-center",children:[(0,o.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2 mr-2",children:(0,o.jsx)("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${e.progress||0}%`}})}),(0,o.jsxs)("span",{className:"text-xs text-gray-700",children:[e.progress||0,"%"]})]}),(0,o.jsxs)("div",{className:"mt-2 text-sm text-gray-700",children:["Vendor: ",(0,o.jsx)("span",{className:"font-medium",children:m(e.vendorId)})]}),(0,o.jsx)("div",{className:"mt-3 space-y-3",children:null===(d=e.items)||void 0===d?void 0:d.map((t,s)=>{const a=j(t);if(0===a.length)return null;const n=y(e,s,t);return(0,o.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.description||`Item ${s+1}`}),(0,o.jsxs)("div",{className:"text-xs text-gray-500",children:["Qty: ",t.quantity," ",t.unit]})]}),(0,o.jsxs)("div",{className:"flex items-center mb-2",children:[(0,o.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2 mr-2",children:(0,o.jsx)("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${n}%`}})}),(0,o.jsxs)("span",{className:"text-xs text-gray-700",children:[n,"%"]})]}),(0,o.jsx)("div",{className:"grid grid-cols-1 gap-2",children:a.map(t=>{var a,n,l;const d=(null===(a=e.operationsStatus)||void 0===a||null===(n=a[s])||void 0===n?void 0:n[t])||"pending";r[`${e.id}_${s}_${t}`];return(0,o.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[u(t),(0,o.jsx)("span",{className:"ml-2 text-xs font-medium",children:(null===(l=c[t])||void 0===l?void 0:l.name)||t})]}),(0,o.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,o.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium shadow-sm ring-1 ring-inset ring-gray-200 ${x(d)}`,children:(0,o.jsx)("span",{className:"capitalize",children:d.replace("_"," ")})}),(0,o.jsx)("div",{className:"flex space-x-1",children:(0,o.jsx)("button",{onClick:()=>i(e.id,t,s,d),className:"p-1.5 text-[10px] bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded hover:from-indigo-700 hover:to-purple-700 shadow-sm",children:"Update"})})]})]},t)})})]},s)})}),(0,o.jsx)("div",{className:"mt-3",children:(0,o.jsx)("button",{onClick:()=>l(e,"po"),className:"w-full text-center py-2 text-indigo-600 border border-indigo-200 rounded-lg hover:bg-indigo-50",children:"View Details"})})]},e.id)}),0===t.length&&(0,o.jsx)("div",{className:"p-6 text-center text-gray-500",children:"No purchase orders found"})]}),(0,o.jsxs)("div",{className:"hidden md:block overflow-x-auto",children:[(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-50 sticky top-0 z-10",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"PO Details"}),(0,o.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendor"}),(0,o.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progress"}),(0,o.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,o.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,o.jsx)("tbody",{className:"divide-y divide-gray-200",children:t.map(e=>{var t,s,n,f,b,N,w;return(0,o.jsxs)(a.Fragment,{children:[(0,o.jsxs)("tr",{className:"odd:bg-white even:bg-gray-50 hover:bg-indigo-50 cursor-pointer transition-colors",onClick:()=>{return t=e.id,void h(g===t?null:t);var t},children:[(0,o.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"flex items-center",children:(0,o.jsxs)("div",{className:"ml-4",children:[(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.poNumber}),(0,o.jsx)("div",{className:"text-sm text-gray-500",children:(null===(t=e.createdAt)||void 0===t||null===(s=t.toDate)||void 0===s||null===(n=s.call(t))||void 0===n?void 0:n.toLocaleDateString())||"N/A"}),(0,o.jsxs)("div",{className:"text-xs text-gray-400",children:[(null===(f=e.items)||void 0===f?void 0:f.length)||0," item",1!==(null===(b=e.items)||void 0===b?void 0:b.length)?"s":""]})]})})}),(0,o.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-900",children:m(e.vendorId)})}),(0,o.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2.5 mr-4",children:(0,o.jsx)("div",{className:"bg-indigo-600 h-2.5 rounded-full",style:{width:`${e.progress||0}%`}})}),(0,o.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[e.progress||0,"%"]})]})}),(0,o.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,o.jsxs)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium shadow-sm ring-1 ring-inset ring-gray-200 ${x(e.status)}`,children:[p(e.status),(0,o.jsx)("span",{className:"ml-1 capitalize",children:null===(N=e.status)||void 0===N?void 0:N.replace("_"," ")})]})}),(0,o.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium",children:(0,o.jsx)("div",{className:"flex space-x-2",children:(0,o.jsx)("button",{onClick:t=>{t.stopPropagation(),l(e,"po")},className:"text-indigo-600 hover:text-indigo-900 px-3 py-1.5 rounded-md hover:bg-indigo-50 transition",children:"View Details"})})})]}),g===e.id&&(0,o.jsx)("tr",{className:"bg-gray-50",children:(0,o.jsx)("td",{colSpan:5,className:"px-4 py-4",children:(0,o.jsx)("div",{className:"space-y-4",children:null===(w=e.items)||void 0===w?void 0:w.map((t,s)=>{const a=j(t);if(0===a.length)return null;const n=y(e,s,t);return(0,o.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200",children:[(0,o.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(d.est,{className:"text-gray-400 mr-2"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900",children:t.description||`Item ${s+1}`}),(0,o.jsxs)("div",{className:"text-xs text-gray-500",children:["Qty: ",t.quantity," ",t.unit," | Unit Price: \u20b9",t.unitPrice]})]})]})}),(0,o.jsxs)("div",{className:"flex items-center mb-3",children:[(0,o.jsx)("div",{className:"w-48 bg-gray-200 rounded-full h-2.5 mr-3",children:(0,o.jsx)("div",{className:"bg-indigo-600 h-2.5 rounded-full",style:{width:`${n}%`}})}),(0,o.jsxs)("span",{className:"text-xs text-gray-700",children:[n,"%"]})]}),(0,o.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:a.map(t=>{var a,n,l;const d=(null===(a=e.operationsStatus)||void 0===a||null===(n=a[s])||void 0===n?void 0:n[t])||"pending",m=r[`${e.id}_${s}_${t}`];return(0,o.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[u(t),(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900 ml-2",children:(null===(l=c[t])||void 0===l?void 0:l.name)||t})]}),(0,o.jsxs)("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium shadow-sm ring-1 ring-inset ring-gray-200 ${x(d)}`,children:[p(d),(0,o.jsx)("span",{className:"ml-1 capitalize",children:d.replace("_"," ")})]})]}),(0,o.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,o.jsx)("button",{onClick:()=>i(e.id,t,s,d),className:"w-full py-2 px-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-colors text-sm font-medium shadow-sm",children:"Update Status"}),(0,o.jsxs)("div",{className:"flex space-x-1",children:[(0,o.jsx)("button",{onClick:()=>v(e.id,t,s,"pending"),disabled:m||"pending"===d,className:`flex-1 py-1 px-2 text-xs rounded ${"pending"===d?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-700 hover:bg-gray-200"} ${m?"opacity-50 cursor-not-allowed":""}`,children:m&&"pending"===d?"...":"Pending"}),(0,o.jsx)("button",{onClick:()=>v(e.id,t,s,"in_progress"),disabled:m||"in_progress"===d,className:`flex-1 py-1 px-2 text-xs rounded ${"in_progress"===d?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-700 hover:bg-gray-200"} ${m?"opacity-50 cursor-not-allowed":""}`,children:m&&"in_progress"===d?"...":"Start"}),(0,o.jsx)("button",{onClick:()=>v(e.id,t,s,"completed"),disabled:m||"completed"===d,className:`flex-1 py-1 px-2 text-xs rounded ${"completed"===d?"bg-green-100 text-green-800 border border-green-300":"bg-gray-100 text-gray-700 hover:bg-gray-200"} ${m?"opacity-50 cursor-not-allowed":""}`,children:m&&"completed"===d?"...":"Complete"})]})]})]},t)})})]},s)})})})})]},e.id)})})]}),0===t.length&&(0,o.jsxs)("div",{className:"text-center py-12",children:[(0,o.jsx)(d.jH2,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,o.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No purchase orders found"}),(0,o.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"No purchase orders match your current filters."})]})]})]})}function h(e){let{vendorPerformance:t,getVendorName:s}=e;const a=e=>{if(!e)return"N/A";const t=Math.floor(e/36e5),s=Math.floor(e%36e5/6e4);return t>0?`${t}h ${s}m`:`${s}m`};return(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,o.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Vendor Performance"}),(0,o.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Efficiency based on completed operations"})]}),(0,o.jsxs)("div",{className:"md:hidden p-4 space-y-3",children:[0===Object.entries(t).length&&(0,o.jsx)("div",{className:"text-center text-gray-500",children:"No vendor data available"}),Object.entries(t).sort((e,t)=>{let[,s]=e,[,a]=t;return a.efficiency-s.efficiency}).map(e=>{let[t,s]=e;return(0,o.jsxs)("div",{className:"border rounded-xl p-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"text-sm text-gray-500",children:"Vendor"}),(0,o.jsx)("div",{className:"text-base font-semibold text-gray-900",children:s.name})]}),(0,o.jsxs)("div",{className:"text-right",children:[(0,o.jsx)("div",{className:"text-sm text-gray-500",children:"POs"}),(0,o.jsx)("div",{className:"font-semibold",children:s.totalPOs})]})]}),(0,o.jsxs)("div",{className:"mt-2 text-sm text-gray-700",children:["Completed Ops: ",(0,o.jsx)("span",{className:"font-medium",children:s.totalOperations})]}),(0,o.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,o.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2 mr-2",children:(0,o.jsx)("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Math.min(s.efficiency,100)}%`}})}),(0,o.jsxs)("span",{className:"text-xs text-gray-700",children:[Math.round(s.efficiency),"%"]})]}),(0,o.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Avg. Time: ",a(s.averageCompletionTime)]})]},t)})]}),(0,o.jsxs)("div",{className:"hidden md:block overflow-x-auto",children:[(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendor"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total POs"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Completed Operations"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Efficiency"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg. Completion Time"})]})}),(0,o.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(t).sort((e,t)=>{let[,s]=e,[,a]=t;return a.efficiency-s.efficiency}).map(e=>{let[t,s]=e;return(0,o.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900",children:s.name})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-900",children:s.totalPOs})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-900",children:s.totalOperations})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2.5 mr-4",children:(0,o.jsx)("div",{className:"bg-green-600 h-2.5 rounded-full",style:{width:`${Math.min(s.efficiency,100)}%`}})}),(0,o.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[Math.round(s.efficiency),"%"]})]})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-500",children:a(s.averageCompletionTime)})})]},t)})})]}),0===Object.keys(t).length&&(0,o.jsxs)("div",{className:"text-center py-12",children:[(0,o.jsx)(d.JXP,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,o.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No vendor data available"}),(0,o.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Vendor performance data will appear here once operations are completed."})]})]})]})}function v(e){let{completedOperations:t,getVendorName:s}=e;return(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,o.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,o.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Completed Operations"}),(0,o.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"All machine operations that have been completed"})]}),(0,o.jsxs)("div",{className:"md:hidden p-4 space-y-3",children:[0===t.length&&(0,o.jsx)("div",{className:"text-center text-gray-500",children:"No completed operations"}),t.map((e,t)=>{var s,a,r,n;return(0,o.jsx)("div",{className:"border rounded-xl p-4",children:(0,o.jsxs)("div",{className:"flex items-start justify-between",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"text-xs text-gray-500",children:"PO"}),(0,o.jsx)("div",{className:"text-base font-semibold text-gray-900",children:e.poNumber}),(0,o.jsx)("div",{className:"text-xs text-gray-500",children:(null===(s=e.completionDate)||void 0===s||null===(a=s.toDate)||void 0===a||null===(r=a.call(s))||void 0===r?void 0:r.toLocaleDateString())||"N/A"})]}),(0,o.jsxs)("div",{className:"text-right",children:[(0,o.jsx)("div",{className:"text-xs text-gray-500",children:"Operation"}),(0,o.jsx)("div",{className:"text-sm font-medium",children:(null===(n=c[e.operation])||void 0===n?void 0:n.name)||e.operation}),(0,o.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Vendor: ",e.vendor]})]})]})},t)})]}),(0,o.jsxs)("div",{className:"hidden md:block overflow-x-auto",children:[(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"PO Number"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Operation"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendor"}),(0,o.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Completed On"})]})}),(0,o.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map((e,t)=>{var s,a,r,n;return(0,o.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.poNumber})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-900",children:(null===(s=c[e.operation])||void 0===s?void 0:s.name)||e.operation})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-900",children:e.vendor})}),(0,o.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,o.jsx)("div",{className:"text-sm text-gray-500",children:(null===(a=e.completionDate)||void 0===a||null===(r=a.toDate)||void 0===r||null===(n=r.call(a))||void 0===n?void 0:n.toLocaleDateString())||"N/A"})})]},t)})})]}),0===t.length&&(0,o.jsxs)("div",{className:"text-center py-12",children:[(0,o.jsx)(d.A3x,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,o.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No completed operations"}),(0,o.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Completed operations will appear here once they're finished."})]})]})]})}}}]);
//# sourceMappingURL=196.6977ba41.chunk.js.map