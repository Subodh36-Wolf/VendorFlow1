"use strict";(self.webpackChunkvendor_management_system=self.webpackChunkvendor_management_system||[]).push([[849],{9849:(e,s,t)=>{t.r(s),t.d(s,{default:()=>o});var a=t(5043),r=t(5475),l=t(5472),d=t(791),i=t(3505),n=t(5772),c=t(579);function o(){const{showSuccess:e,showError:s}=(0,i.hN)(),[t,o]=(0,a.useState)([]),[x,m]=(0,a.useState)([]),[h,u]=(0,a.useState)(!0),[g,p]=(0,a.useState)(""),[j,b]=(0,a.useState)("all"),[y,v]=(0,a.useState)("all");(0,a.useEffect)(()=>{f()},[]);const f=async()=>{try{const[e,s]=await Promise.all([(0,l.GG)((0,l.rJ)(d.db,"jobAssignments")),(0,l.GG)((0,l.rJ)(d.db,"vendors"))]),t=[];e.forEach(e=>{t.push({id:e.id,...e.data()})});const a=[];s.forEach(e=>{a.push({id:e.id,...e.data()})}),o(t),m(a)}catch(e){console.error("Error fetching data:",e),s("Failed to load job assignments")}finally{u(!1)}},N=e=>{const s=x.find(s=>s.id===e);return s?s.companyName:"Unknown Vendor"},w=e=>{switch(e){case"assigned":return"bg-blue-100 text-blue-800";case"in-progress":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"on-hold":default:return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800"}},k=e=>{switch(e){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-orange-100 text-orange-800";case"urgent":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},C=e=>{if(!e)return!1;return new Date(e)<new Date},S=t.filter(e=>{var s;const t=(null===(s=e.jobTitle)||void 0===s?void 0:s.toLowerCase().includes(g.toLowerCase()))||N(e.vendorId).toLowerCase().includes(g.toLowerCase()),a="all"===j||e.status===j,r="all"===y||e.priority===y;return t&&a&&r});return(0,c.jsxs)("div",{className:"space-y-6 p-6",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Job Assignments"}),(0,c.jsxs)(r.N_,{to:"/admin/assign-job",className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 flex items-center",children:[(0,c.jsx)(n.GGD,{className:"mr-2"}),"Assign New Job"]})]}),(0,c.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)(n.CKj,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,c.jsx)("input",{type:"text",placeholder:"Search jobs or vendors...",value:g,onChange:e=>p(e.target.value),className:"pl-10 w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,c.jsxs)("select",{value:j,onChange:e=>b(e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,c.jsx)("option",{value:"all",children:"All Status"}),(0,c.jsx)("option",{value:"assigned",children:"Assigned"}),(0,c.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,c.jsx)("option",{value:"completed",children:"Completed"}),(0,c.jsx)("option",{value:"on-hold",children:"On Hold"}),(0,c.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,c.jsxs)("select",{value:y,onChange:e=>v(e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,c.jsx)("option",{value:"all",children:"All Priorities"}),(0,c.jsx)("option",{value:"low",children:"Low"}),(0,c.jsx)("option",{value:"medium",children:"Medium"}),(0,c.jsx)("option",{value:"high",children:"High"}),(0,c.jsx)("option",{value:"urgent",children:"Urgent"})]})]})]})}),(0,c.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:h?(0,c.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,c.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):(0,c.jsxs)("div",{className:"overflow-x-auto",children:[(0,c.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,c.jsx)("thead",{className:"bg-gray-50",children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Job Details"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vendor"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deadline"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Budget"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,c.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,c.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(a=>(0,c.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,c.jsx)("td",{className:"px-6 py-4",children:(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-sm font-medium text-gray-900",children:a.jobTitle}),(0,c.jsx)("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:a.description})]})}),(0,c.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,c.jsx)("div",{className:"text-sm text-gray-900",children:N(a.vendorId)}),(0,c.jsx)("div",{className:"text-sm text-gray-500",children:a.location})]}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,c.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${k(a.priority)}`,children:a.priority})}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)(n.wIk,{className:"mr-2 text-gray-400"}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"text-sm "+(C(a.deadline)?"text-red-600 font-medium":"text-gray-900"),children:a.deadline?new Date(a.deadline).toLocaleDateString():"No deadline"}),C(a.deadline)&&(0,c.jsxs)("div",{className:"text-xs text-red-500 flex items-center",children:[(0,c.jsx)(n.y3G,{className:"mr-1"}),"Overdue"]})]})]})}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,c.jsxs)("div",{className:"flex items-center text-sm text-gray-900",children:[(0,c.jsx)(n.z8N,{className:"mr-1 text-gray-400"}),a.budget?`\u20b9${Number(a.budget).toLocaleString()}`:"Not specified"]})}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,c.jsxs)("select",{value:a.status,onChange:r=>(async(a,r)=>{try{await(0,l.mZ)((0,l.H9)(d.db,"jobAssignments",a),{status:r,updatedAt:new Date}),o(t.map(e=>e.id===a?{...e,status:r}:e)),e("Job status updated successfully")}catch(i){console.error("Error updating job status:",i),s("Failed to update job status")}})(a.id,r.target.value),className:`text-xs leading-5 font-semibold rounded-full px-2 py-1 border-0 ${w(a.status)}`,children:[(0,c.jsx)("option",{value:"assigned",children:"Assigned"}),(0,c.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,c.jsx)("option",{value:"completed",children:"Completed"}),(0,c.jsx)("option",{value:"on-hold",children:"On Hold"}),(0,c.jsx)("option",{value:"cancelled",children:"Cancelled"})]})}),(0,c.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,c.jsxs)("div",{className:"flex space-x-2",children:[(0,c.jsx)("button",{className:"text-indigo-600 hover:text-indigo-900",title:"View Details",children:(0,c.jsx)(n.Vap,{})}),(0,c.jsx)("button",{className:"text-blue-600 hover:text-blue-900",title:"Edit Job",children:(0,c.jsx)(n.WXf,{})}),(0,c.jsx)("button",{onClick:()=>(async a=>{if(window.confirm("Are you sure you want to delete this job assignment?"))try{await(0,l.kd)((0,l.H9)(d.db,"jobAssignments",a)),o(t.filter(e=>e.id!==a)),e("Job assignment deleted successfully")}catch(r){console.error("Error deleting job:",r),s("Failed to delete job assignment")}})(a.id),className:"text-red-600 hover:text-red-900",title:"Delete Job",children:(0,c.jsx)(n.IXo,{})})]})})]},a.id))})]}),0===S.length&&(0,c.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,c.jsx)(n.Ohp,{className:"mx-auto h-12 w-12 mb-4"}),(0,c.jsx)("p",{children:"No job assignments found"})]})]})}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,c.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)(n.Ohp,{className:"h-8 w-8 text-blue-600"})}),(0,c.jsxs)("div",{className:"ml-4",children:[(0,c.jsx)("div",{className:"text-sm font-medium text-gray-500",children:"Total Jobs"}),(0,c.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:t.length})]})]})}),(0,c.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)(n.Ohp,{className:"h-8 w-8 text-yellow-600"})}),(0,c.jsxs)("div",{className:"ml-4",children:[(0,c.jsx)("div",{className:"text-sm font-medium text-gray-500",children:"In Progress"}),(0,c.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:t.filter(e=>"in-progress"===e.status).length})]})]})}),(0,c.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)(n.A3x,{className:"h-8 w-8 text-green-600"})}),(0,c.jsxs)("div",{className:"ml-4",children:[(0,c.jsx)("div",{className:"text-sm font-medium text-gray-500",children:"Completed"}),(0,c.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:t.filter(e=>"completed"===e.status).length})]})]})}),(0,c.jsx)("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("div",{className:"flex-shrink-0",children:(0,c.jsx)(n.y3G,{className:"h-8 w-8 text-red-600"})}),(0,c.jsxs)("div",{className:"ml-4",children:[(0,c.jsx)("div",{className:"text-sm font-medium text-gray-500",children:"Overdue"}),(0,c.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:t.filter(e=>C(e.deadline)).length})]})]})})]})]})}}}]);
//# sourceMappingURL=849.b647e8e2.chunk.js.map