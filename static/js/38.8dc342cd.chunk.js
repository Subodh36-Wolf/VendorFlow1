"use strict";(self.webpackChunkvendor_management_system=self.webpackChunkvendor_management_system||[]).push([[38],{8038:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var s=i(5043),n=i(5475),a=i(5772),c=i(9295),r=i(3505),l=i(579);function d(){const{showError:e,showSuccess:t}=(0,r.hN)(),[i,d]=(0,s.useState)(!1),[o,u]=(0,s.useState)([]),[m,x]=(0,s.useState)(""),[p,h]=(0,s.useState)({type:"",category:"",status:""}),[g,v]=(0,s.useState)([]);(0,s.useEffect)(()=>{y()},[]);const y=async()=>{try{d(!0);const e=await(0,c.E4)();u(e)}catch(t){console.error(t),e("Failed to load items")}finally{d(!1)}},j=async()=>{try{d(!0);const e=await(0,c.Ds)({text:m,...p});u(e)}catch(t){e("Search failed")}finally{d(!1)}},N=e=>{v(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(a.CKj,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,l.jsx)("input",{className:"pl-9 pr-3 py-2 border rounded-lg w-64",placeholder:"Search by name/code/HSN",value:m,onChange:e=>x(e.target.value),onKeyDown:e=>"Enter"===e.key&&j()})]}),(0,l.jsxs)("select",{className:"border rounded-lg px-3 py-2",value:p.type,onChange:e=>h({...p,type:e.target.value}),children:[(0,l.jsx)("option",{value:"",children:"All Types"}),(0,l.jsx)("option",{value:"product",children:"Product"}),(0,l.jsx)("option",{value:"service",children:"Service"})]}),(0,l.jsxs)("select",{className:"border rounded-lg px-3 py-2",value:p.status,onChange:e=>h({...p,status:e.target.value}),children:[(0,l.jsx)("option",{value:"",children:"All Status"}),(0,l.jsx)("option",{value:"active",children:"Active"}),(0,l.jsx)("option",{value:"inactive",children:"Inactive"})]}),(0,l.jsxs)("button",{onClick:j,className:"px-3 py-2 border rounded-lg flex items-center space-x-2",children:[(0,l.jsx)(a.K7R,{}),(0,l.jsx)("span",{children:"Filter"})]}),(0,l.jsxs)("button",{onClick:y,className:"px-3 py-2 border rounded-lg flex items-center space-x-2",children:[(0,l.jsx)(a.jTZ,{}),(0,l.jsx)("span",{children:"Refresh"})]})]}),(0,l.jsxs)(n.N_,{to:"/admin/items/new",className:"px-4 py-2 bg-indigo-600 text-white rounded-lg flex items-center space-x-2",children:[(0,l.jsx)(a.GGD,{}),(0,l.jsx)("span",{children:"Add Item"})]})]}),(0,l.jsx)("div",{className:"md:hidden space-y-3",children:0===o.length?(0,l.jsx)("div",{className:"bg-white rounded-xl border p-6 text-center text-gray-500",children:"No items found"}):o.map(e=>{var t,i;return(0,l.jsxs)("div",{className:"bg-white rounded-xl border p-4 "+(g.includes(e.id)?"ring-2 ring-indigo-400":""),children:[(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"Name"}),(0,l.jsx)("div",{className:"font-semibold text-gray-900",children:e.name})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"Sale Price"}),(0,l.jsxs)("div",{className:"font-medium",children:["\u20b9",Number((null===(t=e.pricing)||void 0===t?void 0:t.salePrice)||0).toLocaleString()]})]})]}),(0,l.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-3 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Type"}),(0,l.jsx)("div",{className:"capitalize font-medium",children:e.type||"-"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Tax %"}),(0,l.jsxs)("div",{className:"font-medium",children:[Number((null===(i=e.pricing)||void 0===i?void 0:i.taxRate)||0),"%"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Code"}),(0,l.jsx)("div",{className:"font-medium",children:e.code||"-"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Status"}),(0,l.jsx)("div",{className:"font-medium",children:e.status||"-"})]})]}),(0,l.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,l.jsxs)("label",{className:"inline-flex items-center text-xs text-gray-600",children:[(0,l.jsx)("input",{type:"checkbox",checked:g.includes(e.id),onChange:()=>N(e.id),className:"mr-2 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500","aria-label":`Select item ${e.name}`}),"Select"]}),(0,l.jsxs)(n.N_,{to:`/admin/items/${e.id}/edit`,className:"inline-flex items-center px-3 py-1.5 border rounded text-sm hover:bg-gray-50","aria-label":`Edit ${e.name}`,children:[(0,l.jsx)(a.WXf,{className:"mr-1"})," Edit"]})]})]},e.id)})}),(0,l.jsx)("div",{className:"hidden md:block bg-white border rounded-lg overflow-hidden",children:(0,l.jsxs)("table",{className:"min-w-full",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-3 text-left",children:(0,l.jsx)("input",{type:"checkbox",onChange:e=>v(e.target.checked?o.map(e=>e.id):[]),checked:g.length>0&&g.length===o.length})}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Name"}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Type"}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Code"}),(0,l.jsx)("th",{className:"p-3 text-right",children:"Sale Price"}),(0,l.jsx)("th",{className:"p-3 text-right",children:"Tax %"}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Status"}),(0,l.jsx)("th",{className:"p-3 text-right",children:"Actions"})]})}),(0,l.jsxs)("tbody",{children:[o.map(e=>{var t,i;return(0,l.jsxs)("tr",{className:"border-t",children:[(0,l.jsx)("td",{className:"p-3",children:(0,l.jsx)("input",{type:"checkbox",checked:g.includes(e.id),onChange:()=>N(e.id)})}),(0,l.jsx)("td",{className:"p-3",children:e.name}),(0,l.jsx)("td",{className:"p-3 capitalize",children:e.type}),(0,l.jsx)("td",{className:"p-3",children:e.code}),(0,l.jsxs)("td",{className:"p-3 text-right",children:["\u20b9",Number((null===(t=e.pricing)||void 0===t?void 0:t.salePrice)||0).toLocaleString()]}),(0,l.jsxs)("td",{className:"p-3 text-right",children:[Number((null===(i=e.pricing)||void 0===i?void 0:i.taxRate)||0),"%"]}),(0,l.jsx)("td",{className:"p-3",children:e.status}),(0,l.jsx)("td",{className:"p-3 text-right",children:(0,l.jsxs)(n.N_,{to:`/admin/items/${e.id}/edit`,className:"inline-flex items-center px-3 py-1 border rounded mr-2",children:[(0,l.jsx)(a.WXf,{className:"mr-1"}),"Edit"]})})]},e.id)}),0===o.length&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{className:"p-6 text-center text-gray-500",colSpan:8,children:"No items found"})})]})]})}),g.length>0&&(0,l.jsxs)("div",{className:"flex justify-between items-center bg-yellow-50 border border-yellow-200 p-3 rounded",children:[(0,l.jsxs)("span",{children:[g.length," selected"]}),(0,l.jsxs)("button",{onClick:async()=>{if(0!==g.length&&window.confirm(`Delete ${g.length} item(s)?`))try{d(!0),await(0,c._r)(g),t("Items deleted"),v([]),y()}catch(i){e("Delete failed")}finally{d(!1)}},className:"px-3 py-2 bg-red-600 text-white rounded flex items-center",children:[(0,l.jsx)(a.IXo,{className:"mr-2"})," Delete Selected"]})]})]})}},9295:(e,t,i)=>{i.d(t,{Ds:()=>h,E4:()=>p,U3:()=>o,_r:()=>g,fk:()=>m,uG:()=>d,u_:()=>x,wE:()=>u});var s=i(5472),n=i(8147),a=i(791);const c="items";function r(e){var t,i,s,n,a,c,r,l,d,o,u,m,x,p,h,g;const v=e=>""===e||null===e||void 0===e?null:Number(e);return{name:String(e.name||"").trim(),type:"service"===e.type?"service":"product",hsn:String(e.hsn||"").trim(),code:String(e.code||"").trim(),unit:String(e.unit||"").trim(),category:String(e.category||"").trim(),imageUrl:String(e.imageUrl||"").trim(),pricing:{salePrice:null!==(t=v(null===(i=e.pricing)||void 0===i?void 0:i.salePrice))&&void 0!==t?t:0,purchasePrice:null!==(s=v(null===(n=e.pricing)||void 0===n?void 0:n.purchasePrice))&&void 0!==s?s:0,discountType:["percentage","flat"].includes(null===(a=e.pricing)||void 0===a?void 0:a.discountType)?e.pricing.discountType:"percentage",discountValue:null!==(c=v(null===(r=e.pricing)||void 0===r?void 0:r.discountValue))&&void 0!==c?c:0,taxRate:null!==(l=v(null===(d=e.pricing)||void 0===d?void 0:d.taxRate))&&void 0!==l?l:0,taxMode:["with_tax","without_tax"].includes(null===(o=e.pricing)||void 0===o?void 0:o.taxMode)?e.pricing.taxMode:"without_tax"},stock:{track:Boolean(null===(u=e.stock)||void 0===u?void 0:u.track),openingQty:null!==(m=v(null===(x=e.stock)||void 0===x?void 0:x.openingQty))&&void 0!==m?m:0,minQty:null!==(p=v(null===(h=e.stock)||void 0===h?void 0:h.minQty))&&void 0!==p?p:0,location:String((null===(g=e.stock)||void 0===g?void 0:g.location)||"").trim()},status:"inactive"===e.status?"inactive":"active",notes:String(e.notes||"").trim()}}function l(e){var t,i,s,n,a,c,r,l,d,o,u,m,x,p,h,g;const v=e.data()||{};return{id:e.id,name:v.name||"",type:v.type||"product",hsn:v.hsn||"",code:v.code||"",unit:v.unit||"",category:v.category||"",imageUrl:v.imageUrl||"",pricing:{salePrice:"number"===typeof(null===(t=v.pricing)||void 0===t?void 0:t.salePrice)?v.pricing.salePrice:Number((null===(i=v.pricing)||void 0===i?void 0:i.salePrice)||0),purchasePrice:"number"===typeof(null===(s=v.pricing)||void 0===s?void 0:s.purchasePrice)?v.pricing.purchasePrice:Number((null===(n=v.pricing)||void 0===n?void 0:n.purchasePrice)||0),discountType:(null===(a=v.pricing)||void 0===a?void 0:a.discountType)||"percentage",discountValue:"number"===typeof(null===(c=v.pricing)||void 0===c?void 0:c.discountValue)?v.pricing.discountValue:Number((null===(r=v.pricing)||void 0===r?void 0:r.discountValue)||0),taxRate:"number"===typeof(null===(l=v.pricing)||void 0===l?void 0:l.taxRate)?v.pricing.taxRate:Number((null===(d=v.pricing)||void 0===d?void 0:d.taxRate)||0),taxMode:(null===(o=v.pricing)||void 0===o?void 0:o.taxMode)||"without_tax"},stock:{track:Boolean(null===(u=v.stock)||void 0===u?void 0:u.track),openingQty:"number"===typeof(null===(m=v.stock)||void 0===m?void 0:m.openingQty)?v.stock.openingQty:Number((null===(x=v.stock)||void 0===x?void 0:x.openingQty)||0),minQty:"number"===typeof(null===(p=v.stock)||void 0===p?void 0:p.minQty)?v.stock.minQty:Number((null===(h=v.stock)||void 0===h?void 0:h.minQty)||0),location:(null===(g=v.stock)||void 0===g?void 0:g.location)||""},status:v.status||"active",notes:v.notes||"",createdAt:v.createdAt,updatedAt:v.updatedAt}}function d(e){const t={};return(!e.name||String(e.name).trim().length<2)&&(t.name="Item name is required"),e.unit||(t.unit="Unit is required"),e.pricing&&e.pricing.salePrice<0&&(t.salePrice="Sale price must be >= 0"),e.pricing&&e.pricing.purchasePrice<0&&(t.purchasePrice="Purchase price must be >= 0"),e.pricing&&e.pricing.taxRate<0&&(t.taxRate="Tax rate must be >= 0"),t}async function o(e,t){const i=`items/${t||"tmp"}_${Date.now()}_${e.name}`,s=(0,n.KR)(a.I,i),c=await(0,n.D)(s,e);return(0,n.qk)(c.ref)}async function u(e){const t=d(e);if(Object.keys(t).length){const e=new Error("ITEM_VALIDATION_FAILED");throw e.details=t,e}const i=r(e),n=(0,s.O5)();return{id:(await(0,s.gS)((0,s.rJ)(a.db,c),{...i,createdAt:n,updatedAt:n})).id,...i}}async function m(e,t){const i=d(t);if(Object.keys(i).length){const e=new Error("ITEM_VALIDATION_FAILED");throw e.details=i,e}const n=r(t);await(0,s.mZ)((0,s.H9)(a.db,c,e),{...n,updatedAt:(0,s.O5)()})}async function x(e){const t=await(0,s.x7)((0,s.H9)(a.db,c,e));return t.exists()?l(t):null}async function p(){const e=(0,s.P)((0,s.rJ)(a.db,c),(0,s.My)("createdAt","desc"));return(await(0,s.GG)(e)).docs.map(l)}async function h(e){let{text:t,type:i,category:n,status:r}=e;let d=(await(0,s.GG)((0,s.rJ)(a.db,c))).docs.map(l);if(t){const e=t.toLowerCase();d=d.filter(t=>(t.name||"").toLowerCase().includes(e)||(t.code||"").toLowerCase().includes(e)||(t.hsn||"").toLowerCase().includes(e))}return i&&(d=d.filter(e=>e.type===i)),n&&(d=d.filter(e=>e.category===n)),r&&(d=d.filter(e=>e.status===r)),d}async function g(e){const t=(0,s.wP)(a.db);e.forEach(e=>t.delete((0,s.H9)(a.db,c,e))),await t.commit()}}}]);
//# sourceMappingURL=38.8dc342cd.chunk.js.map